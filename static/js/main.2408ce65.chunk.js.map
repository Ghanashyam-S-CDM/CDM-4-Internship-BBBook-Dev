{"version":3,"sources":["assets/imgs/spinner.gif","utils/Alert/Alert.js","reducers/mainReducer.js","contexts/MainContext.js","utils/SegmentControls/SegmentControls.js","components/Sidemenu/Sidemenu.js","components/Header/Header.js","components/Group/Group.js","components/PageDashboard/PageDashboard.js","components/Comment/Comment.js","components/MyComponent.js","components/CommentThread/CommentThread.js","helper.js","utils/Spinner/Spinner.js","utils/PDFRenderer/PDFRenderer.js","components/PdfVerticalScroll/PdfVerticalScroll.js","components/PageBook/PageBook.js","components/NewQuestionComment/NewQuestionComment.js","components/PageLogin/PageLogin.js","components/PageGroups/PageGroups.js","components/PageRegister/PageRegister.js","components/ModalEditGroup/ModalEditGroup.js","components/App/App.js","components/PageGroup/PageGroup.js","serviceWorker.js","index.js","assets/imgs/tab-start.svg","assets/imgs/default-profile-icon.jpg","assets/imgs/letter.png"],"names":["module","exports","setAlert","modes","mode","url","initState","JSON","stringify","access_token","refresh_token","userId","USERS","GROUPS","BOOKS","COMMENTS","UI_SIDEMENU","UI_DARKMODE","version","state","parse","mainReducer","oldState","actionType","data","reducer","loggedInUsers","cache","reduce","users","groups","books","comments","localStorage","setItem","user","id","getItem","login","removeItem","forceUpdateApp","window","lib","forEach","d","withRouter","alert","useState","className","style","minWidth","maxWidth","maxHeight","onClick","undefined","axios","dispatch","MainContext","createContext","nonAlphaNumericRegex","children","location","history","useReducer","mounted","setMounted","Provider","value","api","method","onError","a","e","console","log","response","width","Object","keys","map","key","_","capitalize","post","token","status","refresh","r","access","Error","options","headers","Authorization","SegmentControls","vertical","props","val","Number","isInteger","sizeAttr","transform","length","c","i","urlToValue","dashboard","useContext","src","require","alt","username","pathname","split","to","cursor","push","Header","height","group","isAdmin","admins","indexOf","title","bio","bookId","b","thumbnail","detail","useEffect","then","catch","error","joined_groups","groupId","whitespaceRegex","Comment","commentBody","commentId","showChildren","editMode","setEditMode","comment","selection","selection_data","s","document","querySelector","scrollIntoView","behavior","text","Date","created_at","toLocaleString","replys","body","hidden","hashtag","h","MyComponent","twoWayBind","property","event","valAttr","setState","target","PureComponent","onSubmit","preventDefault","match","params","context","replace","trim","book","replyto","typeof","comment_set","this","goBack","disableTracksWidthCompensation","required","cols","rows","placeholder","type","contextType","getChildNodeIndex","element","Array","from","parentNode","getSelectionOffsetFromParent","node","parent","offset","warn","previousSibling","innerText","Spinner","pdfjs","workerSrc","PdfImage","memo","page","viewport","setData","canvas","createElement","canvasContext","getContext","render","promise","toDataURL","TextLayer","pageComments","__html","setHtml","dangerouslySetInnerHTML","getTextContent","textContent","textDiv","container","textDivs","lineData","p","startLine","startOffset","start","endLine","endOffset","openStack","lineEle","lineNum","l","substrings","sort","escape","substring","splice","findIndex","pop","innerHTML","join","classList","add","setSidebarMode","setSelection","setBubblePos","getSelection","toString","anchorNode","focusNode","closest","anchorNodeSpan","focusNodeSpan","startPage","dataset","pageIndex","anchorOffset","endPage","focusOffset","pagesDOM","ref","current","slice","focusNodeClientRect","getBoundingClientRect","scrollNode","top","scrollTop","createRef","pdf","destroy","publicPrivateMode","pageWiseComments","pages","viewports","_pageIndex","pick","data-page-index","NewCommentBubble","sidebarMode","publicPrivateModes","userFilter","setUserFilter","publicSearchString","setPublicSearchString","setPdf","componentDidMount","group_id","categorized","setCategorized","setPageWiseComments","allComments","pageNum","filtered","filter","docfile","pdfLoadTask","getDocument","onProgress","loaded","total","promises","numPages","getPage","Promise","all","generateViewports","scale","getViewport","path","tabStart","onChange","component","CommentThread","bubblePos","showSpinner","PageLogin","loginResponse","signUp","email","name","PageRegister","refEle","holderElement","minHeight","offsetHeight","readOnly","ModalEditGroup","publicPrivate","linkSharing","omit","group_type","stateToGroupType","groupTypeToState","cloneDeep","manageUsersMode","u","borderRadius","first_name","last_name","disabled","origin","showJoinDialog","setShowJoinDialog","React","updateState","PageGroup","Dashboard","Groups","Book","isLocalhost","Boolean","hostname","registerValidSW","swUrl","config","navigator","serviceWorker","register","registration","onupdatefound","installingWorker","installing","onstatechange","controller","onUpdate","onSuccess","ReactDOM","getElementById","URL","process","href","addEventListener","fetch","contentType","get","ready","unregister","reload","checkValidServiceWorker"],"mappings":"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","file":"static/js/main.2408ce65.chunk.js","sourcesContent":["module.exports = __webpack_public_path__ + \"static/media/spinner.3d035a55.gif\";","import React,{useState} from 'react'\r\nimport {withRouter} from 'react-router-dom'\r\n\r\nexport let setAlert\r\n\r\n// TODO: Maybe easier alert, prompt, confirm\r\n// TODO: UseEffect scrollbar fix\r\nexport default withRouter(function Alert(){\r\n\tlet alert\r\n\t[alert,setAlert]=useState()\r\n\treturn (\r\n\t\t<div id=\"Alert\" className={'modal'+(alert?' active':' ')}>\r\n\t\t\t{alert?<div style={{minWidth: 320,maxWidth: 'calc(100% - 24px)',maxHeight: 'calc(100% - 24px)'}}>\r\n\t\t\t\t<div className=\"close-btn\" onClick={()=>setAlert()}/>\r\n\t\t\t\t{alert}\r\n\t\t\t</div>:undefined}\r\n\t\t</div>\r\n\t)\r\n})","// import _ from 'lodash'\r\n\r\nimport {forceUpdateApp} from '../components/App/App'\r\n\r\nconst mode=0\r\nconst modes=[\r\n\t{\r\n\t\tmode: 'dev',\r\n\t\turl: 'https://bbapi-testing.herokuapp.com/bbapi/',\r\n\t},\r\n\t{\r\n\t\tmode: 'prod',\r\n\t\turl: 'https://test-for-bbbook.herokuapp.com/bbapi/',\r\n\t},\r\n]\r\nexport const initState=JSON.stringify({\r\n\taccess_token: null,\r\n\trefresh_token: null,\r\n\tuserId: null,\r\n\r\n\tUSERS:    {},\r\n\tGROUPS:   {},\r\n\tBOOKS:    {},\r\n\tCOMMENTS: {},\r\n\r\n\tUI_SIDEMENU: false,\r\n\tUI_DARKMODE: 'auto', // 'auto',true,false\r\n\r\n\tversion: '0.0.11 '+modes[mode].mode,\r\n\t...modes[mode]\r\n})\r\nexport let state=JSON.parse(initState)\r\n\r\nexport default function mainReducer(oldState,[actionType,data]){\r\n\tstate={...state,...reducer(oldState,actionType,data)}\r\n\tif(mode===0) window.state=state\r\n\treturn state\r\n}\r\n\r\nfunction reducer(state,actionType,data){\r\n\tlet userId,loggedInUsers\r\n\tswitch(actionType){\r\n\t\tcase 'SET_STATE': return data\r\n\t\tcase 'SET_UI_SIDEMENU': return {UI_SIDEMENU: data}\r\n\t\tcase 'SET_UI_DARKMODE': return {UI_DARKMODE: data}\r\n\t\tcase 'SET_DATA':\r\n\t\t\tconst cache={\r\n\t\t\t\tUSERS   : {...state.USERS   ,...(reduce(data.users    ?? []))}, // eslint-disable-line no-whitespace-before-property\r\n\t\t\t\tGROUPS  : {...state.GROUPS  ,...(reduce(data.groups   ?? []))}, // eslint-disable-line no-whitespace-before-property\r\n\t\t\t\tBOOKS   : {...state.BOOKS   ,...(reduce(data.books    ?? []))}, // eslint-disable-line no-whitespace-before-property\r\n\t\t\t\tCOMMENTS: {...state.COMMENTS,...(reduce(data.comments ?? []))}, // eslint-disable-line no-whitespace-before-property\r\n\t\t\t}\r\n\t\t\tlocalStorage.setItem('cache',JSON.stringify(cache)) // TODO: Cache size limiting, preserve logged in users\r\n\t\t\treturn cache\r\n\t\tcase 'LOGIN':\r\n\t\t\tconst {access_token,refresh_token}=data\r\n\t\t\tuserId=data.user.id\r\n\t\t\tlocalStorage.setItem('activeUserId',userId)\r\n\t\t\tlocalStorage.setItem('loggedInUsers',JSON.stringify({\r\n\t\t\t\t...JSON.parse(localStorage.getItem('loggedInUsers') || '{}'),\r\n\t\t\t\t[userId]: [access_token,refresh_token]\r\n\t\t\t}))\r\n\t\t\treturn {\r\n\t\t\t\taccess_token,\r\n\t\t\t\trefresh_token,\r\n\t\t\t\tuserId,\r\n\t\t\t\t...reducer(state,'SET_DATA',{users: [data.user]}),\r\n\t\t\t}\r\n\t\tcase 'REFRESH':\r\n\t\t\tloggedInUsers=JSON.parse(localStorage.getItem('loggedInUsers'))\r\n\t\t\tloggedInUsers[state.userId][0]=data\r\n\t\t\tlocalStorage.setItem('loggedInUsers',JSON.stringify(loggedInUsers))\r\n\t\t\treturn {access_token: data}\r\n\t\tcase 'RE_LOGIN':\r\n\t\t\tuserId=localStorage.getItem('activeUserId')\r\n\t\t\tconst login=JSON.parse(localStorage.getItem('loggedInUsers'))[userId]\r\n\t\t\treturn{\r\n\t\t\t\taccess_token: login[0],\r\n\t\t\t\trefresh_token: login[1],\r\n\t\t\t\tuserId,\r\n\t\t\t\t...JSON.parse(localStorage.getItem('cache'))\r\n\t\t\t}\r\n\t\tcase 'LOGOUT':\r\n\t\t\tlocalStorage.removeItem('activeUserId')\r\n\t\t\tloggedInUsers=JSON.parse(localStorage.getItem('loggedInUsers'))\r\n\t\t\tdelete loggedInUsers[state.userId]\r\n\t\t\tlocalStorage.setItem('loggedInUsers',JSON.stringify(loggedInUsers))\r\n\t\t\tforceUpdateApp()\r\n\t\t\treturn JSON.parse(initState)\r\n\t\tdefault: return {}\r\n\t}\r\n}\r\n\r\nfunction reduce(data){\r\n\tconst lib={}\r\n\tdata.forEach(d=>lib[d.id]=d)\r\n\treturn lib\r\n}\r\n","import React,{createContext,useReducer,useState} from 'react'\r\nimport {withRouter} from 'react-router-dom'\r\nimport axios from 'axios'\r\n// import _ from 'lodash'\r\n\r\nimport mainReducer,{initState,state} from '../reducers/mainReducer'\r\nimport {setAlert} from '../utils/Alert/Alert'\r\nimport _ from 'lodash'\r\n\r\nwindow.axios=axios\r\nexport const MainContext=createContext(JSON.parse(initState))\r\nexport const nonAlphaNumericRegex=/[^A-Za-z0-9 ]+/g\r\nexport let dispatch\r\n\r\nexport default withRouter(function MainContextProvider({children,location,history}){\r\n\tlet state\r\n\t([state,dispatch]=useReducer(mainReducer,JSON.parse(initState)))\r\n\tconst [mounted,setMounted]=useState(false)\r\n\r\n\tif(localStorage.getItem('activeUserId') && !mounted)\r\n\t\tdispatch(['RE_LOGIN'])\r\n\r\n\tif(!mounted) setMounted(true)\r\n\treturn (\r\n\t\t<MainContext.Provider value={{state,dispatch}}>{children}</MainContext.Provider>\r\n\t)\r\n})\r\n\r\nconst UNAUTHORIZED=401\r\nexport async function api(method,url,data){\r\n\t// console.log(method,url,data)\r\n\tlet {access_token}=state\r\n\tif(access_token){\r\n\t\ttry{\r\n\t\t\tawait axios.post(state.url+'token/verify/',{token: access_token})\r\n\t\t}catch(e){\r\n\t\t\tif(e.response.status===UNAUTHORIZED){ // If access_token invalid, refresh\r\n\t\t\t\ttry{\r\n\t\t\t\t\tconst r=await axios.post(state.url+'token/refresh/',{refresh: state.refresh_token})\r\n\t\t\t\t\taccess_token=r.data.access\r\n\t\t\t\t\tdispatch(['REFRESH',access_token])\r\n\t\t\t\t}catch(e){\r\n\t\t\t\t\tif(e.response.status===UNAUTHORIZED){ // If refresh_token invalid, logout\r\n\t\t\t\t\t\tsetAlert(<div className=\"row spc-12\" style={{width: 320}}>\r\n\t\t\t\t\t\t\t<div className=\"col-12 h5\">&#xf071; Error</div>\r\n\t\t\t\t\t\t\t<div className=\"col-12 h7 text-muted\">\r\n\t\t\t\t\t\t\t\tYou were logged out. Please login again...\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t<div className=\"bottom-row col-ext-x col-ext-b col-12 row spc-x-12 spc-y-8 f-justify-end\">\r\n\t\t\t\t\t\t\t\t<button onClick={()=>setAlert()}>Close</button>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</div>)\r\n\t\t\t\t\t\tdispatch(['LOGOUT'])\r\n\t\t\t\t\t\tthrow new Error('refresh_token expired')\r\n\t\t\t\t\t}else onError(e)\r\n\t\t\t\t}\r\n\t\t\t}else onError(e)\r\n\t\t}\r\n\t}\r\n\r\n\ttry{\r\n\t\tconst options={\r\n\t\t\turl: state.url+url,\r\n\t\t\tmethod,\r\n\t\t\tdata,\r\n\t\t}\r\n\t\tif(access_token) options.headers={Authorization: 'Bearer '+access_token}\r\n\t\treturn await axios(options)\r\n\t}catch(e){ onError(e) }\r\n\r\n\tfunction onError(e){\r\n\t\tconsole.log(e,e.response)\r\n\t\tsetAlert(<div className=\"row spc-12\" style={{width: 320}}>\r\n\t\t\t<div className=\"col-12 h5\">&#xf071; Error</div>\r\n\t\t\t<div className=\"col-12 h7 text-muted\">\r\n\t\t\t\t{e.response?.data?\r\n\t\t\t\t\tObject.keys(e.response.data).map(key=><div {...{key}}>{_.capitalize(key)}: {e.response.data[key]}</div>):\r\n\t\t\t\t\t<div>Error: Network Error</div>}\r\n\t\t\t</div>\r\n\t\t\t<div className=\"bottom-row col-ext-x col-ext-b col-12 row spc-x-12 spc-y-8 f-justify-end\">\r\n\t\t\t\t<button onClick={()=>setAlert()}>Close</button>\r\n\t\t\t</div>\r\n\t\t</div>)\r\n\t\tthrow e\r\n\t}\r\n}\r\n","import React,{Fragment} from 'react'\r\n// import _ from 'lodash'\r\n\r\nimport './SegmentControls.scss'\r\n\r\n// TODO: Focus\r\nexport default function SegmentControls({value,className,children,vertical,...props}){\r\n\tconst val=Number.isInteger(value)?value:-1\r\n\tconst sizeAttr=vertical?'height':'width'\r\n\treturn (\r\n\t\t<div {...props} className={'segment-controls row '+(className || '')}>\r\n\t\t\t<div\r\n\t\t\t\tclassName=\"highlight\"\r\n\t\t\t\tstyle={{\r\n\t\t\t\t\ttransform: vertical?`translateY(${val*100}%)`:`translateX(${val*100}%)`,\r\n\t\t\t\t\t[sizeAttr]: 100/children.length+'%',\r\n\t\t\t\t}}\r\n\t\t\t/>\r\n\t\t\t{children.map((c,i)=><Fragment key={i}>{c}</Fragment>)}\r\n\t\t</div>\r\n\t)\r\n}\r\n","import React,{useContext} from 'react'\r\nimport {NavLink,withRouter} from 'react-router-dom'\r\n\r\nimport './Sidemenu.scss'\r\nimport {MainContext} from '../../contexts/MainContext'\r\nimport SegmentControls from '../../utils/SegmentControls/SegmentControls'\r\n\r\nconst urlToValue={\r\n\tdashboard: 0,\r\n\tgroups: 1,\r\n\t// library: 1,\r\n\t// favorites: 1,\r\n\t// connections: 1,\r\n\t// settings: 1,\r\n}\r\n\r\n// MAYBE: Hover segment controls\r\nexport default withRouter(function Sidemenu({history,location}){\r\n\tconst {state,dispatch}=useContext(MainContext)\r\n\tconst user=state.USERS[state.userId]\r\n\treturn (\r\n\t\t<section id=\"Sidemenu\" className={'f-vert p-8 pos-abs stretch-to-fit'+(state.UI_SIDEMENU?' active':'')}>\r\n\t\t\t<div className=\"col\"/>\r\n\t\t\t<div className=\"row f-vert spc-12 mb-12\">\r\n\t\t\t\t<img className=\"profile-icon f-self-center\" src={require('../../assets/imgs/default-profile-icon.jpg')} alt=\"default-profile-icon\"/>\r\n\t\t\t\t<div className=\"text-center col-12\" style={{width: 'calc(100% - 72px)'}}>\r\n\t\t\t\t\t<div className=\"one-line\">\r\n\t\t\t\t\t\tFirstname Lastname\r\n\t\t\t\t\t\t{/*{user?user.first_name:'Firstname'}*/}\r\n\t\t\t\t\t\t{/*{user?user.last_name:'Lastname'}*/}\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div className=\"h7 text-muted\">{user?user.username:'@Username'}</div>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t\t<SegmentControls className=\"f-vert\" value={urlToValue[location.pathname.split('/')[1]] || 0} vertical={true}>\r\n\t\t\t\t<NavLink to=\"/dashboard\" className=\"p-12\">Dashboard</NavLink>\r\n\t\t\t\t{/*<Link to=\"/library\" className=\"p-12\">My PageDashboard</Link>*/}\r\n\t\t\t\t{/*<Link to=\"/favorites\" className=\"p-12\">Favorites</Link>*/}\r\n\t\t\t\t{/*<Link to=\"/connections\" className=\"p-12\">My Connections</Link>*/}\r\n\t\t\t\t<NavLink to=\"/groups\" className=\"p-12\">Groups</NavLink>\r\n\t\t\t\t{/*<Link to=\"/settings\" className=\"p-12\">Account settings</Link>*/}\r\n\t\t\t\t{/*<Link className=\"p-12\">Switch account</Link>*/}\r\n\t\t\t\t{/*<Link to=\"\" className=\"p-12\">&nbsp;</Link>*/}\r\n\t\t\t</SegmentControls>\r\n\t\t\t<div className=\"col\"/>\r\n\t\t\t<div className=\"h7 text-center mb-12\" style={{cursor: 'pointer'}} onClick={logout}><i className=\"icon icon-signout\"/> Logout</div>\r\n\t\t</section>\r\n\t)\r\n\r\n\tfunction logout(){\r\n\t\tdispatch(['LOGOUT'])\r\n\t\thistory.push('/login')\r\n\t}\r\n})","import React,{useContext} from 'react'\r\n\r\nimport './Header.scss'\r\nimport {MainContext} from '../../contexts/MainContext'\r\n\r\nexport default function Header({children}){\r\n\tconst {state}=useContext(MainContext)\r\n\r\n\treturn (\r\n\t\t<header className=\"Header row spc-x-8 f-center pos-sty f-order-m1\">\r\n\t\t\t<h3 className=\"logo small-caps f-center ml-12\">\r\n\t\t\t\t<span className=\"b-800\">BB</span>B<span className=\"b-600\">ook</span>\r\n\t\t\t\t<sup className=\"h7 normal-caps ml-4\" style={{height: 'auto'}}>Pre-Alpha <b className=\"b-900\">{state.version}</b></sup>\r\n\t\t\t</h3>\r\n\t\t\t{children}\r\n\t\t\t{/*<SegmentControls className=\"ml-16\" value={1}>*/}\r\n\t\t\t{/*\t<div className=\"super-center px-16\">Discover</div>*/}\r\n\t\t\t{/*\t<div className=\"super-center px-16 active\">PageDashboard</div>*/}\r\n\t\t\t{/*</SegmentControls>*/}\r\n\t\t\t{/*<div className=\"col\"/>*/}\r\n\t\t\t{/*<input className=\"col mx-8\" type=\"search\"/>*/}\r\n\t\t\t{/*<button className=\"new-group-button mr-16 f-center\">New Group</button>*/}\r\n\t\t\t{/*<div className=\"text-right\">*/}\r\n\t\t\t{/*\tFirstname Lastname*/}\r\n\t\t\t{/*\t<div className=\"h7 text-muted\">@Username</div>*/}\r\n\t\t\t{/*</div>*/}\r\n\t\t\t{/*<img*/}\r\n\t\t\t{/*\tclassName=\"profile-icon\"*/}\r\n\t\t\t{/*\tsrc={require('../../assets/imgs/default-profile-icon.jpg')}*/}\r\n\t\t\t{/*\talt=\"default-profile-icon\"*/}\r\n\t\t\t{/*\tonClick={()=>dispatch(['SET_UI_SIDEMENU',!state.UI_SIDEMENU])}/>*/}\r\n\t\t</header>\r\n\t)\r\n}\r\n","import React,{useContext} from 'react'\r\nimport {Link,withRouter} from 'react-router-dom'\r\n\r\nimport './Group.scss'\r\nimport {MainContext} from '../../contexts/MainContext'\r\n\r\nexport default withRouter(function Group({group,location}){\r\n\tconst {state}=useContext(MainContext)\r\n\r\n\tconst {userId}=state\r\n\tconst isAdmin=group.admins.indexOf(+userId)!==-1 // TODO: UserID Check\r\n\tconst title=<>\r\n\t\t<img className=\"mr-12\" src={require('../../assets/imgs/letter.png')} alt=\"Group icon\"/>\r\n\t\t<h3>{group.title}</h3>\r\n\t\t<div className=\"h7 text-muted one-line\">{group.bio}</div>\r\n\t</>\r\n\treturn (\r\n\t\t<div className=\"Group row spc-16\">\r\n\t\t\t{location.pathname.split('/').indexOf('group')===-1?\r\n\t\t\t\t<Link to={location.pathname+'/group/'+group.id} className=\"title col pb-12 pos-rel\">{title}</Link>:\r\n\t\t\t\t<div className=\"title col pb-12 pos-rel\">{title}</div>}\r\n\t\t\t{isAdmin?\r\n\t\t\t\t<Link to={location.pathname+'/edit-group/'+group.id} className=\"fa fa-ellipsis-v h5 super-center px-12\"/>\r\n\t\t\t\t:undefined}\r\n\t\t\t<hr className=\"col-12 col-ext-y\"/>\r\n\t\t\t{group.books.map(bookId=>{\r\n\t\t\t\tconst b=state.BOOKS[bookId]\r\n\t\t\t\treturn b?(\r\n\t\t\t\t\t<Link to={location.pathname+'/book/'+bookId} className=\"col-3 col-2-xl book\" key={bookId}>\r\n\t\t\t\t\t\t<img className=\"col-12 card\" src={b.thumbnail || require('../../assets/imgs/letter.png')} alt=\"PageBook placeholder\"/>\r\n\t\t\t\t\t\t<div className=\"pt-8\">\r\n\t\t\t\t\t\t\t<div className=\"one-line\">{b.title}</div>\r\n\t\t\t\t\t\t\t<div className=\"h7 text-muted one-line\">{b.detail}</div>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</Link>\r\n\t\t\t\t):undefined\r\n\t\t\t})}\r\n\t\t\t{isAdmin?<div className=\"pos-rel col-3 col-2-xl add-book f-self-start\">\r\n\t\t\t\t<img className=\"col-12\" src={require('../../assets/imgs/letter.png')} alt=\"PageBook placeholder\"/>\r\n\t\t\t\t<div className=\"pos-abs stretch-to-fit super-center f-vert\">\r\n\t\t\t\t\t<h3 className=\"mb-6\">&#x002B;</h3>\r\n\t\t\t\t\tAdd Book\r\n\t\t\t\t</div>\r\n\t\t\t</div>:undefined}\r\n\t\t</div>\r\n\t)\r\n})\r\n","import React,{useContext,useEffect} from 'react'\r\nimport {withRouter} from 'react-router-dom'\r\nimport {Scrollbar} from 'react-scrollbars-custom'\r\n\r\nimport './PageDashboard.scss'\r\nimport Header from '../Header/Header'\r\nimport {MainContext,api} from '../../contexts/MainContext'\r\nimport Group from '../Group/Group'\r\n\r\nexport default withRouter(function PageDashboard({location}){\r\n\tconst {state,dispatch}=useContext(MainContext)\r\n\tuseEffect(refresh,[state.userId]) // TODO: Test userId instead of pathname\r\n\tconst user=state.USERS[state.userId]\r\n\r\n\tfunction refresh(){\r\n\t\tif(!state.userId) return\r\n\t\tapi('get','dashboard/'+state.userId).then(({data})=>{\r\n\t\t\tdispatch(['SET_DATA',data])\r\n\t\t}).catch(console.error)\r\n\t}\r\n\r\n\treturn (\r\n\t\t<Scrollbar id=\"PageDashboard\" className=\"pos-abs stretch-to-fit\">\r\n\t\t\t<div className=\"f-vert\">\r\n\t\t\t\t<div className=\"container\">\r\n\t\t\t\t\t{(user?.joined_groups || []).map(groupId=>{\r\n\t\t\t\t\t\tconst group=state.GROUPS[groupId]\r\n\t\t\t\t\t\treturn group?(\r\n\t\t\t\t\t\t\t<Group {...{key:groupId,group}}/>\r\n\t\t\t\t\t\t):undefined\r\n\t\t\t\t\t})}\r\n\t\t\t\t</div>\r\n\t\t\t\t<Header>\r\n\t\t\t\t\t<div className=\"col\"/>\r\n\t\t\t\t\t<div className=\"icon icon-refresh super-center\" onClick={refresh}/>\r\n\t\t\t\t</Header>\r\n\t\t\t</div>\r\n\t\t</Scrollbar>\r\n\t)\r\n})\r\n","import React,{useContext,useState} from 'react'\r\nimport {Link,withRouter} from 'react-router-dom'\r\n\r\nimport './Comment.scss'\r\nimport {MainContext,api} from '../../contexts/MainContext'\r\nimport {setAlert} from '../../utils/Alert/Alert'\r\n\r\nconst whitespaceRegex=/\\s+/\r\n\r\n// TODO: CommentBody\r\n// TODO: Right-click\r\nexport default withRouter(function Comment({location,children,commentId,showChildren}){\r\n\tconst {state,dispatch}=useContext(MainContext)\r\n\tconst [editMode,setEditMode]=useState()\r\n\r\n\tconst comment=state.COMMENTS[commentId]\r\n\tconst user=state.USERS[comment?.user]\r\n\tconst {userId}=state\r\n\r\n\tlet commentBody\r\n\r\n\tif(comment){\r\n\t\tconst selection=comment?.selection_data?JSON.parse(comment?.selection_data):[]\r\n\t\tcommentBody=<>\r\n\t\t\t{/* TODO: selectionIndex data redesign */}\r\n\t\t\t{/* TODO: remove onCLick workaround after node.js backend */}\r\n\t\t\t{selection.map((s,i)=><blockquote\r\n\t\t\t\tkey={i}\r\n\t\t\t\tclassName=\"h7 text-muted mt-2 row cur-p\"\r\n\t\t\t\tonClick={()=>document.querySelector(`#a-${commentId}-0`)?.scrollIntoView({behavior: 'smooth'})}>\r\n\t\t\t\t<div className=\"trim-y col\">{s?.text}</div>\r\n\t\t\t</blockquote>)}\r\n\t\t\t{/*userId+''===comment.user+''?<div className=\"h7 b-700\" style={{marginBottom: '-21px !important'}}>\r\n\t\t\t\t<i className=\"fa fa-plus\"/> Add Highlight\r\n\t\t\t</div>:undefined*/}\r\n\t\t\t<div className=\"h8 my-2 text-right\">{(new Date(comment.created_at)).toLocaleString()}</div> {/* TODO: Beautify */}\r\n\t\t\t<div className=\"bottom-row col-ext-x col-ext-b row spc-8 spc-x-12 f-center\">\r\n\t\t\t\t{/*<i className=\"icon icon-arrow_big_up\" onClick={like}/><div className=\"h7 ml-0\">{comment.liked.length}</div>\r\n\t\t\t\t<i className=\"icon icon-arrow_big_down text-muted\"/><div className=\"h7 ml-0\">{comment.disliked.length}</div>*/}\r\n\t\t\t\t{/*<i className=\"fa fa-star text-muted h6\"/>*/}\r\n\t\t\t\t<div className=\"col\"/>\r\n\t\t\t\t<i className=\"icon icon-reply h6\"/><div className=\"h7 ml-0\">{comment.replys.length}</div>\r\n\t\t\t\t<Link className=\"button super-center\" to={location?.pathname+'/thread/'+commentId}>Open Thread</Link>\r\n\t\t\t\t{userId+''===comment.user+''?<>\r\n\t\t\t\t\t{editMode?<div className=\"edit-form-open pos-abs stretch-to-fit\" onClick={()=>setEditMode(false)}/>:undefined}\r\n\t\t\t\t\t<div className=\"px-12 py-8 col-ext pos-rel f-self-stretch f-center cur-p\" onClick={()=>setEditMode(true)}>\r\n\t\t\t\t\t\t<i className=\"fa fa-ellipsis-v\"/>\r\n\t\t\t\t\t\t<div className={'edit-form pos-abs card trim'+(editMode?' active':' ')}>\r\n\t\t\t\t\t\t\t<div className=\"px-12 py-8 f-center\" onClick={deleteComment}><i className=\"icon-cross_mark mr-8\"/>Delete</div>\r\n\t\t\t\t\t\t\t{/*<div className=\"px-12 py-8\">Edit</div>*/}\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</>:undefined}\r\n\t\t\t</div>\r\n\t\t</>\r\n\t\treturn (\r\n\t\t\t<>\r\n\t\t\t\t<style>{`\r\n\t\t\t\t\tmark-${commentId}.highlight.highlight{ --alpha: 1 }\r\n\t\t\t\t`}</style>\r\n\t\t\t\t<div className=\"Comment\">\r\n\t\t\t\t\t<div id={`b-${commentId}`} className=\"id-tag\"/>\r\n\t\t\t\t\t<div className=\"row pb-4\">\r\n\t\t\t\t\t\t{comment.hidden?undefined:<>\r\n\t\t\t\t\t\t\t<div className=\"h7 hashtag\">{comment.hashtag.split(whitespaceRegex).map((h,i)=><span key={i} className=\"mr-4\">#{h}</span>)}</div>\r\n\t\t\t\t\t\t</>}\r\n\t\t\t\t\t\t<div className=\"col\"/>\r\n\t\t\t\t\t\t<div className=\"h7 text-muted\">@{user.username}</div>\r\n\t\t\t\t\t\t<img className=\"pos-rel\" src={require('../../assets/imgs/default-profile-icon.jpg')} alt=\"User icon\"/>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div className=\"card row f-vert spc-12\">\r\n\t\t\t\t\t\t<div className=\"o ne-line\">{comment.hidden?'[Deleted]':comment.body}</div>\r\n\t\t\t\t\t\t{comment.hidden?undefined:commentBody}\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t\t{showChildren && (children || !!comment?.replys.length) &&\r\n\t\t\t\t<div className=\"reply col-ext row spc-12\">\r\n\t\t\t\t\t<div className=\"col col-ext-x col-ext-t row spc-12 f-vert\">\r\n\t\t\t\t\t\t{comment?.replys.map(c=><Comment key={c} {...{commentId: c,showChildren}}/>)}\r\n\t\t\t\t\t\t{children}\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t\t}\r\n\t\t\t</>\r\n\t\t)\r\n\t}else return undefined\r\n\r\n\tfunction like(){\r\n\t\tapi('put','like/'+commentId,undefined,{headers:{\r\n\t\t\tuserid: userId\r\n\t\t}}).then(({data})=>{\r\n\t\t\tconsole.log(data)\r\n\t\t})\r\n\t}\r\n\r\n\tfunction deleteComment(){\r\n\t\t// TODO: Use commentBody\r\n\t\tsetAlert(\r\n\t\t\t<div className=\"row spc-12\" style={{maxWidth: '320px'}}>\r\n\t\t\t\t<div className=\"col-12\">Do you want to delete this comment?</div>\r\n\t\t\t\t<div className=\"Comment card col-12 row f-vert spc-12\">\r\n\t\t\t\t\t<div className=\"o ne-line\">{comment.body}</div>\r\n\t\t\t\t\t<blockquote className=\"h7 text-muted mt-2 row\">\r\n\t\t\t\t\t\t<div className=\"trim-y col\">{comment.selection_data}</div>\r\n\t\t\t\t\t</blockquote>\r\n\t\t\t\t\t<div className=\"h8 my-2 text-right\">{(new Date(comment.created_at)).toLocaleString()}</div> {/* TODO: Beautify */}\r\n\t\t\t\t</div>\r\n\t\t\t\t<div className=\"bottom-row col-ext-x col-ext-b col-12 row spc-x-12 spc-y-8 f-justify-end\">\r\n\t\t\t\t\t<button className=\"outline\" onClick={()=>setAlert()}>Cancel</button>\r\n\t\t\t\t\t<button onClick={()=>{\r\n\t\t\t\t\t\tapi('delete','comment/'+commentId).then(({data})=>{\r\n\t\t\t\t\t\t\tsetAlert()\r\n\t\t\t\t\t\t\tcomment.hidden=true\r\n\t\t\t\t\t\t\tdispatch(['SET_DATA',{comments: [comment]}])\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t}}>OK</button>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t)\r\n\t}\r\n})\r\n","import {PureComponent} from 'react'\r\n\r\nexport default class MyComponent extends PureComponent{\r\n\t// Used for simple 2-way binding\r\n\t// eg: <input {...this.twoWayBind('stateVariable')}/> will return\r\n\t// <input value={this.state['stateVariable']} onChange={e=>this.setState({'stateVariable':e.target.value}}/>\r\n\t// TODO: Finish example for different params\r\n\ttwoWayBind=(property,event='onChange',valAttr='value')=>({\r\n\t\t[valAttr]:this.state[property],\r\n\t\t[event]:e=>this.setState({[property]:e.target[valAttr]}),\r\n\t})\r\n}","import React from 'react'\r\nimport {withRouter} from 'react-router-dom'\r\nimport {Scrollbar} from 'react-scrollbars-custom'\r\n\r\nimport './CommentThread.scss'\r\nimport Comment from '../Comment/Comment'\r\nimport MyComponent from '../MyComponent'\r\nimport {MainContext,nonAlphaNumericRegex,api} from '../../contexts/MainContext'\r\n\r\nconst initState=JSON.stringify({\r\n\tbody: '',\r\n\thashtag: '',\r\n})\r\nexport default withRouter(class CommentThread extends MyComponent{\r\n\tstatic contextType=MainContext\r\n\tstate=JSON.parse(initState)\r\n\r\n\tonSubmit=e=>{\r\n\t\te.preventDefault()\r\n\t\tconst commentId=this.props.match.params.id\r\n\t\tconst {body,hashtag}=this.state\r\n\t\tconst {COMMENTS,BOOKS,userId}=this.context.state\r\n\t\tconst comment=COMMENTS[commentId]\r\n\t\tapi('post','comment/',{\r\n\t\t\tbody,\r\n\t\t\thashtag: hashtag.replace(nonAlphaNumericRegex,'').trim(),\r\n\t\t\tuser: userId,\r\n\t\t\tbook: comment.book,\r\n\t\t\treplyto: commentId,\r\n\t\t\ttypeof: 'reply'\r\n\t\t}).then(({data})=>{\r\n\t\t\tCOMMENTS[commentId].replys.push(data.id)\r\n\t\t\tconsole.log({comments: [data,COMMENTS[commentId]]})\r\n\t\t\tconst book=BOOKS[comment.book]\r\n\t\t\tbook.comment_set.push(data.id)\r\n\t\t\tthis.context.dispatch(['SET_DATA',{comments: [data,COMMENTS[commentId]],books: [book]}])\r\n\t\t\tthis.setState(JSON.parse(initState))\r\n\t\t})\r\n\t}\r\n\r\n\trender(){\r\n\t\t// console.log(this.props)\r\n\t\tconst {onSubmit}=this\r\n\t\tconst {history,match}=this.props\r\n\t\tconst commentId=match.params.id\r\n\t\tconst {userId,USERS}=this.context.state\r\n\r\n\t\treturn (\r\n\t\t\t<div className=\"CommentThread pos-abs stretch-to-fit row spc-12 f-justify-end\">\r\n\t\t\t\t<div className=\"p-12 f-start f-justify-end f-self-start\">\r\n\t\t\t\t\t<div className=\"h5 icon icon-cross_mark\" onClick={history.goBack} style={{cursor: 'pointer'}}/>\r\n\t\t\t\t</div>\r\n\t\t\t\t<Scrollbar disableTracksWidthCompensation className=\"thread-container col\" style={{height: 'auto'}}>\r\n\t\t\t\t\t<div className=\"row spc-12 f-vert pos-rel\">\r\n\t\t\t\t\t\t<Comment {...{commentId,showChildren: true}}>\r\n\t\t\t\t\t\t\t<div className=\"reply-input\">\r\n\t\t\t\t\t\t\t\t<div className=\"top-row row pb-4 f-justify-end\">\r\n\t\t\t\t\t\t\t\t\t<div className=\"col\"/>\r\n\t\t\t\t\t\t\t\t\t<div className=\"h7 text-muted\">@{USERS[userId]?.username || 'Username'}</div>\r\n\t\t\t\t\t\t\t\t\t<img className=\"pos-rel\" src={require('../../assets/imgs/default-profile-icon.jpg')} alt=\"User icon\"/>\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t<form className=\"form row spc-12\" {...{onSubmit}}>\r\n\t\t\t\t\t\t\t\t\t<div className=\"h7 col-12 my-2\">Add reply</div>\r\n\t\t\t\t\t\t\t\t\t<textarea required className=\"col-12\" cols=\"30\" rows=\"10\" placeholder=\"Reply\" {...this.twoWayBind('body')}/>\r\n\t\t\t\t\t\t\t\t\t<input type=\"text\" className=\"col\" placeholder=\"#Hashtag\" {...this.twoWayBind('hashtag')}/>\r\n\t\t\t\t\t\t\t\t\t<button>Post</button>\r\n\t\t\t\t\t\t\t\t</form>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</Comment>\r\n\t\t\t\t\t\t{/*<div style={{height: '1000px'}}/>*/}\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</Scrollbar>\r\n\t\t\t</div>\r\n\t\t)\r\n\t}\r\n})\r\n","export function getChildNodeIndex(element){\r\n\treturn Array.from(element.parentNode.children).indexOf(element)\r\n}\r\n\r\n// Warning: Will fail if whitespaces are present\r\nexport function getSelectionOffsetFromParent(node,parent,offset=0){\r\n\tconsole.warn('getSelectionOffsetFromParent: Will fail if whitespaces are present')\r\n\twhile(1){\r\n\t\tif(node===parent) return offset\r\n\t\tif(node.previousSibling){\r\n\t\t\tnode=node.previousSibling\r\n\t\t\toffset+=((node.innerText)?node.innerText.length:node.length)\r\n\t\t\tcontinue\r\n\t\t}\r\n\t\tnode=node.parentNode\r\n\t}\r\n}","import React from 'react'\r\n\r\nimport './Spinner.scss'\r\n\r\nexport default function Spinner({className}){\r\n\treturn (\r\n\t\t<div className={'spinner pos-abs stretch-to-fit super-center '+className}>\r\n\t\t\t<img className=\"p-8\" src={require('../../assets/imgs/spinner.gif')} alt=\"Spinner\"/>\r\n\t\t</div>\r\n\t)\r\n}","import React,{memo,useState} from 'react'\r\nimport * as pdfjs from 'pdfjs-dist'\r\nimport _ from 'lodash'\r\n\r\nimport Spinner from '../Spinner/Spinner'\r\n\r\npdfjs.GlobalWorkerOptions.workerSrc=`//cdnjs.cloudflare.com/ajax/libs/pdf.js/${pdfjs.version}/pdf.worker.js`\r\n\r\nexport default pdfjs\r\n\r\nexport const PdfImage=memo(function({page,viewport}){\r\n\tconst [data,setData]=useState(undefined)\r\n\tif(!data){\r\n\t\tconst canvas=document.createElement('canvas')\r\n\t\tconst canvasContext=canvas.getContext('2d')\r\n\t\tcanvas.height=viewport.height\r\n\t\tcanvas.width=viewport.width\r\n\r\n\t\tpage.render({canvasContext,viewport}).promise.then(()=>setData(canvas.toDataURL()))\r\n\t\treturn <Spinner className=\"active\"/> // TODO: Change spinner background to white\r\n\t}else\r\n\t\treturn <img src={data} alt=\"\"/>\r\n})\r\n\r\nexport const TextLayer=memo(function({page,viewport,pageComments}){\r\n\tconst [__html,setHtml]=useState(undefined)\r\n\tif(!__html){\r\n\t\tpage.getTextContent().then(textContent=>{\r\n\t\t\t// console.log(textContent)\r\n\t\t\tconst textDiv=document.createElement('div')\r\n\t\t\tpdfjs.renderTextLayer({\r\n\t\t\t\ttextContent,\r\n\t\t\t\tcontainer: textDiv,\r\n\t\t\t\tviewport,\r\n\t\t\t\ttextDivs:  [],\r\n\t\t\t}).promise.then(()=>{\r\n\t\t\t\tif(pageComments){\r\n\t\t\t\t\tconst lineData={}\r\n\t\t\t\t\tpageComments?.forEach(c=>{ // eslint-disable-line no-unused-expressions\r\n\t\t\t\t\t\tJSON.parse(c.selection_data || '[]').forEach((s,i)=>s.data.forEach(p=>{\r\n\t\t\t\t\t\t\tif(!lineData[p.startLine]) lineData[p.startLine]=[]\r\n\t\t\t\t\t\t\tlineData[p.startLine].push({id: c.id,i,offset: p.startOffset,start: true})\r\n\t\t\t\t\t\t\tif(!lineData[p.endLine]) lineData[p.endLine]=[]\r\n\t\t\t\t\t\t\tlineData[p.endLine].push({id: c.id,i,offset: p.endOffset,start: false})\r\n\t\t\t\t\t\t}))\r\n\t\t\t\t\t})\r\n\r\n\t\t\t\t\tconst openStack=[]\r\n\t\t\t\t\tArray.from(textDiv.children).forEach((lineEle,lineNum)=>{\r\n\t\t\t\t\t\tconst l=lineData[lineNum]\r\n\t\t\t\t\t\tconst substrings=openStack.map(data=>`<mark-${data.id} id=\"a-${data.id}-${data.i}\" class=\"highlight\">`)\r\n\t\t\t\t\t\tif(l){ // If selection present in this line\r\n\t\t\t\t\t\t\tl.sort((a,b)=>a.offset-b.offset)\r\n\t\t\t\t\t\t\tl.forEach((data,i)=>{\r\n\t\t\t\t\t\t\t\tsubstrings.push(\r\n\t\t\t\t\t\t\t\t\t_.escape(lineEle.innerText.substring((i-1<0)?0:l[i-1].offset,l[i].offset)),\r\n\t\t\t\t\t\t\t\t\tdata.start?`<mark-${data.id} id=\"a-${data.id}-${data.i}\" class=\"highlight\">`:`</mark-${data.id}>`\r\n\t\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t\t\tif(data.start){\r\n\t\t\t\t\t\t\t\t\topenStack.push(data)\r\n\t\t\t\t\t\t\t\t\t// console.log('push',[...openStack],data,lineNum)\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\t\t\t// console.log('splice',[...openStack],data,openStack.findIndex(d=>d.id===data.id),lineNum)\r\n\t\t\t\t\t\t\t\t\topenStack.splice(openStack.findIndex(d=>d.id===data.id),1)\r\n\t\t\t\t\t\t\t\t\tsubstrings.push(...openStack.map(data=>`<mark-${data.id} id=\"a-${data.id}-${data.i}\" class=\"highlight\">`))\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\tsubstrings.push(_.escape(lineEle.innerText.substring((l.pop()).offset,lineEle.innerText.length)))\r\n\t\t\t\t\t\t\topenStack.forEach(data=>substrings.push(`</mark-${data.id}>`))\r\n\t\t\t\t\t\t\t// console.log(substrings,substrings.join(''),[...openStack],lineNum)\r\n\t\t\t\t\t\t}else substrings.push(lineEle.innerHTML)\r\n\t\t\t\t\t\tlineEle.innerHTML=substrings.join('')\r\n\t\t\t\t\t\t// console.log(lineEle.innerHTML)\r\n\t\t\t\t\t})\r\n\t\t\t\t}\r\n\t\t\t\tsetHtml(textDiv.innerHTML)\r\n\t\t\t})\r\n\t\t}).catch(console.error)\r\n\t\treturn <Spinner className=\"active\"/>\r\n\t}else\r\n\t\treturn <div className=\"text-layer pos-abs stretch-to-fit\" dangerouslySetInnerHTML={{__html}}/>\r\n})","import React,{createRef} from 'react'\r\nimport {withRouter} from 'react-router-dom'\r\nimport _ from 'lodash'\r\nimport {Scrollbar} from 'react-scrollbars-custom'\r\n\r\nimport './PdfVerticalScroll.scss'\r\nimport {getChildNodeIndex,getSelectionOffsetFromParent} from '../../helper'\r\nimport {PdfImage,TextLayer} from '../../utils/PDFRenderer/PDFRenderer'\r\nimport MyComponent from '../MyComponent'\r\nimport {NewCommentBubble,setBubblePos,setSelection} from '../PageBook/PageBook'\r\n\r\n// TODO: Extra - PDF download progressbar\r\n// TODO: Extra - Password protected PDFs\r\n\r\n// TODO: Maybe remove\r\nconst customHighlightLayer=document.createElement('div')\r\ncustomHighlightLayer.classList.add('custom-highlight-layer','pos-abs','stretch-to-fit')\r\n// const isArray=a=>(!!a) && a.constructor===Array\r\n\r\nconst logLifecycle=false\r\n// Class component for componentWillUnmount()\r\n// Change back to functional component\r\nexport default withRouter(class PdfVerticalScroll extends MyComponent{\r\n\tconstructor(props){\r\n\t\tsuper(props)\r\n\t\tthis.ref=createRef()\r\n\t}\r\n\r\n\t// TODO: move componentWillUnmount to PageBook\r\n\tcomponentWillUnmount(){\r\n\t\tlogLifecycle && console.log('PdfVerticalScroll componentWillUnmount')\r\n\t\t// console.log(this.props.pdf.pdf.destroy)\r\n\t\tthis.props.pdf.pdf.destroy()\r\n\t}\r\n\r\n\trender(){\r\n\t\tlogLifecycle && console.log('PdfVerticalScroll render')\r\n\r\n\t\tconst {publicPrivateMode,pdf,selection,book,pageWiseComments}=this.props\r\n\t\tconst {onClick,ref}=this\r\n\r\n\t\treturn (\r\n\t\t\t<Scrollbar className=\"PdfVerticalScroll\" disableTracksWidthCompensation>\r\n\t\t\t\t<div className=\"row f-center f-vert spc-12\" {...{onClick,ref}}>\r\n\t\t\t\t\t{pdf?.pages?.map((page,i)=>{\r\n\t\t\t\t\t\tconst viewport=pdf.viewports[i]\r\n\t\t\t\t\t\treturn <div key={page._pageIndex} className=\"card pos-rel f-super-center trim page\" style={_.pick(viewport,['width','height'])} data-page-index={i}>\r\n\t\t\t\t\t\t\t<PdfImage {...{page,viewport}}/>\r\n\t\t\t\t\t\t\t<TextLayer {...{page,viewport,pageComments: pageWiseComments[i]}}/>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t})}\r\n\t\t\t\t</div>\r\n\t\t\t\t<NewCommentBubble {...{publicPrivateMode,selection,book}}/>\r\n\t\t\t</Scrollbar>\r\n\t\t)\r\n\t}\r\n\r\n\tonClick=()=>{\r\n\t\ttry{\r\n\t\t\tconst s=window.getSelection()\r\n\t\t\tif(s.toString()==='') throw new Error('No text selected')\r\n\t\t\tlet {anchorNode,focusNode}=s\r\n\t\t\twhile(!anchorNode.closest) anchorNode=anchorNode.parentNode\r\n\t\t\twhile(!focusNode.closest) focusNode=focusNode.parentNode\r\n\r\n\t\t\tconst anchorNodeSpan=anchorNode.closest('span')\r\n\t\t\tconst focusNodeSpan=focusNode.closest('span')\r\n\t\t\tlet selection={\r\n\t\t\t\tstartPage:   +anchorNode.closest('.page').dataset.pageIndex,\r\n\t\t\t\tstartLine:   getChildNodeIndex(anchorNodeSpan),\r\n\t\t\t\tstartOffset: getSelectionOffsetFromParent(anchorNode,anchorNodeSpan,s.anchorOffset),\r\n\t\t\t\tendPage:     +focusNode.closest('.page').dataset.pageIndex,\r\n\t\t\t\tendLine:     getChildNodeIndex(focusNodeSpan),\r\n\t\t\t\tendOffset:   getSelectionOffsetFromParent(focusNode,focusNodeSpan,s.focusOffset),\r\n\t\t\t}\r\n\r\n\t\t\t// if selection is in reverse order, swap selection start and end\r\n\t\t\tif(\r\n\t\t\t\tselection.endPage<selection.startPage ||       // eslint-disable-line no-mixed-operators\r\n\t\t\t\tselection.endPage===selection.startPage && (   // eslint-disable-line no-mixed-operators\r\n\t\t\t\t\tselection.endLine<selection.startLine ||     // eslint-disable-line no-mixed-operators\r\n\t\t\t\t\tselection.endLine===selection.startLine && ( // eslint-disable-line no-mixed-operators\r\n\t\t\t\t\t\tselection.endOffset<selection.startOffset  // eslint-disable-line no-mixed-operators\r\n\t\t\t\t\t)\r\n\t\t\t\t)\r\n\t\t\t){\r\n\t\t\t\tselection={\r\n\t\t\t\t\tstartPage:   selection.endPage,\r\n\t\t\t\t\tstartLine:   selection.endLine,\r\n\t\t\t\t\tstartOffset: selection.endOffset,\r\n\t\t\t\t\tendPage:     selection.startPage,\r\n\t\t\t\t\tendLine:     selection.startLine,\r\n\t\t\t\t\tendOffset:   selection.startOffset,\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tconst pagesDOM=Array.from(this.ref.current.children).slice(\r\n\t\t\t\tselection.startPage,\r\n\t\t\t\tselection.endPage+1,\r\n\t\t\t)\r\n\t\t\tif(pagesDOM.length===1){\r\n\t\t\t\tselection=[{\r\n\t\t\t\t\tpage:        selection.startPage,\r\n\t\t\t\t\tstartLine:   selection.startLine,\r\n\t\t\t\t\tstartOffset: selection.startOffset,\r\n\t\t\t\t\tendLine:     selection.endLine,\r\n\t\t\t\t\tendOffset:   selection.endOffset,\r\n\t\t\t\t}]\r\n\t\t\t}else{\r\n\t\t\t\tthrow new Error('Multi-page selection disabled')\r\n\t\t\t\tconst startPage=pagesDOM.shift()\r\n\t\t\t\tconst startPageLines=startPage.children[1].children\r\n\t\t\t\tconst startPageLastLine=Array.from(startPageLines).pop()\r\n\t\t\t\t/*const lastPage=*/pagesDOM.pop()\r\n\t\t\t\tselection=[\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tpage:        selection.startPage,\r\n\t\t\t\t\t\tstartLine:   selection.startLine,\r\n\t\t\t\t\t\tstartOffset: selection.startOffset,\r\n\t\t\t\t\t\tendLine:     startPageLines.length-1,\r\n\t\t\t\t\t\tendOffset:   startPageLastLine.innerText.length,\r\n\t\t\t\t\t},\r\n\t\t\t\t\t...pagesDOM.map((page,i)=>{\r\n\t\t\t\t\t\tconst pageLines=page.children[1].children\r\n\t\t\t\t\t\tconst pageLastLine=Array.from(pageLines).pop()\r\n\t\t\t\t\t\treturn {\r\n\t\t\t\t\t\t\tpage: selection.startPage+i+1,\r\n\t\t\t\t\t\t\tstartLine:   0,\r\n\t\t\t\t\t\t\tstartOffset: 0,\r\n\t\t\t\t\t\t\tendLine:     pageLines.length-1,\r\n\t\t\t\t\t\t\tendOffset:   pageLastLine.innerText.length,\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}),\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tpage:        selection.endPage,\r\n\t\t\t\t\t\tstartLine:   0,\r\n\t\t\t\t\t\tstartOffset: 0,\r\n\t\t\t\t\t\tendLine:     selection.endLine,\r\n\t\t\t\t\t\tendOffset:   selection.endOffset,\r\n\t\t\t\t\t},\r\n\t\t\t\t]\r\n\t\t\t}\r\n\r\n\t\t\tconst focusNodeClientRect=focusNode.getBoundingClientRect()\r\n\t\t\tconst scrollNode=focusNode.closest('.ScrollbarsCustom-Scroller')\r\n\r\n\t\t\tconsole.log(selection)\r\n\t\t\tsetSelection({\r\n\t\t\t\ttype: 'text',\r\n\t\t\t\ttext: s.toString(),\r\n\t\t\t\tdata: selection,\r\n\t\t\t})\r\n\t\t\tsetBubblePos({\r\n\t\t\t\ttop: focusNodeClientRect.top+focusNodeClientRect.height+scrollNode.scrollTop,\r\n\t\t\t\t// left: focusNodeClientRect.left+focusNodeClientRect.width\r\n\t\t\t})\r\n\t\t}catch(e){\r\n\t\t\tconsole.log(e)\r\n\t\t\t// TODO: reset selection\r\n\t\t\tsetSelection(undefined)\r\n\t\t\tsetBubblePos({})\r\n\t\t}\r\n\t}\r\n\r\n\t// function onLoadSuccess({numPages}){\r\n\t// \t// numPages=3\r\n\t// \t// const pages=new Array(numPages)\r\n\t// \t// for(let i=0,l={loaded: 0};i<numPages;++i){\r\n\t// \t// \t// pages[i]=\r\n\t// \t// \t// \t<Page\r\n\t// \t// \t// \t\tkey={i}\r\n\t// \t// \t// \t\tpageNumber={i+1}\r\n\t// \t// \t// \t\trenderAnnotationLayer={false}\r\n\t// \t// \t// \t\trenderTextLayer={true}\r\n\t// \t// \t// \t\twidth={900}\r\n\t// \t// \t// \t\tonGetTextSuccess={()=>{\r\n\t// \t// \t// \t\t\tref.current.children[i].appendChild(customHighlightLayer.cloneNode(true))\r\n\t// \t// \t// \t\t\tsetTextLoaded(++l.loaded===numPages)\r\n\t// \t// \t// \t\t}}\r\n\t// \t// \t// \t\t// {...{customTextRenderer}}\r\n\t// \t// \t// \t/>\r\n\t// \t// }\r\n\t//\r\n\t// \t// setPageState({numPages,pages})\r\n\t// }\r\n\r\n\t// function customTextRenderer(p){\r\n\t// \tconst pageIndex=p.page._pageIndex\r\n\t// \tconst l=marksFormatted[pageIndex]?.[lineIndex]\r\n\t// \tlet __html=tagStack.map(t=>`<mark-${t} class=\"mark\">`).join('')\r\n\t// \tif(l){\r\n\t// \t\tconst len=p.str.length\r\n\t// \t\tconst indices=[0,...l.map(l=>l.offset)]\r\n\t// \t\tconst substrings=[]\r\n\t// \t\tl.forEach((o,i)=>{\r\n\t// \t\t\tsubstrings.push(\r\n\t// \t\t\t\t_.escape(p.str.substring(indices[i],indices[i+1])),\r\n\t// \t\t\t\to.start?`<mark-${o.i} class=\"mark\">`:`</mark-${o.i}>`,\r\n\t// \t\t\t)\r\n\t// \t\t})\r\n\t// \t\tsubstrings.push(_.escape(p.str.substring(indices.pop(),len)))\r\n\t// \t\t__html+=substrings.join('')\r\n\t// \t}else\r\n\t// \t\t__html+=_.escape(p.str)\r\n\t//\r\n\t// \tl && l.forEach(o=>\r\n\t// \t\to.start?\r\n\t// \t\t\ttagStack.push(o.i):\r\n\t// \t\t\ttagStack.splice(tagStack.indexOf(o.i),1)\r\n\t// \t)\r\n\t//\r\n\t// \t++lineIndex\r\n\t// \treturn <span dangerouslySetInnerHTML={{__html}}/>\r\n\t// }\r\n\r\n\t// function didUpdate(){\r\n\t// \tif(!textLoaded) return\r\n\t//\r\n\t// \tconst fragments={}\r\n\t// \tconst createGetFragment=pageNumber=>fragments[pageNumber]??(fragments[pageNumber]=document.createDocumentFragment())\r\n\t//\r\n\t// \t// TODO: check state.COMMENTS[c]?.position_data\r\n\t// \t// const highlightStack=book.comment_set.map(c=>state.COMMENTS[c]?.position_data).flatMap(p=>{\r\n\t// \t// \ttry{ return [JSON.parse(p).forEach((p,i)=>p.forEach((p,j)=>{\r\n\t// \t// \t\tp.commentId\r\n\t// \t// \t})).flat(2)] }\r\n\t// \t// \tcatch{ return [] }\r\n\t// \t// })\r\n\t//\r\n\t// \tconst highlights=[]\r\n\t// \tbook.comment_set.map(cid=>state.COMMENTS[cid]).forEach(c=>{\r\n\t// \t\tlet posData\r\n\t// \t\ttry{posData=JSON.parse(c.position_data)}catch{return}\r\n\t// \t\tisArray(posData) && posData.forEach((selectionData,i)=>isArray(selectionData) && selectionData.forEach(\r\n\t// \t\t\t(highlightData,j)=>{\r\n\t// \t\t\t\thighlights.push({\r\n\t// \t\t\t\t\tcommentId: c.id,\r\n\t// \t\t\t\t\tselectionIndex: i,\r\n\t// \t\t\t\t\thighlightFragment: j,\r\n\t// \t\t\t\t\t...highlightData,\r\n\t// \t\t\t\t})\r\n\t// \t\t\t}\r\n\t// \t\t))\r\n\t// \t})\r\n\t// \thighlights.forEach(h=>{\r\n\t// \t\tconst hs=JSON.stringify(h)\r\n\t// \t\tif(!rendered[hs]){\r\n\t// \t\t\trendered[hs]=true\r\n\t// \t\t\tconst span=document.createElement('span')\r\n\t// \t\t\tspan.id='a'+h.commentId+h.selectionIndex\r\n\t// \t\t\tspan.classList=\r\n\t// \t\t\t\t' a'+h.commentId+\r\n\t// \t\t\t\t' a'+h.commentId+h.selectionIndex+\r\n\t// \t\t\t\t' a'+h.commentId+h.selectionIndex+h.highlightFragment\r\n\t// \t\t\tspan.onclick=()=>document.querySelector(`#b${h.commentId}`)?.scrollIntoView({behavior: 'smooth'}) // eslint-disable-line no-unused-expressions\r\n\t// \t\t\tgetHighlightTags(h,span)\r\n\t// \t\t\tcreateGetFragment(h.page).appendChild(span)\r\n\t// \t\t}\r\n\t// \t})\r\n\t// \t_.forIn(fragments,(fragment,pageNumber)=>ref.current.children[pageNumber].children[2].appendChild(fragment))\r\n\t// }\r\n\r\n\t// function getHighlightTags(h,fragment){\r\n\t// \tconst page=ref.current.children[h.page]\r\n\t// \tconst textLayer=page.children[1]\r\n\t// \tconst lines=Array.from(textLayer.children).slice(h.startLine,h.endLine+1)\r\n\t// \tif(lines.length===1){\r\n\t// \t\tconst line=lines[0].cloneNode(true)\r\n\t// \t\tline.innerHTML=\r\n\t// \t\t\t_.escape(line.innerText.substring(0,h.startOffset))+`<span class=\"mark\">`+\r\n\t// \t\t\t_.escape(line.innerText.substring(h.startOffset,h.endOffset))+`</span>`+\r\n\t// \t\t\t_.escape(line.innerText.substring(h.endOffset,line.innerText.length))\r\n\t// \t\tfragment.appendChild(line)\r\n\t// \t}else{\r\n\t// \t\ttry{\r\n\t// \t\t\tconst firsLine=lines.shift().cloneNode(true)\r\n\t// \t\t\tconst lastLine=lines.pop().cloneNode(true)\r\n\t//\r\n\t// \t\t\tfirsLine.innerHTML=\r\n\t// \t\t\t\t_.escape(firsLine.innerText.substring(0,h.startOffset))+`<span class=\"mark\">`+\r\n\t// \t\t\t\t_.escape(firsLine.innerText.substring(h.startOffset,firsLine.innerText.length))\r\n\t// \t\t\tfragment.appendChild(firsLine)\r\n\t//\r\n\t// \t\t\tlines.forEach(line=>{\r\n\t// \t\t\t\tconst m=line.cloneNode(true)\r\n\t// \t\t\t\tm.classList='mark'\r\n\t// \t\t\t\tfragment.appendChild(m)\r\n\t// \t\t\t})\r\n\t//\r\n\t// \t\t\tlastLine.innerHTML=\r\n\t// \t\t\t\t`<span class=\"mark\">`+\r\n\t// \t\t\t\t_.escape(lastLine.innerText.substring(0,h.endOffset))+`</span>`+\r\n\t// \t\t\t\t_.escape(lastLine.innerText.substring(h.endOffset,lastLine.innerText.length))\r\n\t// \t\t\tfragment.appendChild(lastLine)\r\n\t// \t\t}catch{}\r\n\t// \t}\r\n\t// }\r\n})\r\n","import React,{useContext,useEffect,useState} from 'react'\r\nimport {withRouter,Route,Link} from 'react-router-dom'\r\nimport {Scrollbar} from 'react-scrollbars-custom'\r\n\r\nimport './PageBook.scss'\r\nimport Header from '../Header/Header'\r\nimport SegmentControls from '../../utils/SegmentControls/SegmentControls'\r\nimport tabStart from '../../assets/imgs/tab-start.svg'\r\nimport Comment from '../Comment/Comment'\r\nimport CommentThread from '../CommentThread/CommentThread'\r\nimport PdfVerticalScroll from '../PdfVerticalScroll/PdfVerticalScroll'\r\nimport {MainContext,api} from '../../contexts/MainContext'\r\nimport Spinner from '../../utils/Spinner/Spinner'\r\nimport NewQuestionComment from '../NewQuestionComment/NewQuestionComment'\r\nimport pdfjs from '../../utils/PDFRenderer/PDFRenderer'\r\n\r\nexport const sidebarModes=['question','comment','note','highlight']\r\nexport const publicPrivateModes={\r\n\t'question' : 'public',\r\n\t'comment'  : 'public',\r\n\t'note'     : 'private',\r\n\t'highlight': 'private',\r\n}\r\nexport let setSidebarMode,setSelection\r\nexport default withRouter(function PageBook({history,match,location}){\r\n\tconst {state,dispatch}=useContext(MainContext)\r\n\tlet sidebarMode,selection\r\n\t;[sidebarMode,setSidebarMode]=useState('comment') // TODO: Change to path variable\r\n\tconst publicPrivateMode=publicPrivateModes[sidebarMode]\r\n\tconst [userFilter,setUserFilter]=useState(false)\r\n\tconst [publicSearchString,setPublicSearchString]=useState('')\r\n\t;[selection,setSelection]=useState(undefined)\r\n\tconst [pdf,setPdf]=useState(undefined)\r\n\tuseEffect(()=>{componentDidMount()},[]) // eslint-disable-line react-hooks/exhaustive-deps\r\n\tuseEffect(refresh,[location.pathname])\r\n\r\n\tconst book=state.BOOKS[match.params.id]\r\n\tconst group=state.GROUPS[book?.group_id] // TODO: Backend group_id\r\n\tconst {userId}=state\r\n\r\n\tconst [categorized,setCategorized]=useState({\r\n\t\t'question' : [],\r\n\t\t'comment'  : [],\r\n\t\t'note'     : [],\r\n\t\t'highlight': [],\r\n\t})\r\n\tconst [pageWiseComments,setPageWiseComments]=useState([])\r\n\tuseEffect(()=>{\r\n\t\tconsole.log('useEffect')\r\n\t\tconst categorized={\r\n\t\t\t'question' : [],\r\n\t\t\t'comment'  : [],\r\n\t\t\t'note'     : [],\r\n\t\t\t'highlight': [],\r\n\t\t} // Categorizing comments based on type\r\n\t\tconst allComments=[]\r\n\t\tbook?.comment_set.forEach(c=>{ // eslint-disable-line no-unused-expressions\r\n\t\t\tc=state.COMMENTS[c]\r\n\t\t\tif(!c) return\r\n\t\t\tif(!categorized[c.typeof]) categorized[c.typeof]=[]\r\n\t\t\tif(!c.hidden){\r\n\t\t\t\tcategorized[c.typeof].push(c)\r\n\t\t\t\tallComments.push(c)\r\n\t\t\t}\r\n\t\t})\r\n\t\tsetCategorized(categorized)\r\n\t\tconst pageWiseComments={}\r\n\t\tallComments.forEach(c=>{\r\n\t\t\tJSON.parse(c.selection_data || '[]').forEach(s=>s.data.forEach(p=>{\r\n\t\t\t\tconst pageNum=+p.page\r\n\t\t\t\tif(!pageWiseComments[pageNum]) pageWiseComments[pageNum]=[]\r\n\t\t\t\tpageWiseComments[pageNum].push(c)\r\n\t\t\t}))\r\n\t\t})\r\n\t\tsetPageWiseComments(pageWiseComments)\r\n\t},[book?.comment_set]) // eslint-disable-line react-hooks/exhaustive-deps\r\n\r\n\tconst filtered=categorized[sidebarMode].filter(comment=>(\r\n\t\t(!userFilter || (userFilter || publicPrivateMode!=='public') && ''+comment.user===''+userId) && // eslint-disable-line\r\n\t\t(comment.hashtag.indexOf(publicSearchString)!==-1)\r\n\t))\r\n\r\n\tfunction refresh(){\r\n\t\tapi('get','readingbook/'+match.params.id).then(({data})=>{\r\n\t\t\tdispatch(['SET_DATA',data])\r\n\t\t}).catch(console.error)\r\n\t}\r\n\r\n\tasync function componentDidMount(){\r\n\t\t// console.log('PageBook componentDidMount')\r\n\t\tif(book?.docfile){\r\n\t\t\tconst pdfLoadTask=pdfjs.getDocument(book.docfile)\r\n\t\t\tpdfLoadTask.onProgress=({loaded,total})=>console.log(loaded/total*100)\r\n\t\t\t// console.log(pdfLoadTask)\r\n\t\t\tconst pdf=await pdfLoadTask.promise\r\n\t\t\t// console.log(pdf)\r\n\t\t\tconst promises=new Array(pdf.numPages)\r\n\t\t\tfor(let i=0;i<promises.length;++i) promises[i]=pdf.getPage(i+1)\r\n\t\t\tconst pages=await Promise.all(promises)\r\n\t\t\tconst viewports=generateViewports(pages,1.5)\r\n\t\t\t// console.log(pages,viewports)\r\n\t\t\tsetPdf({pdf,pages,viewports})\r\n\t\t}\r\n\t}\r\n\r\n\t// re-use when zooming\r\n\tfunction generateViewports(pages,scale){\r\n\t\treturn pages.map(p=>p.getViewport({scale}))\r\n\t}\r\n\r\n\treturn (\r\n\t\t<div id=\"PageBook\" className=\"pos-abs stretch-to-fit f-vert\">\r\n\t\t\t<section className=\"row main-section\">\r\n\t\t\t\t<div className=\"col left-sidebar pos-rel\">\r\n\t\t\t\t\t<PdfVerticalScroll {...{pdf,publicPrivateMode,selection,book,pageWiseComments}}/>\r\n\t\t\t\t\t<Spinner className={pdf?.pdf?'':'active'}/>\r\n\t\t\t\t\t<Route path=\"*/new-comment\" render={props=><NewQuestionComment {...{props,selection,book,sidebarMode,}}/>}/>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div className=\"right-sidebar row pos-rel p-12 pl-0\">\r\n\t\t\t\t\t<div className=\"vertical-tabs f-vert\">\r\n\t\t\t\t\t\t<div className=\"col\" style={{maxHeight: '14px'}}/>\r\n\t\t\t\t\t\t{publicPrivateMode==='public'?<>\r\n\t\t\t\t\t\t\t<div className={sidebarMode==='question'?'active':''} onClick={()=>setSidebarMode('question')}>\r\n\t\t\t\t\t\t\t\t<img src={tabStart} alt=\"\"/>\r\n\t\t\t\t\t\t\t\t<div className=\"vertical-text px-4\">Questions <span className=\"h7\">\r\n\t\t\t\t\t\t\t\t\t{categorized['question'].length}\r\n\t\t\t\t\t\t\t\t</span></div>\r\n\t\t\t\t\t\t\t\t<img src={tabStart} alt=\"\"/>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t<div className={sidebarMode==='comment'?'active':''} onClick={()=>setSidebarMode('comment')}>\r\n\t\t\t\t\t\t\t\t<img src={tabStart} alt=\"\"/>\r\n\t\t\t\t\t\t\t\t<div className=\"vertical-text px-4\">Comments <span className=\"h7\">\r\n\t\t\t\t\t\t\t\t\t{categorized['comment'].length}\r\n\t\t\t\t\t\t\t\t</span></div>\r\n\t\t\t\t\t\t\t\t<img src={tabStart} alt=\"\"/>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</>:<>\r\n\t\t\t\t\t\t\t<div className={sidebarMode==='note'?'active':''} onClick={()=>setSidebarMode('note')}>\r\n\t\t\t\t\t\t\t\t<img src={tabStart} alt=\"\"/>\r\n\t\t\t\t\t\t\t\t<div className=\"vertical-text px-4\">Notes <span className=\"h7\">\r\n\t\t\t\t\t\t\t\t\t{categorized['note'].length}\r\n\t\t\t\t\t\t\t\t</span></div>\r\n\t\t\t\t\t\t\t\t<img src={tabStart} alt=\"\"/>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t<div className={sidebarMode==='highlight'?'active':''} onClick={()=>setSidebarMode('highlight')}>\r\n\t\t\t\t\t\t\t\t<img src={tabStart} alt=\"\"/>\r\n\t\t\t\t\t\t\t\t<div className=\"vertical-text px-4\">Highlights <span className=\"h7\">\r\n\t\t\t\t\t\t\t\t\t{categorized['highlight'].length}\r\n\t\t\t\t\t\t\t\t</span></div>\r\n\t\t\t\t\t\t\t\t<img src={tabStart} alt=\"\"/>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</>}\r\n\t\t\t\t\t\t<span className=\"col\"/>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div className=\"col trim\">\r\n\t\t\t\t\t\t<Scrollbar disableTracksWidthCompensation>\r\n\t\t\t\t\t\t\t<div className=\"row spc-12 f-vert\">\r\n\t\t\t\t\t\t\t\t{filtered.map(c=><Comment key={c.id} {...{commentId: c.id}}/>)}\r\n\t\t\t\t\t\t\t\t<div style={{height: '100vh'}}/>\r\n\t\t\t\t\t\t\t\t<div className=\"col-ext-x col-ext-t pos-sty top-controls f-order-m1 f-vert\">\r\n\t\t\t\t\t\t\t\t\t{sidebarMode!=='highlight'?<div className=\"row spc-12 f-vert\">\r\n\t\t\t\t\t\t\t\t\t\t{publicPrivateMode==='public'?<SegmentControls value={+userFilter}>\r\n\t\t\t\t\t\t\t\t\t\t\t<div className=\"super-center capitalize\" onClick={()=>setUserFilter(false)}>All {sidebarMode}s</div>\r\n\t\t\t\t\t\t\t\t\t\t\t<div className=\"super-center capitalize\" onClick={()=>setUserFilter(true)}>My {sidebarMode}s</div>\r\n\t\t\t\t\t\t\t\t\t\t</SegmentControls>:undefined}\r\n\t\t\t\t\t\t\t\t\t\t<input type=\"text\" placeholder=\" &#xf002;  filter by hashtag\" onChange={e=>setPublicSearchString(e.target.value)}/>\r\n\t\t\t\t\t\t\t\t\t</div>:undefined}\r\n\t\t\t\t\t\t\t\t\t<div className=\"mx-auto pill mt-8 mb-m6 px-10 py-2 h7\">{filtered.length} results</div>\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</Scrollbar>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t</section>\r\n\t\t\t<Header>\r\n\t\t\t\t<div className=\"icon icon-arrow_left f-order-m1 super-center\" onClick={history.goBack}/>\r\n\t\t\t\t<div className=\"col\"/>\r\n\t\t\t\t<SegmentControls className=\"mr-12\" value={publicPrivateMode==='public'?1:0} style={{width: '200px'}}>\r\n\t\t\t\t\t<div className=\"super-center capitalize\" onClick={()=>setSidebarMode('note')}>Private</div>\r\n\t\t\t\t\t<div className=\"super-center capitalize\" onClick={()=>setSidebarMode('comment')}>Public</div>\r\n\t\t\t\t</SegmentControls>\r\n\t\t\t\t<div className=\"col-ext row spc-x-8\" style={{maxWidth: 'var(--rightSidebarWidth)'}}>\r\n\t\t\t\t\t<div className=\"col text-right mr-12 one-line\">\r\n\t\t\t\t\t\t<h5 className=\"col-12 b-700 one-line\">{book?book.title:'PageBook Title'}</h5>\r\n\t\t\t\t\t\t<div className=\"h7 text-muted one-line\">Group: {group?group.title:'Group Title'}</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div className=\"icon icon-refresh super-center\" onClick={refresh}/>\r\n\t\t\t\t</div>\r\n\t\t\t</Header>\r\n\t\t\t<Route path=\"*/thread/:id\" component={CommentThread}/>\r\n\t\t</div>\r\n\t)\r\n})\r\n\r\nexport let setBubblePos\r\nexport const NewCommentBubble=withRouter(function({location: {pathname},publicPrivateMode,selection,book}){\r\n\tconst {state,dispatch}=useContext(MainContext)\r\n\tconst {userId}=state\r\n\tlet bubblePos\r\n\t;[bubblePos,setBubblePos]=useState({})\r\n\treturn(\r\n\t\t<div className=\"new-bubble pos-abs f-end f-justify-center h7 pt-4\" style={bubblePos}>\r\n\t\t\t{publicPrivateMode==='public'?<>\r\n\t\t\t\t<Link to={pathname+'/new-comment'} className=\"py-4 px-8 text-right\" onClick={()=>setSidebarMode('question')}>Question</Link>\r\n\t\t\t\t<Link to={pathname+'/new-comment'} className=\"py-4 px-8\" onClick={()=>setSidebarMode('comment')}>Comment</Link>\r\n\t\t\t</>:<>\r\n\t\t\t\t<Link to={pathname+'/new-comment'} className=\"py-4 px-8 text-right\" onClick={()=>setSidebarMode('note')}>Note</Link>\r\n\t\t\t\t<div className=\"py-4 px-8\" onClick={addHighlight}>Highlight</div> {/* eslint-disable-line jsx-a11y/anchor-is-valid */}\r\n\t\t\t</>}\r\n\t\t</div>\r\n\t)\r\n\r\n\tfunction addHighlight(){\r\n\t\tsetSidebarMode('highlight')\r\n\t\tapi('post','comment/',{\r\n\t\t\tbody: 'Highlight',\r\n\t\t\thashtag: '',\r\n\t\t\tselection_data: JSON.stringify([selection]),\r\n\t\t\tuser: userId,\r\n\t\t\tbook: book.id,\r\n\t\t\ttypeof: 'highlight',\r\n\t\t}).then(({data})=>{\r\n\t\t\tbook.comment_set=[...book.comment_set,data.id] // TODO: Maybe optimize?\r\n\t\t\tdispatch(['SET_DATA',{comments: [data],books: [{...book}]}]) // TODO: Maybe optimize?\r\n\t\t\tsetSelection(undefined)\r\n\t\t\tsetBubblePos({})\r\n\t\t})\r\n\t}\r\n})\r\n","import React from 'react'\r\nimport {withRouter} from 'react-router-dom'\r\n\r\nimport './NewQuestionComment.scss'\r\nimport MyComponent from '../MyComponent'\r\nimport {MainContext,nonAlphaNumericRegex,api} from '../../contexts/MainContext'\r\n\r\nconst initState=JSON.stringify({\r\n\tbody: '',\r\n\thashtag: '',\r\n})\r\nexport default withRouter(class NewQuestionComment extends MyComponent{\r\n\tstatic contextType=MainContext\r\n\tstate=JSON.parse(initState)\r\n\r\n\tonSubmit=e=>{\r\n\t\te.preventDefault()\r\n\r\n\t\tconst {sidebarMode,selection,book,history}=this.props\r\n\t\tconst {body,hashtag}=this.state\r\n\t\tconst {userId}=this.context.state\r\n\r\n\t\tapi('post','comment/',{\r\n\t\t\tbody,\r\n\t\t\thashtag: hashtag.replace(nonAlphaNumericRegex,'').trim(),\r\n\t\t\tselection_data: JSON.stringify([selection]),\r\n\t\t\tuser: userId,\r\n\t\t\tbook: book.id,\r\n\t\t\ttypeof: sidebarMode,\r\n\t\t}).then(({data})=>{\r\n\t\t\tbook.comment_set=[...book.comment_set,data.id] // TODO: Maybe optimize?\r\n\t\t\tthis.context.dispatch(['SET_DATA',{comments: [data],books: [{...book}]}]) // TODO: Maybe optimize?\r\n\t\t\t// TODO: resetSelection\r\n\t\t\thistory.goBack()\r\n\t\t})\r\n\t}\r\n\r\n\trender(){\r\n\t\tconst {onSubmit}=this\r\n\t\tconst {sidebarMode,history,selection}=this.props\r\n\t\tconsole.log(selection)\r\n\r\n\t\treturn (\r\n\t\t\t<div className=\"NewQuestionComment modal active pos-abs stretch-to-fit p-12 f-end f-justify-center\" style={{}}>\r\n\t\t\t\t<form className=\"row spc-12\" style={{width: '480px'}} {...{onSubmit}}>\r\n\t\t\t\t\t<div className=\"close-btn\" onClick={history.goBack}/>\r\n\t\t\t\t\t<div className=\"capitalize\">New {sidebarMode}</div>\r\n\t\t\t\t\t<blockquote className=\"col-12 h7 text-muted mt-2 row\">\r\n\t\t\t\t\t\t<div className=\"trim-y col\">{selection?.text}</div>\r\n\t\t\t\t\t</blockquote>\r\n\t\t\t\t\t<textarea required className=\"col-12\" placeholder={sidebarMode} {...this.twoWayBind('body')}/>\r\n\t\t\t\t\t<div className=\"col-12\"/>\r\n\t\t\t\t\t<div className=\"bottom-row col-12 col-ext row spc-12\">\r\n\t\t\t\t\t\t<input className=\"col\" type=\"text\" placeholder=\"#Hashtag\" {...this.twoWayBind('hashtag')}/>\r\n\t\t\t\t\t\t<button>Post</button>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</form>\r\n\t\t\t</div>\r\n\t\t)\r\n\t}\r\n})\r\n","import React from 'react'\r\nimport _ from 'lodash'\r\n\r\nimport './PageLogin.scss'\r\nimport SegmentControls from '../../utils/SegmentControls/SegmentControls'\r\nimport MyComponent from '../MyComponent'\r\nimport {MainContext,api} from '../../contexts/MainContext'\r\nimport Spinner from '../../utils/Spinner/Spinner'\r\nimport {setAlert} from '../../utils/Alert/Alert'\r\n\r\nconst initState=JSON.stringify({\r\n\tmode: 0,\r\n\tshowSpinner: false,\r\n})\r\nexport default class PageLogin extends MyComponent{\r\n\tstatic contextType=MainContext\r\n\tstate=JSON.parse(initState)\r\n\r\n\tlogin=async e=>{\r\n\t\te.preventDefault()\r\n\t\tthis.setState({showSpinner: true})\r\n\r\n\t\ttry{\r\n\t\t\tconst loginResponse=await api('post','login',_.pick(this.state,['email','password']))\r\n\t\t\tthis.context.dispatch(['LOGIN',loginResponse.data])\r\n\t\t}finally{this.setState({showSpinner: false})}\r\n\t}\r\n\r\n\tsignUp=async e=>{\r\n\t\te.preventDefault()\r\n\t\tthis.setState({showSpinner: true})\r\n\r\n\t\ttry{\r\n\t\t\tawait api('post','register',_.pick(this.state,['email']))\r\n\t\t\tthis.setState(JSON.parse(initState))\r\n\t\t\tsetAlert(<div className=\"row spc-12\" style={{maxWidth: '320px'}}>\r\n\t\t\t\t<div className=\"col-12 h5\">&#x2713; Email Sent</div>\r\n\t\t\t\t<div className=\"col-12 h7 text-muted\">\r\n\t\t\t\t\tWe just sent an email to <b className=\"text-unmuted\">{this.state.email}</b>.\r\n\t\t\t\t\tCheck your email to complete your sign-up!\r\n\t\t\t\t\t<br/><br/>\r\n\t\t\t\t\tIf you did not receive any emails from us, don't forget to check your spam folder!\r\n\t\t\t\t</div>\r\n\t\t\t\t<div className=\"bottom-row col-ext-x col-ext-b col-12 row spc-x-12 spc-y-8 f-justify-end\">\r\n\t\t\t\t\t<button onClick={()=>setAlert()}>OK</button>\r\n\t\t\t\t</div>\r\n\t\t\t</div>)\r\n\t\t}finally{this.setState({showSpinner: false})}\r\n\t}\r\n\r\n\trender(){\r\n\t\tconst {login,signUp}=this\r\n\t\tconst {location,history}=this.props\r\n\t\tconst {mode,showSpinner}=this.state\r\n\t\tconst {version}=this.context.state\r\n\r\n\t\tif(localStorage.getItem('activeUserId')) // If logged in, bypass login screen\r\n\t\t\thistory.replace(location.pathname.replace('/login',''))\r\n\r\n\t\treturn (\r\n\t\t\t<div id=\"PageLogin\" className=\"pos-abs stretch-to-fit\">\r\n\t\t\t\t<div className=\"container row p-32\">\r\n\t\t\t\t\t<div className=\"col\">\r\n\t\t\t\t\t\t<h1 className=\"heading py-32\">\r\n\t\t\t\t\t\t\tBBBook<sup className=\"h7 normal-caps ml-8\" style={{height: 'auto'}}>Pre-Alpha {version}</sup>\r\n\t\t\t\t\t\t</h1>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div className=\"card row spc-16 f-vert pos-rel\" style={{width: '360px'}}>\r\n\t\t\t\t\t\t<SegmentControls value={mode}>\r\n\t\t\t\t\t\t\t<div className=\"super-center\" onClick={()=>this.setState({mode: 0})}>Log In</div>\r\n\t\t\t\t\t\t\t<div className=\"super-center\" onClick={()=>this.setState({mode: 1})}>Sign up</div>\r\n\t\t\t\t\t\t</SegmentControls>\r\n\t\t\t\t\t\t{mode===0?\r\n\t\t\t\t\t\t\t<form className=\"row spc-16 f-vert col col-ext pos-rel trim\" onSubmit={login}>\r\n\t\t\t\t\t\t\t\t<div>\r\n\t\t\t\t\t\t\t\t\t<h1>Log In</h1>\r\n\t\t\t\t\t\t\t\t\t<div className=\"h7 text-muted\">Enter the BBBook portal.</div>\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t<div className=\"col\"/>\r\n\t\t\t\t\t\t\t\t<label required className=\"h7 my-0\">Email</label>\r\n\t\t\t\t\t\t\t\t<input required {...this.twoWayBind('email')} name=\"email\" type=\"email\"/>\r\n\t\t\t\t\t\t\t\t<label required className=\"h7 my-0\">Password</label>\r\n\t\t\t\t\t\t\t\t<input required {...this.twoWayBind('password')} name=\"password\" type=\"password\"/>\r\n\t\t\t\t\t\t\t\t{/*<Link className=\"button super-center\" to=\"/dashboard\">Log In</Link>*/}\r\n\t\t\t\t\t\t\t\t<div className=\"bottom-row col-ext-x col-ext-b text-right row f-vert spc-x-16 spc-y-12\">\r\n\t\t\t\t\t\t\t\t\t<button>Log In</button>\r\n\t\t\t\t\t\t\t\t\t<hr className=\"col-ext-x\"/>\r\n\t\t\t\t\t\t\t\t\t<div className=\"h7 text-right my-2\" onClick={()=>this.setState({mode: 1})}>New to BBBook? Sign up!</div>\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t</form>\r\n\t\t\t\t\t\t\t:<form className=\"row spc-16 f-vert col col-ext pos-rel trim\" onSubmit={signUp}>\r\n\t\t\t\t\t\t\t\t<div>\r\n\t\t\t\t\t\t\t\t\t<h1>Sign Up</h1>\r\n\t\t\t\t\t\t\t\t\t<div className=\"h7 text-muted\">Enter the BBBook portal.</div>\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t<div className=\"col\"/>\r\n\t\t\t\t\t\t\t\t<label required className=\"h7 my-0\">Email</label>\r\n\t\t\t\t\t\t\t\t<input required {...this.twoWayBind('email')} name=\"email\" type=\"email\"/>\r\n\t\t\t\t\t\t\t\t{/*<Link className=\"button super-center\" to=\"/dashboard\">Sign Up</Link>*/}\r\n\t\t\t\t\t\t\t\t<div className=\"bottom-row col-ext-x col-ext-b text-right row f-vert spc-x-16 spc-y-12\">\r\n\t\t\t\t\t\t\t\t\t<button>Sign Up</button>\r\n\t\t\t\t\t\t\t\t\t<hr className=\"col-ext-x\"/>\r\n\t\t\t\t\t\t\t\t\t<div className=\"h7 text-right my-2\" onClick={()=>this.setState({mode: 0})}>Have an account? PageLogin in!</div>\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t</form>\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t\t<Spinner {...{className: showSpinner?'active':''}}/>\r\n\t\t\t</div>\r\n\t\t)\r\n\t}\r\n}\r\n","import React,{useContext,useEffect} from 'react'\r\nimport {Link,withRouter} from 'react-router-dom'\r\nimport {Scrollbar} from 'react-scrollbars-custom'\r\n\r\nimport './PageGroups.scss'\r\nimport Header from '../Header/Header'\r\nimport {MainContext,api} from '../../contexts/MainContext'\r\nimport Group from '../Group/Group'\r\n\r\nexport default withRouter(function PageGroups({location}){\r\n\tconst {state,dispatch}=useContext(MainContext)\r\n\tuseEffect(refresh,[location.pathname])\r\n\tconst user=state.USERS[state.userId]\r\n\r\n\tfunction refresh(){\r\n\t\tif(!state.userId) return\r\n\t\tapi('get','dashboard/'+state.userId).then(({data})=>{\r\n\t\t\tdispatch(['SET_DATA',data])\r\n\t\t}).catch(console.error)\r\n\t}\r\n\r\n\treturn (\r\n\t\t<div id=\"PageGroups\">\r\n\t\t\t<Scrollbar className=\"pos-abs stretch-to-fit\">\r\n\t\t\t\t<div className=\"f-vert\">\r\n\t\t\t\t\t<div className=\"container\">\r\n\t\t\t\t\t\t{(user?.joined_groups || []).map(groupId=>{\r\n\t\t\t\t\t\t\tconst group=state.GROUPS[groupId]\r\n\t\t\t\t\t\t\treturn group?(\r\n\t\t\t\t\t\t\t\t<Group {...{key:groupId,group}}/>\r\n\t\t\t\t\t\t\t):undefined\r\n\t\t\t\t\t\t})}\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<Header>\r\n\t\t\t\t\t\t<div className=\"col\"/>\r\n\t\t\t\t\t\t<div className=\"icon icon-refresh super-center\" onClick={refresh}/>\r\n\t\t\t\t\t</Header>\r\n\t\t\t\t</div>\r\n\t\t\t</Scrollbar>\r\n\t\t\t<Link className=\"button f-center f-horz-rev pos-abs create-group-btn p-0\" to={location.pathname+'/edit-group/0'}>\r\n\t\t\t\t<i className=\"fa fa-plus super-center h5\"/>\r\n\t\t\t\t<div className=\"super-center pl-24 pr-12 one-line\">Create Group</div>\r\n\t\t\t</Link>\r\n\t\t</div>\r\n\t)\r\n})\r\n","import React,{createRef} from 'react'\r\n// import _ from 'lodash'\r\nimport {Scrollbar} from 'react-scrollbars-custom'\r\n\r\nimport './PageRegister.scss'\r\nimport MyComponent from '../MyComponent'\r\nimport {MainContext,/*api*/} from '../../contexts/MainContext'\r\nimport Spinner from '../../utils/Spinner/Spinner'\r\n// import {setAlert} from '../../utils/Alert/Alert'\r\n\r\nconst initState=JSON.stringify({\r\n\tshowSpinner: false,\r\n})\r\nexport default class PageRegister extends MyComponent{\r\n\tstatic contextType=MainContext\r\n\tstate=JSON.parse(initState)\r\n\r\n\tconstructor(props){\r\n\t\tsuper(props)\r\n\t\tthis.ref=createRef()\r\n\t}\r\n\r\n\tcomponentDidMount=()=>{\r\n\t\tconst refEle=this.ref.current.holderElement\r\n\t\tconsole.log(refEle.querySelector('form').style.minHeight=refEle.offsetHeight+'px')\r\n\t}\r\n\r\n\t// TODO: Regex\r\n\trender(){\r\n\t\tconst {ref}=this\r\n\t\tconst {showSpinner,email}=this.state\r\n\t\tconst {version}=this.context.state\r\n\t\treturn (\r\n\t\t\t<div id=\"PageRegister\" className=\"pos-abs stretch-to-fit\">\r\n\t\t\t\t<div className=\"container row p-32\">\r\n\t\t\t\t\t<div className=\"col\">\r\n\t\t\t\t\t\t<h1 className=\"heading py-32\">\r\n\t\t\t\t\t\t\tBBBook<sup className=\"h7 normal-caps ml-8\" style={{height: 'auto'}}>Pre-Alpha {version}</sup>\r\n\t\t\t\t\t\t</h1>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<Scrollbar className=\"card\" style={{width: '360px'}} {...{ref}}>\r\n\t\t\t\t\t\t<form className=\"row spc-16 f-vert col col-ext pos-rel trim\">\r\n\t\t\t\t\t\t\t<div>\r\n\t\t\t\t\t\t\t\t<h1>Sign Up</h1>\r\n\t\t\t\t\t\t\t\t<div className=\"h7 text-muted\">Complete your details.</div>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t<div className=\"col\"/>\r\n\t\t\t\t\t\t\t<label className=\"h7 my-0\">Email</label>\r\n\t\t\t\t\t\t\t<input required readOnly name=\"email\" type=\"email\" value={email}/>\r\n\t\t\t\t\t\t\t<label required className=\"h7 my-0\">Username</label>\r\n\t\t\t\t\t\t\t<input required {...this.twoWayBind('username')} name=\"username\" type=\"text\"/>\r\n\t\t\t\t\t\t\t<label required className=\"h7 my-0\">First Name</label>\r\n\t\t\t\t\t\t\t<input required {...this.twoWayBind('first_name')} name=\"first_name\" type=\"text\"/>\r\n\t\t\t\t\t\t\t<label required className=\"h7 my-0\">Last Name</label>\r\n\t\t\t\t\t\t\t<input required {...this.twoWayBind('last_name')} name=\"last_name\" type=\"text\"/>\r\n\t\t\t\t\t\t\t<label required className=\"h7 my-0\">Password</label>\r\n\t\t\t\t\t\t\t<input required {...this.twoWayBind('password')} name=\"password\" type=\"password\"/>\r\n\t\t\t\t\t\t\t<label required className=\"h7 my-0\">Confirm Password</label>\r\n\t\t\t\t\t\t\t<input required {...this.twoWayBind('password_2')} name=\"password_2\" type=\"password\"/>\r\n\t\t\t\t\t\t\t<label required className=\"h7 my-0\">Date of Birth</label>\r\n\t\t\t\t\t\t\t<input required {...this.twoWayBind('birth_date')} name=\"birth_date\" type=\"date\"/>\r\n\t\t\t\t\t\t\t<label className=\"h7 my-0\">Bio</label>\r\n\t\t\t\t\t\t\t<textarea {...this.twoWayBind('bio')} name=\"bio\"/>\r\n\t\t\t\t\t\t\t{/* TODO: Avatar\t*/}\r\n\t\t\t\t\t\t\t<div className=\"bottom-row col-ext-x col-ext-b text-right row f-vert spc-x-16 spc-y-12\">\r\n\t\t\t\t\t\t\t\t<button>Complete</button>\r\n\t\t\t\t\t\t\t\t{/*<hr className=\"col-ext-x\"/>\r\n\t\t\t\t\t\t\t\t<div className=\"h7 text-right my-2\" onClick={()=>this.setState({mode: 1})}>New to BBBook? Sign up!</div>*/}\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</form>\r\n\t\t\t\t\t</Scrollbar>\r\n\t\t\t\t</div>\r\n\t\t\t\t<Spinner {...{className: showSpinner?'active':''}}/>\r\n\t\t\t</div>\r\n\t\t)\r\n\t}\r\n}\r\n","import React from 'react'\r\nimport {Link} from 'react-router-dom'\r\nimport _ from 'lodash'\r\nimport {Scrollbar} from 'react-scrollbars-custom'\r\n\r\nimport './ModalEditGroup.scss'\r\nimport MyComponent from '../MyComponent'\r\nimport SegmentControls from '../../utils/SegmentControls/SegmentControls'\r\nimport {MainContext,api} from '../../contexts/MainContext'\r\nimport Spinner from '../../utils/Spinner/Spinner'\r\n\r\n// TODO: Admin revoked - alert\r\n// TODO: ManageUsers Component\r\nexport default class ModalEditGroup extends MyComponent{\r\n\tstatic contextType=MainContext\r\n\t// TODO: Take it outside state\r\n\tstate={\r\n\t\tpublicPrivate: 1,\r\n\t\tlinkSharing: 1,\r\n\t\tshowSpinner: false,\r\n\t}\r\n\tadmins={}\r\n\r\n\trender(){\r\n\t\tconst {onSubmit,admins}=this\r\n\t\tconst {location,history}=this.props\r\n\t\tconst {publicPrivate,linkSharing,showSpinner}=this.state\r\n\t\tconst {id}=this.props.match.params\r\n\t\tconst {userId,GROUPS,USERS}=this.context.state\r\n\t\tconst group=GROUPS[id]\r\n\r\n\t\tif(!userId) return null\r\n\t\tif(id!=='0'){\r\n\t\t\tif(!group) return null\r\n\t\t\tif(this.state.id!==id) this.groupTypeToState(group)\r\n\t\t}\r\n\r\n\t\tconst manageUsersMode=location.pathname.indexOf('/edit-group-users')!==-1\r\n\t\treturn (\r\n\t\t\t<div id=\"ModalEditGroup\" className=\"modal active\">\r\n\t\t\t\t<form className={manageUsersMode?'expanded':''} {...{onSubmit}}>\r\n\t\t\t\t\t<div className=\"row spc-12\">\r\n\t\t\t\t\t\t<h3 className=\"col\">{id==='0'?'New':'Edit'} Group</h3>\r\n\t\t\t\t\t\t{/* TODO: Show group details in manageUsersMode */}\r\n\t\t\t\t\t\t{/*<div><button className=\"outline\" style={{width: '68px',height: '68px',marginBottom: '-45px'}}/></div>*/}\r\n\t\t\t\t\t\t<hr className=\"col-12 col-ext-x col-ext-b\"/>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t{!manageUsersMode?\r\n\t\t\t\t\t\t<div className=\"row spc-12\">\r\n\t\t\t\t\t\t\t<div className=\"col\">\r\n\t\t\t\t\t\t\t\t<label required className=\"h7 mb-4\">Group Name</label>\r\n\t\t\t\t\t\t\t\t<input required className=\"col-12\" type=\"text\" {...this.twoWayBind('title')}/>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t<div className=\"col-12\">\r\n\t\t\t\t\t\t\t\t<label className=\"h7 mb-4\">Group Description</label>\r\n\t\t\t\t\t\t\t\t<textarea className=\"col-12\" {...this.twoWayBind('bio')}/>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t<div className=\"col-6\">\r\n\t\t\t\t\t\t\t\t<label className=\"h7 mb-4\">Group Privacy</label>\r\n\t\t\t\t\t\t\t\t<SegmentControls value={publicPrivate}>\r\n\t\t\t\t\t\t\t\t\t<div className=\"super-center\" onClick={()=>this.setState({publicPrivate: 0,linkSharing: 0})}>Public</div>\r\n\t\t\t\t\t\t\t\t\t<div className=\"super-center\" onClick={()=>this.setState({publicPrivate: 1})}>Private</div>\r\n\t\t\t\t\t\t\t\t</SegmentControls>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t<div className=\"col-6\">\r\n\t\t\t\t\t\t\t\t<label className=\"h7 mb-4\" disabled={publicPrivate===0}>Invite via Link</label>\r\n\t\t\t\t\t\t\t\t<SegmentControls value={linkSharing} disabled={publicPrivate===0}>\r\n\t\t\t\t\t\t\t\t\t<div className=\"super-center\" onClick={()=>this.setState({linkSharing: 0})}>Enabled</div>\r\n\t\t\t\t\t\t\t\t\t<div className=\"super-center\" onClick={()=>this.setState({linkSharing: 1})}>Disabled</div>\r\n\t\t\t\t\t\t\t\t</SegmentControls>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t{/* TODO: Green accent for link sharing enabled */}\r\n\t\t\t\t\t\t\t{id!=='0'?<div className=\"col-12 f-vert\">\r\n\t\t\t\t\t\t\t\t<label className=\"h7 mb-4\">Link</label>\r\n\t\t\t\t\t\t\t\t<Link\r\n\t\t\t\t\t\t\t\t\tto={'/groups/group/'+id}\r\n\t\t\t\t\t\t\t\t\ttarget=\"_blank\"\r\n\t\t\t\t\t\t\t\t\tclassName=\"col-12 button outline d-block one-line\"\r\n\t\t\t\t\t\t\t\t\ttype=\"text\" {...this.twoWayBind('title')}>\r\n\t\t\t\t\t\t\t\t\t{window.location.origin+'/#/groups/group/'+id}\r\n\t\t\t\t\t\t\t\t</Link>\r\n\t\t\t\t\t\t\t\t<div className=\"button ml-auto h7 mt-6\" style={{height: 'auto'}}>Copy Link</div>\r\n\t\t\t\t\t\t\t</div>:undefined}\r\n\t\t\t\t\t\t</div>:\r\n\t\t\t\t\t\t<Scrollbar style={{height: 'calc(100% - 114px)'}}>\r\n\t\t\t\t\t\t\t<div className=\"row spc-12 container\">\r\n\t\t\t\t\t\t\t\t<div className=\"col-12 row f-center\">\r\n\t\t\t\t\t\t\t\t\tAdmins <hr className=\"col ml-16\"/>\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t<div className=\"col-12 row f-center f-order-1\">\r\n\t\t\t\t\t\t\t\t\tUsers <hr className=\"col ml-16\"/>\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t{group.users.map(u=>{\r\n\t\t\t\t\t\t\t\t\tconst user=USERS[u]\r\n\t\t\t\t\t\t\t\t\treturn user?<div key={u} className={'card col-3 row spc-12 f-center'+(admins[u]?'':' f-order-1')}>\r\n\t\t\t\t\t\t\t\t\t\t<img\r\n\t\t\t\t\t\t\t\t\t\t\tclassName=\"card col-ext-y col-ext-l\"\r\n\t\t\t\t\t\t\t\t\t\t\tsrc={require('../../assets/imgs/default-profile-icon.jpg')}\r\n\t\t\t\t\t\t\t\t\t\t\tstyle={{width: '61px',height: '61px',borderRadius: '8px 0 0 8px'}}\r\n\t\t\t\t\t\t\t\t\t\t\talt=\"user profile pic\"/>\r\n\t\t\t\t\t\t\t\t\t\t<div className=\"col one-line\">\r\n\t\t\t\t\t\t\t\t\t\t\t{user.first_name || 'First Name'} {user.last_name || 'Last Name'}\r\n\t\t\t\t\t\t\t\t\t\t\t<div className=\"h7 text-muted mt-2\">@{user.username} | {user.email}</div>\r\n\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t</div>:undefined\r\n\t\t\t\t\t\t\t\t})}\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</Scrollbar>\r\n\t\t\t\t\t}\r\n\t\t\t\t\t<div className=\"bottom-row col-12 col-ext row spc-12\">\r\n\t\t\t\t\t\t{(id!=='0' && !manageUsersMode)?<>\r\n\t\t\t\t\t\t\t<Link\r\n\t\t\t\t\t\t\t\tto={location.pathname+'/edit-group-users'}\r\n\t\t\t\t\t\t\t\tclassName=\"button super-center\">Manage Users</Link>\r\n\t\t\t\t\t\t\t<div className=\"f-self-center h7\">\r\n\t\t\t\t\t\t\t\t<i className=\"icon icon-users\"/> {group?.users.length}\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</>:undefined}\r\n\t\t\t\t\t\t<div className=\"col\"/>\r\n\t\t\t\t\t\t<div className=\"button outline super-center\" onClick={history.goBack}>Cancel</div>\r\n\t\t\t\t\t\t<button>{id==='0'?'Create Group':'Save'}</button>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<Spinner className={showSpinner?'active':''}/>\r\n\t\t\t\t\t<div className=\"close-btn\" onClick={history.goBack}/>\r\n\t\t\t\t</form>\r\n\t\t\t</div>\r\n\t\t)\r\n\t}\r\n\r\n\t// TODO: Avatar\r\n\t// TODO: Replace _.pick\r\n\tonSubmit=async e=>{\r\n\t\te.preventDefault()\r\n\t\tconst {id}=this.props.match.params\r\n\t\tconst {state}=this.context\r\n\t\tconst {userId}=state\r\n\t\tlet group={\r\n\t\t\t..._.omit(this.state,['publicPrivate','linkSharing','showSpinner']),\r\n\t\t\tgroup_type: this.stateToGroupType(),\r\n\t\t}\r\n\r\n\t\tthis.setState({showSpinner: true})\r\n\t\ttry{\r\n\t\t\tif(id==='0'){\r\n\t\t\t\tgroup={\r\n\t\t\t\t\t...group,\r\n\t\t\t\t\tusers: [userId],\r\n\t\t\t\t\tadmins: [userId],\r\n\t\t\t\t\tbooks: [],\r\n\t\t\t\t}\r\n\t\t\t\t/*const g=*/await api('post','group/',group)\r\n\t\t\t\t// TODO: Backend /group-full\r\n\t\t\t\tthis.props.history.goBack() // TODO: Remove\r\n\t\t\t}else{\r\n\t\t\t\t/*const g=*/await api('put','group/',group)\r\n\t\t\t\t// TODO: Backend /group-full\r\n\t\t\t}\r\n\t\t}finally{\r\n\t\t\tthis.setState({showSpinner: false})\r\n\t\t}\r\n\t}\r\n\r\n\t// Group types\r\n\t// - public       -     searchable,    link-admit\r\n\t// - private      - non-searchable, no link-admit\r\n\t// - private-link - non-searchable,    link-admit\r\n\r\n\tgroupTypeToState=group=>{\r\n\t\tthis.admins={}\r\n\t\tgroup.admins.forEach(a=>this.admins[a]=true)\r\n\t\tthis.setState({\r\n\t\t\t..._.cloneDeep(group),\r\n\t\t\tpublicPrivate: group.group_type==='public'?0:1,\r\n\t\t\tlinkSharing: group.group_type!=='private'?0:1,\r\n\t\t})\r\n\t}\r\n\r\n\tstateToGroupType=()=>{\r\n\t\tconst {publicPrivate,linkSharing}=this.state\r\n\t\tif(publicPrivate===0) return 'public'\r\n\t\telse if(linkSharing===0) return 'private-link'\r\n\t\telse return 'private'\r\n\t}\r\n}\r\n","import React from 'react'\nimport {Route,Switch,withRouter} from 'react-router-dom'\n\nimport './App.scss'\nimport {dispatch} from '../../contexts/MainContext'\nimport Sidemenu from '../Sidemenu/Sidemenu'\nimport Dashboard from '../PageDashboard/PageDashboard'\nimport Book from '../PageBook/PageBook'\nimport PageLogin from '../PageLogin/PageLogin'\nimport Alert from '../../utils/Alert/Alert'\nimport Groups from '../PageGroups/PageGroups'\nimport PageRegister from '../PageRegister/PageRegister'\nimport ModalEditGroup from '../ModalEditGroup/ModalEditGroup'\nimport PageGroup from '../PageGroup/PageGroup'\n\nexport let forceUpdateApp\nexport default withRouter(function App({location,history}){\n\tconst [,updateState]=React.useState()\n\tforceUpdateApp=()=>updateState({})\n\n\tif(location.pathname==='/')\n\t\thistory.replace('/dashboard')\n\tif(!localStorage.getItem('activeUserId') && location.pathname.indexOf('/login')===-1) // Routes containing /login can appear without token present\n\t\thistory.replace(location.pathname+'/login')\n\n\t// console.log('App Render')\n\treturn (\n\t\t<div id=\"App\">\n\t\t\t<Sidemenu/>\n\t\t\t<div id=\"main-content\" className=\"pos-abs stretch-to-fit\">\n\t\t\t\t<Switch>\n\t\t\t\t\t{/* Level 2 */}\n\n\t\t\t\t\t{/* Level 1 */}\n\t\t\t\t\t<Route path=\"*/group/:id\" component={PageGroup}/>\n\n\t\t\t\t\t{/* Level 0 */}\n\t\t\t\t\t<Route path=\"/dashboard\" component={Dashboard}/>\n\t\t\t\t\t<Route path=\"/groups\" component={Groups}/>\n\t\t\t\t</Switch>\n\t\t\t\t<Route path=\"*/edit-group/:id\" component={ModalEditGroup}/>\n\t\t\t</div>\n\t\t\t<Route path=\"*/book/:id\" component={Book}/>\n\n\t\t\t{/* Routes containing /login can appear without token present */}\n\t\t\t<Route path=\"*/login\" component={PageLogin}/>\n\t\t\t<Route path=\"*/login-register:id\" component={PageRegister}/>\n\n\t\t\t{/* Activated when Sidemenu active to prevent clicks over main-content */}\n\t\t\t<div\n\t\t\t\tid=\"shield\"\n\t\t\t\tclassName=\"hide pos-abs stretch-to-fit\"\n\t\t\t\tonClick={()=>dispatch(['SET_UI_SIDEMENU',false])}\n\t\t\t/>\n\t\t\t<Alert/>\n\t\t</div>\n\t)\n})\n","import React,{useContext,useEffect,useState} from 'react'\r\nimport {withRouter} from 'react-router-dom'\r\nimport {Scrollbar} from 'react-scrollbars-custom'\r\n\r\nimport './PageGroup.scss'\r\nimport Header from '../Header/Header'\r\nimport {MainContext,api} from '../../contexts/MainContext'\r\nimport Group from '../Group/Group'\r\n\r\nexport default withRouter(function PageGroup({location,history,match}){\r\n\tconst {state,dispatch}=useContext(MainContext)\r\n\tuseEffect(refresh,[location.pathname])\r\n\tconst [showJoinDialog,setShowJoinDialog]=useState(true)\r\n\tconst groupId=match.params.id\r\n\tconst group=state.GROUPS[groupId]\r\n\tconst user=state.USERS[state.userId]\r\n\r\n\tconsole.log(history)\r\n\r\n\tfunction back(){\r\n\t\thistory.length>1?\r\n\t\t\thistory.goBack():\r\n\t\t\thistory.replace('/groups')\r\n\t}\r\n\r\n\tfunction refresh(){\r\n\t\tif(!state.userId) return\r\n\t\tapi('get','group-full/'+match.params.id).then(({data})=>{\r\n\t\t\tdispatch(['SET_DATA',data])\r\n\t\t}).catch(console.error)\r\n\t}\r\n\r\n\treturn (\r\n\t\t<div id=\"PageGroup\">\r\n\t\t\t<Scrollbar id=\"PageGroup\" className=\"pos-abs stretch-to-fit\">\r\n\t\t\t\t<div className=\"f-vert\">\r\n\t\t\t\t\t<div className=\"container\">\r\n\t\t\t\t\t\t{group?<Group {...{key:groupId,group}}/>:undefined}\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<Header>\r\n\t\t\t\t\t\t<div className=\"icon icon-arrow_left f-order-m1 super-center\" onClick={back}/>\r\n\t\t\t\t\t\t<div className=\"col\"/>\r\n\t\t\t\t\t\t<div className=\"icon icon-refresh super-center\" onClick={refresh}/>\r\n\t\t\t\t\t</Header>\r\n\t\t\t\t</div>\r\n\t\t\t</Scrollbar>\r\n\t\t\t{(showJoinDialog && user.joined_groups.indexOf(groupId)===-1)?<div className=\"container p-12 pos-abs join-group stretch-to-fit\">\r\n\t\t\t\t<div className=\"card row spc-12 f-center\">\r\n\t\t\t\t\t<div>Do you want to join this group?</div>\r\n\t\t\t\t\t<div className=\"col\"/>\r\n\t\t\t\t\t<button className=\"outline\" style={{width: '60px'}} onClick={()=>setShowJoinDialog(false)}>No</button>\r\n\t\t\t\t\t<button style={{width: '60px'}}>Yes</button>\r\n\t\t\t\t</div>\r\n\t\t\t</div>:undefined}\r\n\t\t</div>\r\n\t)\r\n})\r\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' },\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready\n      .then(registration => {\n        registration.unregister();\n      })\n      .catch(error => {\n        console.error(error.message);\n      });\n  }\n}\n","import React from 'react'\nimport ReactDOM from 'react-dom'\nimport {HashRouter} from 'react-router-dom'\n\nimport './index.scss'\nimport App from './components/App/App'\nimport * as serviceWorker from './serviceWorker'\nimport MainContextProvider from './contexts/MainContext'\n\nReactDOM.render(\n\t<HashRouter>\n\t\t<MainContextProvider>\n\t\t\t{/*<React.StrictMode>*/}\n\t\t\t\t<App/>\n\t\t\t{/*</React.StrictMode>*/}\n\t\t</MainContextProvider>\n\t</HashRouter>,\n\tdocument.getElementById('root')\n)\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.register()\n","module.exports = __webpack_public_path__ + \"static/media/tab-start.7684764d.svg\";","module.exports = \"data:image/jpeg;base64,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\"","module.exports = __webpack_public_path__ + \"static/media/letter.74d7f973.png\";"],"sourceRoot":""}