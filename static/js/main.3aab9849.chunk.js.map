{"version":3,"sources":["assets/imgs/spinner.gif","utils/Alert/Alert.js","reducers/mainReducer.js","contexts/MainContext.js","utils/SegmentControls/SegmentControls.js","components/Sidemenu/Sidemenu.js","components/Header/Header.js","components/Group/Group.js","components/PageDashboard/PageDashboard.js","components/Comment/Comment.js","components/MyComponent.js","components/CommentThread/CommentThread.js","helper.js","utils/Spinner/Spinner.js","utils/PDFRenderer/PDFRenderer.js","components/PageBook/PageBook.js","components/PdfVerticalScroll/PdfVerticalScroll.js","components/NewQuestionComment/NewQuestionComment.js","components/PageLogin/PageLogin.js","components/PageGroups/PageGroups.js","components/PageRegister/PageRegister.js","components/ModalEditGroup/ModalEditGroup.js","components/App/App.js","components/PageGroup/PageGroup.js","serviceWorker.js","index.js","assets/imgs/tab-start.svg","assets/imgs/default-profile-icon.jpg","assets/imgs/letter.png"],"names":["module","exports","setAlert","modes","mode","url","initState","JSON","stringify","access_token","refresh_token","userId","USERS","GROUPS","BOOKS","COMMENTS","UI_SIDEMENU","UI_DARKMODE","version","state","parse","mainReducer","oldState","actionType","data","reducer","loggedInUsers","cache","reduce","users","groups","books","comments","localStorage","setItem","user","id","getItem","login","removeItem","forceUpdateApp","window","lib","forEach","d","withRouter","alert","useState","className","style","minWidth","maxWidth","maxHeight","onClick","undefined","axios","dispatch","MainContext","createContext","nonAlphaNumericRegex","children","location","history","useReducer","mounted","setMounted","Provider","value","api","method","onError","a","e","console","log","response","width","Object","keys","map","key","_","capitalize","post","token","status","refresh","r","access","Error","options","headers","Authorization","SegmentControls","vertical","props","val","Number","isInteger","sizeAttr","transform","length","c","i","urlToValue","dashboard","useContext","src","require","alt","username","pathname","split","to","cursor","push","Header","height","group","isAdmin","admins","indexOf","title","bio","bookId","b","thumbnail","detail","useEffect","then","catch","error","disableTracksWidthCompensation","joined_groups","groupId","whitespaceRegex","Comment","commentBody","commentId","showChildren","editMode","setEditMode","comment","selection","selection_data","s","document","querySelector","scrollIntoView","behavior","text","Date","created_at","toLocaleString","replys","body","hidden","hashtag","h","MyComponent","twoWayBind","property","event","valAttr","setState","target","PureComponent","onSubmit","preventDefault","match","params","context","replace","trim","book","replyto","typeof","comment_set","this","goBack","required","cols","rows","placeholder","type","contextType","getChildNodeIndex","element","Array","from","parentNode","getSelectionOffsetFromParent","node","parent","offset","warn","previousSibling","innerText","binarySearchFindClosestIndex","sortedArray","ele","getClosestIndex","i1","i2","n","low","high","mid","Spinner","pdfjs","workerSrc","setSidebarMode","setSelection","setBubblePos","PdfImage","memo","page","viewport","setData","canvas","createElement","canvasContext","getContext","render","promise","toDataURL","renderTextLayer","getTextContent","textContent","container","textDivs","tagOpen","tagClose","TextLayer","pageComments","__html","setHtml","textDiv","lineData","p","startLine","startOffset","start","endLine","endOffset","openStack","lineEle","lineNum","l","substrings","sort","escape","substring","join","splice","findIndex","pop","innerHTML","dangerouslySetInnerHTML","PdfVerticalScroll","onScroll","setOnScroll","publicPrivateMode","pdf","pageWiseComments","NewCommentBubble","destroy","PdfVerticalScrollInner","pageTops","pageBottoms","loaders","topOffset","scrollTop","clientHeight","bottomOffset","lastPageNum","topPage","Math","max","bottomPage","min","prevTopPage","prevBottomPage","getSelection","toString","anchorNode","focusNode","closest","anchorNodeSpan","focusNodeSpan","startPage","dataset","pageIndex","anchorOffset","endPage","focusOffset","pagesDOM","ref","current","slice","focusNodeClientRect","getBoundingClientRect","scrollNode","top","createRef","pages","viewports","_pageIndex","pick","data-page-index","onPdfLoad","prevProps","pageEles","offsetTop","offsetHeight","scrollTo","Page","loaded","setLoaded","sidebarMode","publicPrivateModes","userFilter","setUserFilter","publicSearchString","setPublicSearchString","setPdf","componentDidMount","group_id","categorizedInitState","categorized","setCategorized","setPageWiseComments","allComments","pageNum","filtered","filter","docfile","pdfLoadTask","getDocument","onProgress","total","promises","numPages","getPage","Promise","all","generateViewports","scale","getViewport","path","tabStart","onChange","component","CommentThread","bubblePos","showSpinner","PageLogin","loginResponse","signUp","email","name","PageRegister","refEle","holderElement","minHeight","readOnly","ModalEditGroup","publicPrivate","linkSharing","omit","group_type","stateToGroupType","groupTypeToState","cloneDeep","manageUsersMode","u","borderRadius","first_name","last_name","disabled","origin","showJoinDialog","setShowJoinDialog","React","updateState","PageGroup","Dashboard","Groups","Book","isLocalhost","Boolean","hostname","registerValidSW","swUrl","config","navigator","serviceWorker","register","registration","onupdatefound","installingWorker","installing","onstatechange","controller","onUpdate","onSuccess","ReactDOM","getElementById","URL","process","href","addEventListener","fetch","contentType","get","ready","unregister","reload","checkValidServiceWorker"],"mappings":"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","file":"static/js/main.3aab9849.chunk.js","sourcesContent":["module.exports = __webpack_public_path__ + \"static/media/spinner.3d035a55.gif\";","import React,{useState} from 'react'\r\nimport {withRouter} from 'react-router-dom'\r\n\r\nexport let setAlert\r\n\r\n// TODO: Maybe easier alert, prompt, confirm\r\n// TODO: UseEffect scrollbar fix\r\nexport default withRouter(function Alert(){\r\n\tlet alert\r\n\t[alert,setAlert]=useState()\r\n\treturn (\r\n\t\t<div id=\"Alert\" className={'modal'+(alert?' active':' ')}>\r\n\t\t\t{alert?<div style={{minWidth: 320,maxWidth: 'calc(100% - 24px)',maxHeight: 'calc(100% - 24px)'}}>\r\n\t\t\t\t<div className=\"close-btn\" onClick={()=>setAlert()}/>\r\n\t\t\t\t{alert}\r\n\t\t\t</div>:undefined}\r\n\t\t</div>\r\n\t)\r\n})","// import _ from 'lodash'\r\n\r\nimport {forceUpdateApp} from '../components/App/App'\r\n\r\nconst mode=0\r\nconst modes=[\r\n\t{\r\n\t\tmode: 'dev',\r\n\t\turl: 'https://bbapi-testing.herokuapp.com/bbapi/',\r\n\t},\r\n\t{\r\n\t\tmode: 'prod',\r\n\t\turl: 'https://test-for-bbbook.herokuapp.com/bbapi/',\r\n\t},\r\n]\r\nexport const initState=JSON.stringify({\r\n\taccess_token: null,\r\n\trefresh_token: null,\r\n\tuserId: null,\r\n\r\n\tUSERS:    {},\r\n\tGROUPS:   {},\r\n\tBOOKS:    {},\r\n\tCOMMENTS: {},\r\n\r\n\tUI_SIDEMENU: false,\r\n\tUI_DARKMODE: 'auto', // 'auto',true,false\r\n\r\n\tversion: '0.0.13 '+modes[mode].mode,\r\n\t...modes[mode]\r\n})\r\nexport let state=JSON.parse(initState)\r\n\r\nexport default function mainReducer(oldState,[actionType,data]){\r\n\tstate={...state,...reducer(oldState,actionType,data)}\r\n\tif(mode===0) window.state=state\r\n\treturn state\r\n}\r\n\r\nfunction reducer(state,actionType,data){\r\n\tlet userId,loggedInUsers\r\n\tswitch(actionType){\r\n\t\tcase 'SET_STATE': return data\r\n\t\tcase 'SET_UI_SIDEMENU': return {UI_SIDEMENU: data}\r\n\t\tcase 'SET_UI_DARKMODE': return {UI_DARKMODE: data}\r\n\t\tcase 'SET_DATA':\r\n\t\t\tconst cache={\r\n\t\t\t\tUSERS   : {...state.USERS   ,...(reduce(data.users    ?? []))}, // eslint-disable-line no-whitespace-before-property\r\n\t\t\t\tGROUPS  : {...state.GROUPS  ,...(reduce(data.groups   ?? []))}, // eslint-disable-line no-whitespace-before-property\r\n\t\t\t\tBOOKS   : {...state.BOOKS   ,...(reduce(data.books    ?? []))}, // eslint-disable-line no-whitespace-before-property\r\n\t\t\t\tCOMMENTS: {...state.COMMENTS,...(reduce(data.comments ?? []))}, // eslint-disable-line no-whitespace-before-property\r\n\t\t\t}\r\n\t\t\tlocalStorage.setItem('cache',JSON.stringify(cache)) // TODO: Cache size limiting, preserve logged in users\r\n\t\t\treturn cache\r\n\t\tcase 'LOGIN':\r\n\t\t\tconst {access_token,refresh_token}=data\r\n\t\t\tuserId=data.user.id\r\n\t\t\tlocalStorage.setItem('activeUserId',userId)\r\n\t\t\tlocalStorage.setItem('loggedInUsers',JSON.stringify({\r\n\t\t\t\t...JSON.parse(localStorage.getItem('loggedInUsers') || '{}'),\r\n\t\t\t\t[userId]: [access_token,refresh_token]\r\n\t\t\t}))\r\n\t\t\treturn {\r\n\t\t\t\taccess_token,\r\n\t\t\t\trefresh_token,\r\n\t\t\t\tuserId,\r\n\t\t\t\t...reducer(state,'SET_DATA',{users: [data.user]}),\r\n\t\t\t}\r\n\t\tcase 'REFRESH':\r\n\t\t\tloggedInUsers=JSON.parse(localStorage.getItem('loggedInUsers'))\r\n\t\t\tloggedInUsers[state.userId][0]=data\r\n\t\t\tlocalStorage.setItem('loggedInUsers',JSON.stringify(loggedInUsers))\r\n\t\t\treturn {access_token: data}\r\n\t\tcase 'RE_LOGIN':\r\n\t\t\tuserId=localStorage.getItem('activeUserId')\r\n\t\t\tconst login=JSON.parse(localStorage.getItem('loggedInUsers'))[userId]\r\n\t\t\treturn{\r\n\t\t\t\taccess_token: login[0],\r\n\t\t\t\trefresh_token: login[1],\r\n\t\t\t\tuserId,\r\n\t\t\t\t...JSON.parse(localStorage.getItem('cache'))\r\n\t\t\t}\r\n\t\tcase 'LOGOUT':\r\n\t\t\tlocalStorage.removeItem('activeUserId')\r\n\t\t\tloggedInUsers=JSON.parse(localStorage.getItem('loggedInUsers'))\r\n\t\t\tdelete loggedInUsers[state.userId]\r\n\t\t\tlocalStorage.setItem('loggedInUsers',JSON.stringify(loggedInUsers))\r\n\t\t\tforceUpdateApp()\r\n\t\t\treturn JSON.parse(initState)\r\n\t\tdefault: return {}\r\n\t}\r\n}\r\n\r\nfunction reduce(data){\r\n\tconst lib={}\r\n\tdata.forEach(d=>lib[d.id]=d)\r\n\treturn lib\r\n}\r\n","import React,{createContext,useReducer,useState} from 'react'\r\nimport {withRouter} from 'react-router-dom'\r\nimport axios from 'axios'\r\n// import _ from 'lodash'\r\n\r\nimport mainReducer,{initState,state} from '../reducers/mainReducer'\r\nimport {setAlert} from '../utils/Alert/Alert'\r\nimport _ from 'lodash'\r\n\r\nwindow.axios=axios\r\nexport const MainContext=createContext(JSON.parse(initState))\r\nexport const nonAlphaNumericRegex=/[^A-Za-z0-9 ]+/g\r\nexport let dispatch\r\n\r\nexport default withRouter(function MainContextProvider({children,location,history}){\r\n\tlet state\r\n\t([state,dispatch]=useReducer(mainReducer,JSON.parse(initState)))\r\n\tconst [mounted,setMounted]=useState(false)\r\n\r\n\tif(localStorage.getItem('activeUserId') && !mounted)\r\n\t\tdispatch(['RE_LOGIN'])\r\n\r\n\tif(!mounted) setMounted(true)\r\n\treturn (\r\n\t\t<MainContext.Provider value={{state,dispatch}}>{children}</MainContext.Provider>\r\n\t)\r\n})\r\n\r\nconst UNAUTHORIZED=401\r\nexport async function api(method,url,data){\r\n\t// console.log(method,url,data)\r\n\tlet {access_token}=state\r\n\tif(access_token){\r\n\t\ttry{\r\n\t\t\tawait axios.post(state.url+'token/verify/',{token: access_token})\r\n\t\t}catch(e){\r\n\t\t\tif(e.response.status===UNAUTHORIZED){ // If access_token invalid, refresh\r\n\t\t\t\ttry{\r\n\t\t\t\t\tconst r=await axios.post(state.url+'token/refresh/',{refresh: state.refresh_token})\r\n\t\t\t\t\taccess_token=r.data.access\r\n\t\t\t\t\tdispatch(['REFRESH',access_token])\r\n\t\t\t\t}catch(e){\r\n\t\t\t\t\tif(e.response.status===UNAUTHORIZED){ // If refresh_token invalid, logout\r\n\t\t\t\t\t\tsetAlert(<div className=\"row spc-12\" style={{width: 320}}>\r\n\t\t\t\t\t\t\t<div className=\"col-12 h5\">&#xf071; Error</div>\r\n\t\t\t\t\t\t\t<div className=\"col-12 h7 text-muted\">\r\n\t\t\t\t\t\t\t\tYou were logged out. Please login again...\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t<div className=\"bottom-row col-ext-x col-ext-b col-12 row spc-x-12 spc-y-8 f-justify-end\">\r\n\t\t\t\t\t\t\t\t<button onClick={()=>setAlert()}>Close</button>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</div>)\r\n\t\t\t\t\t\tdispatch(['LOGOUT'])\r\n\t\t\t\t\t\tthrow new Error('refresh_token expired')\r\n\t\t\t\t\t}else onError(e)\r\n\t\t\t\t}\r\n\t\t\t}else onError(e)\r\n\t\t}\r\n\t}\r\n\r\n\ttry{\r\n\t\tconst options={\r\n\t\t\turl: state.url+url,\r\n\t\t\tmethod,\r\n\t\t\tdata,\r\n\t\t}\r\n\t\tif(access_token) options.headers={Authorization: 'Bearer '+access_token}\r\n\t\treturn await axios(options)\r\n\t}catch(e){ onError(e) }\r\n\r\n\tfunction onError(e){\r\n\t\tconsole.log(e,e.response)\r\n\t\tsetAlert(<div className=\"row spc-12\" style={{width: 320}}>\r\n\t\t\t<div className=\"col-12 h5\">&#xf071; Error</div>\r\n\t\t\t<div className=\"col-12 h7 text-muted\">\r\n\t\t\t\t{e.response?.data?\r\n\t\t\t\t\tObject.keys(e.response.data).map(key=><div {...{key}}>{_.capitalize(key)}: {e.response.data[key]}</div>):\r\n\t\t\t\t\t<div>Error: Network Error</div>}\r\n\t\t\t</div>\r\n\t\t\t<div className=\"bottom-row col-ext-x col-ext-b col-12 row spc-x-12 spc-y-8 f-justify-end\">\r\n\t\t\t\t<button onClick={()=>setAlert()}>Close</button>\r\n\t\t\t</div>\r\n\t\t</div>)\r\n\t\tthrow e\r\n\t}\r\n}\r\n","import React,{Fragment} from 'react'\r\n// import _ from 'lodash'\r\n\r\nimport './SegmentControls.scss'\r\n\r\n// TODO: Focus\r\nexport default function SegmentControls({value,className,children,vertical,...props}){\r\n\tconst val=Number.isInteger(value)?value:-1\r\n\tconst sizeAttr=vertical?'height':'width'\r\n\treturn (\r\n\t\t<div {...props} className={'segment-controls row '+(className || '')}>\r\n\t\t\t<div\r\n\t\t\t\tclassName=\"highlight\"\r\n\t\t\t\tstyle={{\r\n\t\t\t\t\ttransform: vertical?`translateY(${val*100}%)`:`translateX(${val*100}%)`,\r\n\t\t\t\t\t[sizeAttr]: 100/children.length+'%',\r\n\t\t\t\t}}\r\n\t\t\t/>\r\n\t\t\t{children.map((c,i)=><Fragment key={i}>{c}</Fragment>)}\r\n\t\t</div>\r\n\t)\r\n}\r\n","import React,{useContext} from 'react'\r\nimport {NavLink,withRouter} from 'react-router-dom'\r\n\r\nimport './Sidemenu.scss'\r\nimport {MainContext} from '../../contexts/MainContext'\r\nimport SegmentControls from '../../utils/SegmentControls/SegmentControls'\r\n\r\nconst urlToValue={\r\n\tdashboard: 0,\r\n\tgroups: 1,\r\n\t// library: 1,\r\n\t// favorites: 1,\r\n\t// connections: 1,\r\n\t// settings: 1,\r\n}\r\n\r\n// MAYBE: Hover segment controls\r\nexport default withRouter(function Sidemenu({history,location}){\r\n\tconst {state,dispatch}=useContext(MainContext)\r\n\tconst user=state.USERS[state.userId]\r\n\treturn (\r\n\t\t<section id=\"Sidemenu\" className={'f-vert p-8 pos-abs stretch-to-fit'+(state.UI_SIDEMENU?' active':'')}>\r\n\t\t\t<div className=\"col\"/>\r\n\t\t\t<div className=\"row f-vert spc-12 mb-12\">\r\n\t\t\t\t<img className=\"profile-icon f-self-center\" src={require('../../assets/imgs/default-profile-icon.jpg')} alt=\"default-profile-icon\"/>\r\n\t\t\t\t<div className=\"text-center col-12\" style={{width: 'calc(100% - 72px)'}}>\r\n\t\t\t\t\t<div className=\"one-line\">\r\n\t\t\t\t\t\tFirstname Lastname\r\n\t\t\t\t\t\t{/*{user?user.first_name:'Firstname'}*/}\r\n\t\t\t\t\t\t{/*{user?user.last_name:'Lastname'}*/}\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div className=\"h7 text-muted\">{user?user.username:'@Username'}</div>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t\t<SegmentControls className=\"f-vert\" value={urlToValue[location.pathname.split('/')[1]] || 0} vertical={true}>\r\n\t\t\t\t<NavLink to=\"/dashboard\" className=\"p-12\">Dashboard</NavLink>\r\n\t\t\t\t{/*<Link to=\"/library\" className=\"p-12\">My PageDashboard</Link>*/}\r\n\t\t\t\t{/*<Link to=\"/favorites\" className=\"p-12\">Favorites</Link>*/}\r\n\t\t\t\t{/*<Link to=\"/connections\" className=\"p-12\">My Connections</Link>*/}\r\n\t\t\t\t<NavLink to=\"/groups\" className=\"p-12\">Groups</NavLink>\r\n\t\t\t\t{/*<Link to=\"/settings\" className=\"p-12\">Account settings</Link>*/}\r\n\t\t\t\t{/*<Link className=\"p-12\">Switch account</Link>*/}\r\n\t\t\t\t{/*<Link to=\"\" className=\"p-12\">&nbsp;</Link>*/}\r\n\t\t\t</SegmentControls>\r\n\t\t\t<div className=\"col\"/>\r\n\t\t\t<div className=\"h7 text-center mb-12\" style={{cursor: 'pointer'}} onClick={logout}><i className=\"icon icon-signout\"/> Logout</div>\r\n\t\t</section>\r\n\t)\r\n\r\n\tfunction logout(){\r\n\t\tdispatch(['LOGOUT'])\r\n\t\thistory.push('/login')\r\n\t}\r\n})","import React,{useContext} from 'react'\r\n\r\nimport './Header.scss'\r\nimport {MainContext} from '../../contexts/MainContext'\r\n\r\nexport default function Header({children}){\r\n\tconst {state}=useContext(MainContext)\r\n\r\n\treturn (\r\n\t\t<header className=\"Header row spc-x-8 f-center pos-sty f-order-m1\">\r\n\t\t\t<h3 className=\"logo small-caps f-center ml-12\">\r\n\t\t\t\t<span className=\"b-800\">BB</span>B<span className=\"b-600\">ook</span>\r\n\t\t\t\t<sup className=\"h7 normal-caps ml-4\" style={{height: 'auto'}}>Pre-Alpha <b className=\"b-900\">{state.version}</b></sup>\r\n\t\t\t</h3>\r\n\t\t\t{children}\r\n\t\t\t{/*<SegmentControls className=\"ml-16\" value={1}>*/}\r\n\t\t\t{/*\t<div className=\"super-center px-16\">Discover</div>*/}\r\n\t\t\t{/*\t<div className=\"super-center px-16 active\">PageDashboard</div>*/}\r\n\t\t\t{/*</SegmentControls>*/}\r\n\t\t\t{/*<div className=\"col\"/>*/}\r\n\t\t\t{/*<input className=\"col mx-8\" type=\"search\"/>*/}\r\n\t\t\t{/*<button className=\"new-group-button mr-16 f-center\">New Group</button>*/}\r\n\t\t\t{/*<div className=\"text-right\">*/}\r\n\t\t\t{/*\tFirstname Lastname*/}\r\n\t\t\t{/*\t<div className=\"h7 text-muted\">@Username</div>*/}\r\n\t\t\t{/*</div>*/}\r\n\t\t\t{/*<img*/}\r\n\t\t\t{/*\tclassName=\"profile-icon\"*/}\r\n\t\t\t{/*\tsrc={require('../../assets/imgs/default-profile-icon.jpg')}*/}\r\n\t\t\t{/*\talt=\"default-profile-icon\"*/}\r\n\t\t\t{/*\tonClick={()=>dispatch(['SET_UI_SIDEMENU',!state.UI_SIDEMENU])}/>*/}\r\n\t\t</header>\r\n\t)\r\n}\r\n","import React,{useContext} from 'react'\r\nimport {Link,withRouter} from 'react-router-dom'\r\n\r\nimport './Group.scss'\r\nimport {MainContext} from '../../contexts/MainContext'\r\n\r\nexport default withRouter(function Group({group,location}){\r\n\tconst {state}=useContext(MainContext)\r\n\r\n\tconst {userId}=state\r\n\tconst isAdmin=group.admins.indexOf(+userId)!==-1 // TODO: UserID Check\r\n\tconst title=<>\r\n\t\t<img className=\"mr-12\" src={require('../../assets/imgs/letter.png')} alt=\"Group icon\"/>\r\n\t\t<h3>{group.title}</h3>\r\n\t\t<div className=\"h7 text-muted one-line\">{group.bio}</div>\r\n\t</>\r\n\treturn (\r\n\t\t<div className=\"Group row spc-16\">\r\n\t\t\t{location.pathname.split('/').indexOf('group')===-1?\r\n\t\t\t\t<Link to={location.pathname+'/group/'+group.id} className=\"title col pb-12 pos-rel\">{title}</Link>:\r\n\t\t\t\t<div className=\"title col pb-12 pos-rel\">{title}</div>}\r\n\t\t\t{isAdmin?\r\n\t\t\t\t<Link to={location.pathname+'/edit-group/'+group.id} className=\"fa fa-ellipsis-v h5 super-center px-12\"/>\r\n\t\t\t\t:undefined}\r\n\t\t\t<hr className=\"col-12 col-ext-y\"/>\r\n\t\t\t{group.books.map(bookId=>{\r\n\t\t\t\tconst b=state.BOOKS[bookId]\r\n\t\t\t\treturn b?(\r\n\t\t\t\t\t<Link to={location.pathname+'/book/'+bookId} className=\"col-3 col-2-xl book\" key={bookId}>\r\n\t\t\t\t\t\t<img className=\"col-12 card\" src={b.thumbnail || require('../../assets/imgs/letter.png')} alt=\"PageBook placeholder\"/>\r\n\t\t\t\t\t\t<div className=\"pt-8\">\r\n\t\t\t\t\t\t\t<div className=\"one-line\">{b.title}</div>\r\n\t\t\t\t\t\t\t<div className=\"h7 text-muted one-line\">{b.detail}</div>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</Link>\r\n\t\t\t\t):undefined\r\n\t\t\t})}\r\n\t\t\t{isAdmin?<div className=\"pos-rel col-3 col-2-xl add-book f-self-start\">\r\n\t\t\t\t<img className=\"col-12\" src={require('../../assets/imgs/letter.png')} alt=\"PageBook placeholder\"/>\r\n\t\t\t\t<div className=\"pos-abs stretch-to-fit super-center f-vert\">\r\n\t\t\t\t\t<h3 className=\"mb-6\">&#x002B;</h3>\r\n\t\t\t\t\tAdd Book\r\n\t\t\t\t</div>\r\n\t\t\t</div>:undefined}\r\n\t\t</div>\r\n\t)\r\n})\r\n","import React,{useContext,useEffect} from 'react'\r\nimport {withRouter} from 'react-router-dom'\r\nimport {Scrollbar} from 'react-scrollbars-custom'\r\n\r\nimport './PageDashboard.scss'\r\nimport Header from '../Header/Header'\r\nimport {MainContext,api} from '../../contexts/MainContext'\r\nimport Group from '../Group/Group'\r\n\r\nexport default withRouter(function PageDashboard({location}){\r\n\tconst {state,dispatch}=useContext(MainContext)\r\n\tuseEffect(refresh,[state.userId]) // TODO: Test userId instead of pathname\r\n\tconst user=state.USERS[state.userId]\r\n\r\n\tfunction refresh(){\r\n\t\tif(!state.userId) return\r\n\t\tapi('get','dashboard/'+state.userId).then(({data})=>{\r\n\t\t\tdispatch(['SET_DATA',data])\r\n\t\t}).catch(console.error)\r\n\t}\r\n\r\n\treturn (\r\n\t\t<Scrollbar disableTracksWidthCompensation id=\"PageDashboard\" className=\"pos-abs stretch-to-fit\">\r\n\t\t\t<div className=\"f-vert\">\r\n\t\t\t\t<div className=\"container\">\r\n\t\t\t\t\t{(user?.joined_groups || []).map(groupId=>{\r\n\t\t\t\t\t\tconst group=state.GROUPS[groupId]\r\n\t\t\t\t\t\treturn group?(\r\n\t\t\t\t\t\t\t<Group {...{key:groupId,group}}/>\r\n\t\t\t\t\t\t):undefined\r\n\t\t\t\t\t})}\r\n\t\t\t\t</div>\r\n\t\t\t\t<Header>\r\n\t\t\t\t\t<div className=\"col\"/>\r\n\t\t\t\t\t<div className=\"icon icon-refresh super-center\" onClick={refresh}/>\r\n\t\t\t\t</Header>\r\n\t\t\t</div>\r\n\t\t</Scrollbar>\r\n\t)\r\n})\r\n","import React,{useContext,useState} from 'react'\r\nimport {Link,withRouter} from 'react-router-dom'\r\n\r\nimport './Comment.scss'\r\nimport {MainContext,api} from '../../contexts/MainContext'\r\nimport {setAlert} from '../../utils/Alert/Alert'\r\n\r\nconst whitespaceRegex=/\\s+/\r\n\r\n// TODO: CommentBody\r\n// TODO: Right-click\r\nexport default withRouter(function Comment({location,children,commentId,showChildren}){\r\n\tconst {state,dispatch}=useContext(MainContext)\r\n\tconst [editMode,setEditMode]=useState()\r\n\r\n\tconst comment=state.COMMENTS[commentId]\r\n\tconst user=state.USERS[comment?.user]\r\n\tconst {userId}=state\r\n\r\n\tlet commentBody\r\n\r\n\tif(comment){\r\n\t\tconst selection=comment?.selection_data?JSON.parse(comment?.selection_data):[]\r\n\t\tcommentBody=<>\r\n\t\t\t{/* TODO: selectionIndex data redesign */}\r\n\t\t\t{/* TODO: remove onCLick workaround after node.js backend */}\r\n\t\t\t{selection.map((s,i)=><blockquote\r\n\t\t\t\tkey={i}\r\n\t\t\t\tclassName=\"h7 text-muted mt-2 row cur-p\"\r\n\t\t\t\tonClick={()=>document.querySelector(`#a-${commentId}-0`)?.scrollIntoView({behavior: 'smooth'})}>\r\n\t\t\t\t<div className=\"trim-y col\">{s?.text}</div>\r\n\t\t\t</blockquote>)}\r\n\t\t\t{/*userId+''===comment.user+''?<div className=\"h7 b-700\" style={{marginBottom: '-21px !important'}}>\r\n\t\t\t\t<i className=\"fa fa-plus\"/> Add Highlight\r\n\t\t\t</div>:undefined*/}\r\n\t\t\t<div className=\"h8 my-2 text-right\">{(new Date(comment.created_at)).toLocaleString()}</div> {/* TODO: Beautify */}\r\n\t\t\t<div className=\"bottom-row col-ext-x col-ext-b row spc-8 spc-x-12 f-center\">\r\n\t\t\t\t{/*<i className=\"icon icon-arrow_big_up\" onClick={like}/><div className=\"h7 ml-0\">{comment.liked.length}</div>\r\n\t\t\t\t<i className=\"icon icon-arrow_big_down text-muted\"/><div className=\"h7 ml-0\">{comment.disliked.length}</div>*/}\r\n\t\t\t\t{/*<i className=\"fa fa-star text-muted h6\"/>*/}\r\n\t\t\t\t<div className=\"col\"/>\r\n\t\t\t\t<i className=\"icon icon-reply h6\"/><div className=\"h7 ml-0\">{comment.replys.length}</div>\r\n\t\t\t\t<Link className=\"button super-center\" to={location?.pathname+'/thread/'+commentId}>Open Thread</Link>\r\n\t\t\t\t{userId+''===comment.user+''?<>\r\n\t\t\t\t\t{editMode?<div className=\"edit-form-open pos-abs stretch-to-fit\" onClick={()=>setEditMode(false)}/>:undefined}\r\n\t\t\t\t\t<div className=\"px-12 py-8 col-ext pos-rel f-self-stretch f-center cur-p\" onClick={()=>setEditMode(true)}>\r\n\t\t\t\t\t\t<i className=\"fa fa-ellipsis-v\"/>\r\n\t\t\t\t\t\t<div className={'edit-form pos-abs card trim'+(editMode?' active':' ')}>\r\n\t\t\t\t\t\t\t<div className=\"px-12 py-8 f-center\" onClick={deleteComment}><i className=\"icon-cross_mark mr-8\"/>Delete</div>\r\n\t\t\t\t\t\t\t{/*<div className=\"px-12 py-8\">Edit</div>*/}\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</>:undefined}\r\n\t\t\t</div>\r\n\t\t</>\r\n\t\treturn (\r\n\t\t\t<>\r\n\t\t\t\t<style>{`\r\n\t\t\t\t\tmark-${commentId}.highlight.highlight{ --alpha: 1 }\r\n\t\t\t\t`}</style>\r\n\t\t\t\t<div className=\"Comment\">\r\n\t\t\t\t\t<div id={`b-${commentId}`} className=\"id-tag\"/>\r\n\t\t\t\t\t<div className=\"row pb-4\">\r\n\t\t\t\t\t\t{comment.hidden?undefined:<>\r\n\t\t\t\t\t\t\t<div className=\"h7 hashtag\">{comment.hashtag.split(whitespaceRegex).map((h,i)=><span key={i} className=\"mr-4\">#{h}</span>)}</div>\r\n\t\t\t\t\t\t</>}\r\n\t\t\t\t\t\t<div className=\"col\"/>\r\n\t\t\t\t\t\t<div className=\"h7 text-muted\">@{user.username}</div>\r\n\t\t\t\t\t\t<img className=\"pos-rel\" src={require('../../assets/imgs/default-profile-icon.jpg')} alt=\"User icon\"/>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div className=\"card row f-vert spc-12\">\r\n\t\t\t\t\t\t<div className=\"o ne-line\">{comment.hidden?'[Deleted]':comment.body}</div>\r\n\t\t\t\t\t\t{comment.hidden?undefined:commentBody}\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t\t{showChildren && (children || !!comment?.replys.length) &&\r\n\t\t\t\t<div className=\"reply col-ext row spc-12\">\r\n\t\t\t\t\t<div className=\"col col-ext-x col-ext-t row spc-12 f-vert\">\r\n\t\t\t\t\t\t{comment?.replys.map(c=><Comment key={c} {...{commentId: c,showChildren}}/>)}\r\n\t\t\t\t\t\t{children}\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t\t}\r\n\t\t\t</>\r\n\t\t)\r\n\t}else return undefined\r\n\r\n\tfunction like(){\r\n\t\tapi('put','like/'+commentId,undefined,{headers:{\r\n\t\t\tuserid: userId\r\n\t\t}}).then(({data})=>{\r\n\t\t\tconsole.log(data)\r\n\t\t})\r\n\t}\r\n\r\n\tfunction deleteComment(){\r\n\t\t// TODO: Use commentBody\r\n\t\tsetAlert(\r\n\t\t\t<div className=\"row spc-12\" style={{maxWidth: '320px'}}>\r\n\t\t\t\t<div className=\"col-12\">Do you want to delete this comment?</div>\r\n\t\t\t\t<div className=\"Comment card col-12 row f-vert spc-12\">\r\n\t\t\t\t\t<div className=\"o ne-line\">{comment.body}</div>\r\n\t\t\t\t\t<blockquote className=\"h7 text-muted mt-2 row\">\r\n\t\t\t\t\t\t<div className=\"trim-y col\">{comment.selection_data}</div>\r\n\t\t\t\t\t</blockquote>\r\n\t\t\t\t\t<div className=\"h8 my-2 text-right\">{(new Date(comment.created_at)).toLocaleString()}</div> {/* TODO: Beautify */}\r\n\t\t\t\t</div>\r\n\t\t\t\t<div className=\"bottom-row col-ext-x col-ext-b col-12 row spc-x-12 spc-y-8 f-justify-end\">\r\n\t\t\t\t\t<button className=\"outline\" onClick={()=>setAlert()}>Cancel</button>\r\n\t\t\t\t\t<button onClick={()=>{\r\n\t\t\t\t\t\tapi('delete','comment/'+commentId).then(({data})=>{\r\n\t\t\t\t\t\t\tsetAlert()\r\n\t\t\t\t\t\t\tcomment.hidden=true\r\n\t\t\t\t\t\t\tdispatch(['SET_DATA',{comments: [comment]}])\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t}}>OK</button>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t)\r\n\t}\r\n})\r\n","import {PureComponent} from 'react'\r\n\r\nexport default class MyComponent extends PureComponent{\r\n\t// Used for simple 2-way binding\r\n\t// eg: <input {...this.twoWayBind('stateVariable')}/> will return\r\n\t// <input value={this.state['stateVariable']} onChange={e=>this.setState({'stateVariable':e.target.value}}/>\r\n\t// TODO: Finish example for different params\r\n\ttwoWayBind=(property,event='onChange',valAttr='value')=>({\r\n\t\t[valAttr]:this.state[property],\r\n\t\t[event]:e=>this.setState({[property]:e.target[valAttr]}),\r\n\t})\r\n}","import React from 'react'\r\nimport {withRouter} from 'react-router-dom'\r\nimport {Scrollbar} from 'react-scrollbars-custom'\r\n\r\nimport './CommentThread.scss'\r\nimport Comment from '../Comment/Comment'\r\nimport MyComponent from '../MyComponent'\r\nimport {MainContext,nonAlphaNumericRegex,api} from '../../contexts/MainContext'\r\n\r\nconst initState=JSON.stringify({\r\n\tbody: '',\r\n\thashtag: '',\r\n})\r\nexport default withRouter(class CommentThread extends MyComponent{\r\n\tstatic contextType=MainContext\r\n\tstate=JSON.parse(initState)\r\n\r\n\tonSubmit=e=>{\r\n\t\te.preventDefault()\r\n\t\tconst commentId=this.props.match.params.id\r\n\t\tconst {body,hashtag}=this.state\r\n\t\tconst {COMMENTS,BOOKS,userId}=this.context.state\r\n\t\tconst comment=COMMENTS[commentId]\r\n\t\tapi('post','comment/',{\r\n\t\t\tbody,\r\n\t\t\thashtag: hashtag.replace(nonAlphaNumericRegex,'').trim(),\r\n\t\t\tuser: userId,\r\n\t\t\tbook: comment.book,\r\n\t\t\treplyto: commentId,\r\n\t\t\ttypeof: 'reply'\r\n\t\t}).then(({data})=>{\r\n\t\t\tCOMMENTS[commentId].replys.push(data.id)\r\n\t\t\tconsole.log({comments: [data,COMMENTS[commentId]]})\r\n\t\t\tconst book=BOOKS[comment.book]\r\n\t\t\tbook.comment_set.push(data.id)\r\n\t\t\tthis.context.dispatch(['SET_DATA',{comments: [data,COMMENTS[commentId]],books: [book]}])\r\n\t\t\tthis.setState(JSON.parse(initState))\r\n\t\t})\r\n\t}\r\n\r\n\trender(){\r\n\t\t// console.log(this.props)\r\n\t\tconst {onSubmit}=this\r\n\t\tconst {history,match}=this.props\r\n\t\tconst commentId=match.params.id\r\n\t\tconst {userId,USERS}=this.context.state\r\n\r\n\t\treturn (\r\n\t\t\t<div className=\"CommentThread pos-abs stretch-to-fit row spc-12 f-justify-end\">\r\n\t\t\t\t<div className=\"p-12 f-start f-justify-end f-self-start\">\r\n\t\t\t\t\t<div className=\"h5 icon icon-cross_mark\" onClick={history.goBack} style={{cursor: 'pointer'}}/>\r\n\t\t\t\t</div>\r\n\t\t\t\t<Scrollbar disableTracksWidthCompensation className=\"thread-container col\" style={{height: 'auto'}}>\r\n\t\t\t\t\t<div className=\"row spc-12 f-vert pos-rel\">\r\n\t\t\t\t\t\t<Comment {...{commentId,showChildren: true}}>\r\n\t\t\t\t\t\t\t<div className=\"reply-input\">\r\n\t\t\t\t\t\t\t\t<div className=\"top-row row pb-4 f-justify-end\">\r\n\t\t\t\t\t\t\t\t\t<div className=\"col\"/>\r\n\t\t\t\t\t\t\t\t\t<div className=\"h7 text-muted\">@{USERS[userId]?.username || 'Username'}</div>\r\n\t\t\t\t\t\t\t\t\t<img className=\"pos-rel\" src={require('../../assets/imgs/default-profile-icon.jpg')} alt=\"User icon\"/>\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t<form className=\"form row spc-12\" {...{onSubmit}}>\r\n\t\t\t\t\t\t\t\t\t<div className=\"h7 col-12 my-2\">Add reply</div>\r\n\t\t\t\t\t\t\t\t\t<textarea required className=\"col-12\" cols=\"30\" rows=\"10\" placeholder=\"Reply\" {...this.twoWayBind('body')}/>\r\n\t\t\t\t\t\t\t\t\t<input type=\"text\" className=\"col\" placeholder=\"#Hashtag\" {...this.twoWayBind('hashtag')}/>\r\n\t\t\t\t\t\t\t\t\t<button>Post</button>\r\n\t\t\t\t\t\t\t\t</form>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</Comment>\r\n\t\t\t\t\t\t{/*<div style={{height: '1000px'}}/>*/}\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</Scrollbar>\r\n\t\t\t</div>\r\n\t\t)\r\n\t}\r\n})\r\n","export function getChildNodeIndex(element){\r\n\treturn Array.from(element.parentNode.children).indexOf(element)\r\n}\r\n\r\n// Warning: Will fail if whitespaces are present\r\nexport function getSelectionOffsetFromParent(node,parent,offset=0){\r\n\tconsole.warn('getSelectionOffsetFromParent: Will fail if whitespaces are present')\r\n\twhile(1){\r\n\t\tif(node===parent) return offset\r\n\t\tif(node.previousSibling){\r\n\t\t\tnode=node.previousSibling\r\n\t\t\toffset+=((node.innerText)?node.innerText.length:node.length)\r\n\t\t\tcontinue\r\n\t\t}\r\n\t\tnode=node.parentNode\r\n\t}\r\n}\r\n\r\nexport function binarySearchFindClosest(sortedArray,ele){\r\n\tconst getClosest=(val1,val2,ele)=>((ele-val1>=val2-ele)?val2:val1)\r\n\tconst n=sortedArray.length\r\n\r\n\t// Corner cases\r\n\tif(ele<=sortedArray[0]) return sortedArray[0]\r\n\tif(ele>=sortedArray[n-1]) return sortedArray[n-1]\r\n\r\n\t// Doing binary search\r\n\tlet low=0,high=n,mid=0\r\n\twhile(low<high){\r\n\t\tmid=(low+high)>>1\r\n\r\n\t\tif(sortedArray[mid]===ele) return sortedArray[mid]\r\n\r\n\t\t// If ele is less than mid element, search left portion\r\n\t\telse if(ele<sortedArray[mid]){\r\n\t\t\t// If ele is greater than previous to mid, return closest of two\r\n\t\t\tif(mid>0 && ele>sortedArray[mid-1]) return getClosest(sortedArray[mid-1],sortedArray[mid],ele)\r\n\t\t\t// Repeat for left half\r\n\t\t\thigh=mid\r\n\t\t}\r\n\r\n\t\t// If ele is greater than mid element, search right portion\r\n\t\telse{\r\n\t\t\t// If ele is lesser than next to mid, return closest of two\r\n\t\t\tif(mid<n-1 && ele<sortedArray[mid+1]) return getClosest(sortedArray[mid],sortedArray[mid+1],ele)\r\n\t\t\t// Repeat for right half\r\n\t\t\tlow=mid+1\r\n\t\t}\r\n\t}\r\n\r\n\t// Only single element left after search\r\n\treturn sortedArray[mid]\r\n}\r\n\r\nexport function binarySearchFindClosestIndex(sortedArray,ele){\r\n\tconst getClosestIndex=(i1,i2,ele)=>((ele-sortedArray[i1]>=sortedArray[i2]-ele)?i2:i1)\r\n\tconst n=sortedArray.length\r\n\r\n\t// Corner cases\r\n\tif(ele<=sortedArray[0]) return 0\r\n\tif(ele>=sortedArray[n-1]) return n-1\r\n\r\n\t// Doing binary search\r\n\tlet low=0,high=n,mid=0\r\n\twhile(low<high){\r\n\t\tmid=(low+high)>>1\r\n\r\n\t\tif(sortedArray[mid]===ele) return mid\r\n\r\n\t\t// If ele is less than mid element, search left portion\r\n\t\telse if(ele<sortedArray[mid]){\r\n\t\t\t// If ele is greater than previous to mid, return closest of two\r\n\t\t\tif(mid>0 && ele>sortedArray[mid-1]) return getClosestIndex(mid-1,mid,ele)\r\n\t\t\t// Repeat for left half\r\n\t\t\thigh=mid\r\n\t\t}\r\n\r\n\t\t// If ele is greater than mid element, search right portion\r\n\t\telse{\r\n\t\t\t// If ele is lesser than next to mid, return closest of two\r\n\t\t\tif(mid<n-1 && ele<sortedArray[mid+1]) return getClosestIndex(mid,mid+1,ele)\r\n\t\t\t// Repeat for right half\r\n\t\t\tlow=mid+1\r\n\t\t}\r\n\t}\r\n\r\n\t// Only single element left after search\r\n\treturn mid\r\n}","import React from 'react'\r\n\r\nimport './Spinner.scss'\r\n\r\nexport default function Spinner({className}){\r\n\treturn (\r\n\t\t<div className={'spinner pos-abs stretch-to-fit super-center '+className}>\r\n\t\t\t<img className=\"p-8\" src={require('../../assets/imgs/spinner.gif')} alt=\"Spinner\"/>\r\n\t\t</div>\r\n\t)\r\n}","import React,{memo,useEffect,useState} from 'react'\r\nimport * as pdfjs from 'pdfjs-dist'\r\nimport _ from 'lodash'\r\n\r\nimport Spinner from '../Spinner/Spinner'\r\n\r\npdfjs.GlobalWorkerOptions.workerSrc=`//cdnjs.cloudflare.com/ajax/libs/pdf.js/${pdfjs.version}/pdf.worker.js`\r\n\r\nexport default pdfjs\r\n\r\nexport const PdfImage=memo(function({page,viewport}){\r\n\tconst [data,setData]=useState(undefined)\r\n\tif(!data){\r\n\t\tconst canvas=document.createElement('canvas')\r\n\t\tconst canvasContext=canvas.getContext('2d')\r\n\t\tcanvas.height=viewport.height\r\n\t\tcanvas.width=viewport.width\r\n\r\n\t\tpage.render({canvasContext,viewport}).promise.then(()=>setData(canvas.toDataURL()))\r\n\t\treturn <Spinner className=\"active\"/> // TODO: Change spinner background to white\r\n\t}else\r\n\t\treturn <img src={data} alt=\"\"/>\r\n})\r\n\r\n// Memoize renderTextLayer\r\nconst renderTextLayer=async (page,viewport)=>{\r\n\ttry{\r\n\t\tconst textContent=await page.getTextContent()\r\n\t\t// console.log(textContent)\r\n\t\tconst container=document.createElement('div')\r\n\t\tawait pdfjs.renderTextLayer({\r\n\t\t\ttextContent,\r\n\t\t\tcontainer,\r\n\t\t\tviewport,\r\n\t\t\ttextDivs: [],\r\n\t\t}).promise\r\n\t\treturn container\r\n\t}catch(e){ console.error(e) }\r\n}\r\n\r\nconst tagOpen=data=>`<mark-${data.id} id=\"a-${data.id}-${data.i}\" class=\"highlight\">`\r\nconst tagClose=data=>`</mark-${data.id}>`\r\nexport const TextLayer=memo(function({page,viewport,pageComments}){\r\n\tconst [__html,setHtml]=useState(undefined)\r\n\tpageComments && renderTextLayer(page,viewport).then(textDiv=>{\r\n\t\t// Map highlights to line number (<span> index) as {commentId,selectionIndex,selectionOffset,isOpeningTag}\r\n\t\tconst lineData=[]\r\n\t\tpageComments.forEach(c=>{ // eslint-disable-line no-unused-expressions\r\n\t\t\t// TODO: JSON.parse in pageBook for performance\r\n\t\t\tJSON.parse(c.selection_data || '[]').forEach((s,i)=>s.data.forEach(p=>{\r\n\t\t\t\tif(!lineData[p.startLine]) lineData[p.startLine]=[]\r\n\t\t\t\tlineData[p.startLine].push({id: c.id,i,offset: p.startOffset,start: true})\r\n\t\t\t\tif(!lineData[p.endLine]) lineData[p.endLine]=[]\r\n\t\t\t\tlineData[p.endLine].push({id: c.id,i,offset: p.endOffset,start: false})\r\n\t\t\t}))\r\n\t\t})\r\n\r\n\t\tconst openStack=[] // Tags opened will be added to this stack, popped as they are closed\r\n\t\tArray.from(textDiv.children).forEach((lineEle,lineNum)=>{ // For each span (line)\r\n\t\t\tconst l=lineData[lineNum]\r\n\t\t\tconst substrings=openStack.map(tagOpen) //\r\n\t\t\tif(l){ // If selection present in this line\r\n\t\t\t\tl.sort((a,b)=>a.offset-b.offset)\r\n\t\t\t\tl.forEach((data,i)=>{\r\n\t\t\t\t\tsubstrings.push(\r\n\t\t\t\t\t\t_.escape(lineEle.innerText.substring(\r\n\t\t\t\t\t\t\t(i===0)?0:l[i-1].offset,\r\n\t\t\t\t\t\t\tl[i].offset\r\n\t\t\t\t\t\t))\r\n\t\t\t\t\t)\r\n\t\t\t\t\tif(data.start){\r\n\t\t\t\t\t\tsubstrings.push(tagOpen(data))\r\n\t\t\t\t\t\topenStack.push(data)\r\n\t\t\t\t\t\t// console.log('push',[...openStack],data,lineNum)\r\n\t\t\t\t\t}else{\r\n\t\t\t\t\t\t// console.log('splice',[...openStack],data,openStack.findIndex(d=>d.id===data.id),lineNum)\r\n\t\t\t\t\t\tsubstrings.push(openStack.map(tagClose).join(''))          // Close all open tags\r\n\t\t\t\t\t\topenStack.splice(openStack.findIndex(d=>d.id===data.id),1) // Remove closed tag from openStack\r\n\t\t\t\t\t\tsubstrings.push(openStack.map(tagOpen).join(''))           // Open all open tags again\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t\tsubstrings.push(\r\n\t\t\t\t\t_.escape(lineEle.innerText.substring(\r\n\t\t\t\t\t\t(l.pop()).offset,\r\n\t\t\t\t\t\tlineEle.innerText.length\r\n\t\t\t\t\t))\r\n\t\t\t\t)\r\n\t\t\t\tsubstrings.push(openStack.map(tagClose).join(''))\r\n\t\t\t\t// console.log(substrings,substrings.join(''),[...openStack],lineNum)\r\n\t\t\t}else substrings.push(lineEle.innerHTML)\r\n\t\t\tlineEle.innerHTML=substrings.join('')\r\n\t\t\t// console.log(lineEle.innerHTML)\r\n\t\t})\r\n\t\tsetHtml(textDiv.innerHTML)\r\n\t})\r\n\treturn (pageComments && !__html)? // If page has comments and not yet rendered\r\n\t\t<Spinner className=\"active\"/>:\r\n\t\t<div className=\"text-layer pos-abs stretch-to-fit\" dangerouslySetInnerHTML={{__html}}/>\r\n})\r\n","import React,{useContext,useEffect,useState} from 'react'\r\nimport {withRouter,Route,Link} from 'react-router-dom'\r\nimport {Scrollbar} from 'react-scrollbars-custom'\r\n\r\nimport './PageBook.scss'\r\nimport Header from '../Header/Header'\r\nimport SegmentControls from '../../utils/SegmentControls/SegmentControls'\r\nimport tabStart from '../../assets/imgs/tab-start.svg'\r\nimport Comment from '../Comment/Comment'\r\nimport CommentThread from '../CommentThread/CommentThread'\r\nimport PdfVerticalScroll from '../PdfVerticalScroll/PdfVerticalScroll'\r\nimport {MainContext,api} from '../../contexts/MainContext'\r\nimport Spinner from '../../utils/Spinner/Spinner'\r\nimport NewQuestionComment from '../NewQuestionComment/NewQuestionComment'\r\nimport pdfjs from '../../utils/PDFRenderer/PDFRenderer'\r\n\r\nexport const sidebarModes=['question','comment','note','highlight']\r\nexport const publicPrivateModes={\r\n\t'question' : 'public',\r\n\t'comment'  : 'public',\r\n\t'note'     : 'private',\r\n\t'highlight': 'private',\r\n}\r\n\r\n// TODO: PageBook might not be single-instance, check id, and below variables\r\nexport let setSidebarMode,setSelection\r\nexport default withRouter(function PageBook({history,match,location}){\r\n\tconst {state,dispatch}=useContext(MainContext)\r\n\tlet sidebarMode,selection\r\n\t;[sidebarMode,setSidebarMode]=useState('comment') // TODO: Change to path variable\r\n\tconst publicPrivateMode=publicPrivateModes[sidebarMode]\r\n\tconst [userFilter,setUserFilter]=useState(false)\r\n\tconst [publicSearchString,setPublicSearchString]=useState('')\r\n\t;[selection,setSelection]=useState(undefined)\r\n\tconst [pdf,setPdf]=useState(undefined)\r\n\tuseEffect(()=>{componentDidMount()},[]) // eslint-disable-line react-hooks/exhaustive-deps\r\n\tuseEffect(refresh,[location.pathname])\r\n\r\n\tconst book=state.BOOKS[match.params.id]\r\n\tconst group=state.GROUPS[book?.group_id] // TODO: Backend group_id\r\n\tconst {userId}=state\r\n\r\n\tconst categorizedInitState=JSON.stringify({\r\n\t\t'question' : [],\r\n\t\t'comment'  : [],\r\n\t\t'note'     : [],\r\n\t\t'highlight': [],\r\n\t}) // Categorizing comments based on type\r\n\t// TODO: Maybe merge these 2 states\r\n\tconst [categorized,setCategorized]=useState(JSON.parse(categorizedInitState))\r\n\tconst [pageWiseComments,setPageWiseComments]=useState([])\r\n\r\n\t// Generate categorized comments and pageWiseComments on book.comment_set update\r\n\tuseEffect(()=>{\r\n\t\tconsole.log('Generating categorized comments and pageWiseComments')\r\n\t\tconst categorized=JSON.parse(categorizedInitState)\r\n\t\tconst allComments=[] // from ids to comments\r\n\t\tbook?.comment_set.forEach(c=>{ // eslint-disable-line no-unused-expressions\r\n\t\t\tc=state.COMMENTS[c]\r\n\t\t\tif(!c) return\r\n\t\t\tif(!categorized[c.typeof]) categorized[c.typeof]=[]\r\n\t\t\tif(!c.hidden){\r\n\t\t\t\tcategorized[c.typeof].push(c)\r\n\t\t\t\tallComments.push(c)\r\n\t\t\t}\r\n\t\t})\r\n\t\tsetCategorized(categorized)\r\n\r\n\t\tconst pageWiseComments={}\r\n\t\tallComments.forEach(c=>{\r\n\t\t\tJSON.parse(c.selection_data || '[]').forEach(s=>s.data.forEach(p=>{\r\n\t\t\t\tconst pageNum=+p.page\r\n\t\t\t\tif(!pageWiseComments[pageNum]) pageWiseComments[pageNum]=[]\r\n\t\t\t\tpageWiseComments[pageNum].push(c)\r\n\t\t\t}))\r\n\t\t})\r\n\t\tsetPageWiseComments(pageWiseComments)\r\n\t},[book?.comment_set]) // eslint-disable-line react-hooks/exhaustive-deps\r\n\r\n\tconst filtered=categorized[sidebarMode].filter(comment=>(\r\n\t\t(!userFilter || (userFilter || publicPrivateMode!=='public') && ''+comment.user===''+userId) && // eslint-disable-line\r\n\t\t(comment.hashtag.indexOf(publicSearchString)!==-1)\r\n\t))\r\n\r\n\tfunction refresh(){\r\n\t\tapi('get','readingbook/'+match.params.id).then(({data})=>{\r\n\t\t\tdispatch(['SET_DATA',data])\r\n\t\t}).catch(console.error)\r\n\t}\r\n\r\n\tasync function componentDidMount(){\r\n\t\t// console.log('PageBook componentDidMount')\r\n\t\tif(book?.docfile){\r\n\t\t\tconst pdfLoadTask=pdfjs.getDocument(book.docfile)\r\n\t\t\tpdfLoadTask.onProgress=({loaded,total})=>console.log(loaded/total*100)\r\n\t\t\t// console.log(pdfLoadTask)\r\n\t\t\tconst pdf=await pdfLoadTask.promise\r\n\t\t\t// console.log(pdf)\r\n\t\t\tconst promises=new Array(pdf.numPages)\r\n\t\t\tfor(let i=0;i<promises.length;++i) promises[i]=pdf.getPage(i+1)\r\n\t\t\tconst pages=await Promise.all(promises)\r\n\t\t\tconst viewports=generateViewports(pages,1.5)\r\n\t\t\t// console.log(pages,viewports)\r\n\t\t\tsetPdf({pdf,pages,viewports})\r\n\t\t}\r\n\t}\r\n\r\n\t// re-use when zooming\r\n\tfunction generateViewports(pages,scale){\r\n\t\treturn pages.map(p=>p.getViewport({scale}))\r\n\t}\r\n\r\n\treturn (\r\n\t\t<div id=\"PageBook\" className=\"pos-abs stretch-to-fit f-vert\">\r\n\t\t\t<section className=\"row main-section\">\r\n\t\t\t\t<div className=\"col left-sidebar pos-rel\">\r\n\t\t\t\t\t<PdfVerticalScroll {...{pdf,publicPrivateMode,selection,book,pageWiseComments}}/>\r\n\t\t\t\t\t<Spinner className={pdf?.pdf?'':'active'}/>\r\n\t\t\t\t\t<Route path=\"*/new-comment\" render={props=><NewQuestionComment {...{props,selection,book,sidebarMode}}/>}/>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div className=\"right-sidebar row pos-rel p-12 pl-0\">\r\n\t\t\t\t\t<div className=\"vertical-tabs f-vert\">\r\n\t\t\t\t\t\t<div className=\"col\" style={{maxHeight: '14px'}}/>\r\n\t\t\t\t\t\t{publicPrivateMode==='public'?<>\r\n\t\t\t\t\t\t\t<div className={sidebarMode==='question'?'active':''} onClick={()=>setSidebarMode('question')}>\r\n\t\t\t\t\t\t\t\t<img src={tabStart} alt=\"\"/>\r\n\t\t\t\t\t\t\t\t<div className=\"vertical-text px-4\">Questions <span className=\"h7\">\r\n\t\t\t\t\t\t\t\t\t{categorized['question'].length}\r\n\t\t\t\t\t\t\t\t</span></div>\r\n\t\t\t\t\t\t\t\t<img src={tabStart} alt=\"\"/>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t<div className={sidebarMode==='comment'?'active':''} onClick={()=>setSidebarMode('comment')}>\r\n\t\t\t\t\t\t\t\t<img src={tabStart} alt=\"\"/>\r\n\t\t\t\t\t\t\t\t<div className=\"vertical-text px-4\">Comments <span className=\"h7\">\r\n\t\t\t\t\t\t\t\t\t{categorized['comment'].length}\r\n\t\t\t\t\t\t\t\t</span></div>\r\n\t\t\t\t\t\t\t\t<img src={tabStart} alt=\"\"/>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</>:<>\r\n\t\t\t\t\t\t\t<div className={sidebarMode==='note'?'active':''} onClick={()=>setSidebarMode('note')}>\r\n\t\t\t\t\t\t\t\t<img src={tabStart} alt=\"\"/>\r\n\t\t\t\t\t\t\t\t<div className=\"vertical-text px-4\">Notes <span className=\"h7\">\r\n\t\t\t\t\t\t\t\t\t{categorized['note'].length}\r\n\t\t\t\t\t\t\t\t</span></div>\r\n\t\t\t\t\t\t\t\t<img src={tabStart} alt=\"\"/>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t<div className={sidebarMode==='highlight'?'active':''} onClick={()=>setSidebarMode('highlight')}>\r\n\t\t\t\t\t\t\t\t<img src={tabStart} alt=\"\"/>\r\n\t\t\t\t\t\t\t\t<div className=\"vertical-text px-4\">Highlights <span className=\"h7\">\r\n\t\t\t\t\t\t\t\t\t{categorized['highlight'].length}\r\n\t\t\t\t\t\t\t\t</span></div>\r\n\t\t\t\t\t\t\t\t<img src={tabStart} alt=\"\"/>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</>}\r\n\t\t\t\t\t\t<span className=\"col\"/>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div className=\"col trim\">\r\n\t\t\t\t\t\t<Scrollbar disableTracksWidthCompensation>\r\n\t\t\t\t\t\t\t<div className=\"row spc-12 f-vert\">\r\n\t\t\t\t\t\t\t\t{filtered.map(c=><Comment key={c.id} {...{commentId: c.id}}/>)}\r\n\t\t\t\t\t\t\t\t<div style={{height: '100vh'}}/>\r\n\t\t\t\t\t\t\t\t<div className=\"col-ext-x col-ext-t pos-sty top-controls f-order-m1 f-vert\">\r\n\t\t\t\t\t\t\t\t\t{sidebarMode!=='highlight'?<div className=\"row spc-12 f-vert\">\r\n\t\t\t\t\t\t\t\t\t\t{publicPrivateMode==='public'?<SegmentControls value={+userFilter}>\r\n\t\t\t\t\t\t\t\t\t\t\t<div className=\"super-center capitalize\" onClick={()=>setUserFilter(false)}>All {sidebarMode}s</div>\r\n\t\t\t\t\t\t\t\t\t\t\t<div className=\"super-center capitalize\" onClick={()=>setUserFilter(true)}>My {sidebarMode}s</div>\r\n\t\t\t\t\t\t\t\t\t\t</SegmentControls>:undefined}\r\n\t\t\t\t\t\t\t\t\t\t<input type=\"text\" placeholder=\" &#xf002;  filter by hashtag\" onChange={e=>setPublicSearchString(e.target.value)}/>\r\n\t\t\t\t\t\t\t\t\t</div>:undefined}\r\n\t\t\t\t\t\t\t\t\t<div className=\"mx-auto pill mt-8 mb-m6 px-10 py-2 h7\">{filtered.length} results</div>\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</Scrollbar>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t</section>\r\n\t\t\t<Header>\r\n\t\t\t\t<div className=\"icon icon-arrow_left f-order-m1 super-center\" onClick={history.goBack}/>\r\n\t\t\t\t<div className=\"col\"/>\r\n\t\t\t\t<SegmentControls className=\"mr-12\" value={publicPrivateMode==='public'?1:0} style={{width: '200px'}}>\r\n\t\t\t\t\t<div className=\"super-center capitalize\" onClick={()=>setSidebarMode('note')}>Private</div>\r\n\t\t\t\t\t<div className=\"super-center capitalize\" onClick={()=>setSidebarMode('comment')}>Public</div>\r\n\t\t\t\t</SegmentControls>\r\n\t\t\t\t<div className=\"col-ext row spc-x-8\" style={{maxWidth: 'var(--rightSidebarWidth)'}}>\r\n\t\t\t\t\t<div className=\"col text-right mr-12 one-line\">\r\n\t\t\t\t\t\t<h5 className=\"col-12 b-700 one-line\">{book?book.title:'PageBook Title'}</h5>\r\n\t\t\t\t\t\t<div className=\"h7 text-muted one-line\">Group: {group?group.title:'Group Title'}</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div className=\"icon icon-refresh super-center\" onClick={refresh}/>\r\n\t\t\t\t</div>\r\n\t\t\t</Header>\r\n\t\t\t<Route path=\"*/thread/:id\" component={CommentThread}/>\r\n\t\t</div>\r\n\t)\r\n})\r\n\r\nexport let setBubblePos\r\nexport const NewCommentBubble=withRouter(function({location: {pathname},publicPrivateMode,selection,book}){\r\n\tconst {state,dispatch}=useContext(MainContext)\r\n\tconst {userId}=state\r\n\tlet bubblePos\r\n\t;[bubblePos,setBubblePos]=useState({})\r\n\treturn(\r\n\t\t<div className=\"new-bubble pos-abs f-end f-justify-center h7 pt-4\" style={bubblePos}>\r\n\t\t\t{publicPrivateMode==='public'?<>\r\n\t\t\t\t<Link to={pathname+'/new-comment'} className=\"py-4 px-8 text-right\" onClick={()=>setSidebarMode('question')}>Question</Link>\r\n\t\t\t\t<Link to={pathname+'/new-comment'} className=\"py-4 px-8\" onClick={()=>setSidebarMode('comment')}>Comment</Link>\r\n\t\t\t</>:<>\r\n\t\t\t\t<Link to={pathname+'/new-comment'} className=\"py-4 px-8 text-right\" onClick={()=>setSidebarMode('note')}>Note</Link>\r\n\t\t\t\t<div className=\"py-4 px-8\" onClick={addHighlight}>Highlight</div> {/* eslint-disable-line jsx-a11y/anchor-is-valid */}\r\n\t\t\t</>}\r\n\t\t</div>\r\n\t)\r\n\r\n\tfunction addHighlight(){\r\n\t\tsetSidebarMode('highlight')\r\n\t\tapi('post','comment/',{\r\n\t\t\tbody: 'Highlight',\r\n\t\t\thashtag: '',\r\n\t\t\tselection_data: JSON.stringify([selection]),\r\n\t\t\tuser: userId,\r\n\t\t\tbook: book.id,\r\n\t\t\ttypeof: 'highlight',\r\n\t\t}).then(({data})=>{\r\n\t\t\tbook.comment_set=[...book.comment_set,data.id] // TODO: Maybe optimize?\r\n\t\t\tdispatch(['SET_DATA',{comments: [data],books: [{...book}]}]) // TODO: Maybe optimize?\r\n\t\t\tsetSelection(undefined)\r\n\t\t\tsetBubblePos({})\r\n\t\t})\r\n\t}\r\n})\r\n","import React,{createRef} from 'react'\r\nimport _ from 'lodash'\r\nimport {Scrollbar} from 'react-scrollbars-custom'\r\n\r\nimport './PdfVerticalScroll.scss'\r\nimport {getChildNodeIndex,getSelectionOffsetFromParent,binarySearchFindClosestIndex} from '../../helper'\r\nimport {PdfImage,TextLayer} from '../../utils/PDFRenderer/PDFRenderer'\r\nimport MyComponent from '../MyComponent'\r\nimport {NewCommentBubble,setBubblePos,setSelection} from '../PageBook/PageBook'\r\n\r\n// TODO: Extra - PDF download progressbar\r\n// TODO: Extra - Password protected PDFs\r\n\r\nconst logLifecycle=true\r\n// TODO: Change back to functional component after removing componentWillUnmount()\r\n// TODO: PdfVerticalScrollInner for reducing renders\r\nexport default class PdfVerticalScroll extends MyComponent{\r\n\tstate={\r\n\t\tonScroll: ()=>{}\r\n\t}\r\n\r\n\tsetOnScroll=onScroll=>this.setState({onScroll})\r\n\r\n\trender(){\r\n\t\t// logLifecycle && console.log('PdfVerticalScroll render')\r\n\r\n\t\tconst {publicPrivateMode,selection,book,pdf,pageWiseComments}=this.props\r\n\t\tconst {setOnScroll}=this\r\n\t\tconst {onScroll}=this.state\r\n\r\n\t\treturn (\r\n\t\t\t<Scrollbar disableTracksWidthCompensation className=\"PdfVerticalScroll\" {...{onScroll}}>\r\n\t\t\t\t<PdfVerticalScrollInner {...{pdf,pageWiseComments,setOnScroll}}/>\r\n\t\t\t\t<NewCommentBubble {...{publicPrivateMode,selection,book}}/>\r\n\t\t\t</Scrollbar>\r\n\t\t)\r\n\t}\r\n\r\n\t// TODO: move componentWillUnmount to PageBook\r\n\tcomponentWillUnmount(){\r\n\t\tlogLifecycle && console.log('PdfVerticalScroll componentWillUnmount')\r\n\t\t// console.log(this.props.pdf.pdf.destroy)\r\n\t\tthis.props.pdf.pdf.destroy()\r\n\t}\r\n}\r\n\r\nclass PdfVerticalScrollInner extends MyComponent{\r\n\tconstructor(props){\r\n\t\tsuper(props)\r\n\t\tthis.ref=createRef()\r\n\t\tprops.setOnScroll(this.onScroll)\r\n\t}\r\n\r\n\tpageTops=[]\r\n\tpageBottoms=[]\r\n\tloaders=[]\r\n\trender(){\r\n\t\t// logLifecycle && console.log('PdfVerticalScrollInner render')\r\n\r\n\t\tconst {pdf,pageWiseComments}=this.props\r\n\t\tconst {onClick,ref,loaders}=this\r\n\t\treturn <div className=\"row f-center f-vert p-6\" {...{onClick,ref}}>\r\n\t\t\t{pdf?.pages?.map((page,i)=>{\r\n\t\t\t\tconst viewport=pdf.viewports[i]\r\n\t\t\t\treturn <div className=\"p-6\" key={page._pageIndex}>\r\n\t\t\t\t\t<div className=\"card pos-rel f-super-center trim page\" style={_.pick(viewport,['width','height'])} data-page-index={i}>\r\n\t\t\t\t\t\t<Page {...{page,viewport,i,pageComments: pageWiseComments[i],loaders}}/>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t})}\r\n\t\t</div>\r\n\t}\r\n\r\n\tcomponentDidMount(){\r\n\t\t// logLifecycle && console.log('PdfVerticalScrollInner componentDidMount')\r\n\t\tif(this.props.pdf) this.onPdfLoad()\r\n\t}\r\n\r\n\tcomponentDidUpdate(prevProps){\r\n\t\t// logLifecycle && console.log('PdfVerticalScrollInner componentDidUpdate')\r\n\t\tif(prevProps.pdf!==this.props.pdf && this.props.pdf) this.onPdfLoad()\r\n\t\tObject.keys(this.props).forEach(p=>{if(prevProps[p]!==this.props[p]) console.log('PdfVerticalScrollInner props '+p)})\r\n\t}\r\n\r\n\tonPdfLoad(){\r\n\t\tlogLifecycle && console.log('PdfVerticalScrollInner onPdfLoad')\r\n\r\n\t\tconst pageEles=this.ref.current.children\r\n\t\tthis.pageTops=[]\r\n\t\tthis.pageBottoms=[]\r\n\t\tfor(let i=0;i<pageEles.length;++i){\r\n\t\t\tconst {offsetTop,offsetHeight}=pageEles[i]\r\n\t\t\tthis.pageTops[i]=offsetTop\r\n\t\t\tthis.pageBottoms[i]=offsetTop+offsetHeight\r\n\t\t}\r\n\t\tthis.ref.current.closest('.ScrollbarsCustom-Scroller').scrollTo(0,1)\r\n\t\tconsole.log(this.loaders)\r\n\t}\r\n\r\n\tprevTopPage\r\n\tprevBottomPage\r\n\tonScroll=e=>{\r\n\t\t// One page look ahead\r\n\t\t// const topOffset=e.scrollTop\r\n\t\t// const bottomOffset=e.scrollTop+e.clientHeight\r\n\r\n\t\t// Two page look ahead\r\n\t\tconst topOffset=e.scrollTop-e.clientHeight\r\n\t\tconst bottomOffset=e.scrollTop+(e.clientHeight<<1)\r\n\r\n\t\tconst lastPageNum=this.pageBottoms.length-1\r\n\r\n\t\tlet topPage=binarySearchFindClosestIndex(this.pageBottoms,topOffset)\r\n\t\tif(topOffset<this.pageBottoms[topPage]) topPage=Math.max(--topPage,0) // Lowerbound\r\n\t\tlet bottomPage=binarySearchFindClosestIndex(this.pageTops,bottomOffset)\r\n\t\tif(bottomOffset>this.pageTops[bottomPage]) bottomPage=Math.min(++bottomPage,lastPageNum) // Upperbound\r\n\t\t// console.log({topPage,bottomPage})\r\n\r\n\t\tif(this.prevTopPage===undefined && this.prevBottomPage===undefined){\r\n\t\t\tfor(let i=topPage;i<=bottomPage;++i) this.loaders[i](true)\r\n\t\t\tthis.prevTopPage=topPage\r\n\t\t\tthis.prevBottomPage=bottomPage\r\n\t\t}\r\n\t\tif(this.prevTopPage!==topPage){\r\n\t\t\tfor(let i=topPage-1;i>=this.prevTopPage;--i) this.loaders[i](false)\r\n\t\t\tfor(let i=topPage;i<=this.prevTopPage;++i) this.loaders[i](true)\r\n\t\t\t// console.log({topPage})\r\n\t\t\tthis.prevTopPage=topPage\r\n\t\t}\r\n\t\tif(this.prevBottomPage!==bottomPage){\r\n\t\t\tfor(let i=bottomPage+1;i<=this.prevBottomPage;++i) this.loaders[i](false)\r\n\t\t\tfor(let i=bottomPage;i>=this.prevBottomPage;--i) this.loaders[i](true)\r\n\t\t\t// console.log({bottomPage})\r\n\t\t\tthis.prevBottomPage=bottomPage\r\n\t\t}\r\n\t}\r\n\r\n\tonClick=()=>{\r\n\t\ttry{\r\n\t\t\tconst s=window.getSelection()\r\n\t\t\tif(s.toString()==='') throw new Error('No text selected')\r\n\t\t\tlet {anchorNode,focusNode}=s\r\n\t\t\twhile(!anchorNode.closest) anchorNode=anchorNode.parentNode\r\n\t\t\twhile(!focusNode.closest) focusNode=focusNode.parentNode\r\n\r\n\t\t\tconst anchorNodeSpan=anchorNode.closest('span')\r\n\t\t\tconst focusNodeSpan=focusNode.closest('span')\r\n\t\t\tlet selection={\r\n\t\t\t\tstartPage:   +anchorNode.closest('.page').dataset.pageIndex,\r\n\t\t\t\tstartLine:   getChildNodeIndex(anchorNodeSpan),\r\n\t\t\t\tstartOffset: getSelectionOffsetFromParent(anchorNode,anchorNodeSpan,s.anchorOffset),\r\n\t\t\t\tendPage:     +focusNode.closest('.page').dataset.pageIndex,\r\n\t\t\t\tendLine:     getChildNodeIndex(focusNodeSpan),\r\n\t\t\t\tendOffset:   getSelectionOffsetFromParent(focusNode,focusNodeSpan,s.focusOffset),\r\n\t\t\t}\r\n\r\n\t\t\t// if selection is in reverse order, swap selection start and end\r\n\t\t\tif(\r\n\t\t\t\tselection.endPage<selection.startPage ||       // eslint-disable-line no-mixed-operators\r\n\t\t\t\tselection.endPage===selection.startPage && (   // eslint-disable-line no-mixed-operators\r\n\t\t\t\t\tselection.endLine<selection.startLine ||     // eslint-disable-line no-mixed-operators\r\n\t\t\t\t\tselection.endLine===selection.startLine && ( // eslint-disable-line no-mixed-operators\r\n\t\t\t\t\t\tselection.endOffset<selection.startOffset  // eslint-disable-line no-mixed-operators\r\n\t\t\t\t\t)\r\n\t\t\t\t)\r\n\t\t\t){\r\n\t\t\t\tselection={\r\n\t\t\t\t\tstartPage:   selection.endPage,\r\n\t\t\t\t\tstartLine:   selection.endLine,\r\n\t\t\t\t\tstartOffset: selection.endOffset,\r\n\t\t\t\t\tendPage:     selection.startPage,\r\n\t\t\t\t\tendLine:     selection.startLine,\r\n\t\t\t\t\tendOffset:   selection.startOffset,\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tconst pagesDOM=Array.from(this.ref.current.children).slice(\r\n\t\t\t\tselection.startPage,\r\n\t\t\t\tselection.endPage+1,\r\n\t\t\t)\r\n\t\t\tif(pagesDOM.length===1){\r\n\t\t\t\tselection=[{\r\n\t\t\t\t\tpage:        selection.startPage,\r\n\t\t\t\t\tstartLine:   selection.startLine,\r\n\t\t\t\t\tstartOffset: selection.startOffset,\r\n\t\t\t\t\tendLine:     selection.endLine,\r\n\t\t\t\t\tendOffset:   selection.endOffset,\r\n\t\t\t\t}]\r\n\t\t\t}else{\r\n\t\t\t\tthrow new Error('Multi-page selection disabled')\r\n\t\t\t\tconst startPage=pagesDOM.shift()\r\n\t\t\t\tconst startPageLines=startPage.children[1].children\r\n\t\t\t\tconst startPageLastLine=Array.from(startPageLines).pop()\r\n\t\t\t\t/*const lastPage=*/pagesDOM.pop()\r\n\t\t\t\tselection=[\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tpage:        selection.startPage,\r\n\t\t\t\t\t\tstartLine:   selection.startLine,\r\n\t\t\t\t\t\tstartOffset: selection.startOffset,\r\n\t\t\t\t\t\tendLine:     startPageLines.length-1,\r\n\t\t\t\t\t\tendOffset:   startPageLastLine.innerText.length,\r\n\t\t\t\t\t},\r\n\t\t\t\t\t...pagesDOM.map((page,i)=>{\r\n\t\t\t\t\t\tconst pageLines=page.children[1].children\r\n\t\t\t\t\t\tconst pageLastLine=Array.from(pageLines).pop()\r\n\t\t\t\t\t\treturn {\r\n\t\t\t\t\t\t\tpage: selection.startPage+i+1,\r\n\t\t\t\t\t\t\tstartLine:   0,\r\n\t\t\t\t\t\t\tstartOffset: 0,\r\n\t\t\t\t\t\t\tendLine:     pageLines.length-1,\r\n\t\t\t\t\t\t\tendOffset:   pageLastLine.innerText.length,\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}),\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tpage:        selection.endPage,\r\n\t\t\t\t\t\tstartLine:   0,\r\n\t\t\t\t\t\tstartOffset: 0,\r\n\t\t\t\t\t\tendLine:     selection.endLine,\r\n\t\t\t\t\t\tendOffset:   selection.endOffset,\r\n\t\t\t\t\t},\r\n\t\t\t\t]\r\n\t\t\t}\r\n\r\n\t\t\tconst focusNodeClientRect=focusNode.getBoundingClientRect()\r\n\t\t\tconst scrollNode=focusNode.closest('.ScrollbarsCustom-Scroller')\r\n\r\n\t\t\tconsole.log(selection)\r\n\t\t\tsetSelection({\r\n\t\t\t\ttype: 'text',\r\n\t\t\t\ttext: s.toString(),\r\n\t\t\t\tdata: selection,\r\n\t\t\t})\r\n\t\t\tsetBubblePos({\r\n\t\t\t\ttop: focusNodeClientRect.top+focusNodeClientRect.height+scrollNode.scrollTop,\r\n\t\t\t\t// left: focusNodeClientRect.left+focusNodeClientRect.width\r\n\t\t\t})\r\n\t\t}catch(e){\r\n\t\t\tconsole.log(e)\r\n\t\t\t// TODO: reset selection\r\n\t\t\tsetSelection(undefined)\r\n\t\t\tsetBubblePos({})\r\n\t\t}\r\n\t}\r\n}\r\n\r\nclass Page extends MyComponent{\r\n\tstate={\r\n\t\tloaded: false\r\n\t}\r\n\tsetLoaded=loaded=>this.setState({loaded})\r\n\r\n\tconstructor(props){\r\n\t\tsuper(props)\r\n\t\tprops.loaders[props.i]=this.setLoaded\r\n\t}\r\n\r\n\trender(){\r\n\t\t// logLifecycle && console.log('Page render')\r\n\t\tconst {page,viewport,pageComments}=this.props\r\n\t\treturn this.state.loaded?<>\r\n\t\t\t<PdfImage {...{page,viewport}}/>\r\n\t\t\t<TextLayer {...{page,viewport,pageComments}}/>\r\n\t\t</>:null\r\n\t}\r\n}","import React from 'react'\r\nimport {withRouter} from 'react-router-dom'\r\n\r\nimport './NewQuestionComment.scss'\r\nimport MyComponent from '../MyComponent'\r\nimport {MainContext,nonAlphaNumericRegex,api} from '../../contexts/MainContext'\r\n\r\nconst initState=JSON.stringify({\r\n\tbody: '',\r\n\thashtag: '',\r\n})\r\nexport default withRouter(class NewQuestionComment extends MyComponent{\r\n\tstatic contextType=MainContext\r\n\tstate=JSON.parse(initState)\r\n\r\n\tonSubmit=e=>{\r\n\t\te.preventDefault()\r\n\r\n\t\tconst {sidebarMode,selection,book,history}=this.props\r\n\t\tconst {body,hashtag}=this.state\r\n\t\tconst {userId}=this.context.state\r\n\r\n\t\tapi('post','comment/',{\r\n\t\t\tbody,\r\n\t\t\thashtag: hashtag.replace(nonAlphaNumericRegex,'').trim(),\r\n\t\t\tselection_data: JSON.stringify([selection]),\r\n\t\t\tuser: userId,\r\n\t\t\tbook: book.id,\r\n\t\t\ttypeof: sidebarMode,\r\n\t\t}).then(({data})=>{\r\n\t\t\tbook.comment_set=[...book.comment_set,data.id] // TODO: Maybe optimize?\r\n\t\t\tthis.context.dispatch(['SET_DATA',{comments: [data],books: [{...book}]}]) // TODO: Maybe optimize?\r\n\t\t\t// TODO: resetSelection\r\n\t\t\thistory.goBack()\r\n\t\t})\r\n\t}\r\n\r\n\trender(){\r\n\t\tconst {onSubmit}=this\r\n\t\tconst {sidebarMode,history,selection}=this.props\r\n\t\tconsole.log(selection)\r\n\r\n\t\treturn (\r\n\t\t\t<div className=\"NewQuestionComment modal active pos-abs stretch-to-fit p-12 f-end f-justify-center\" style={{}}>\r\n\t\t\t\t<form className=\"row spc-12\" style={{width: '480px'}} {...{onSubmit}}>\r\n\t\t\t\t\t<div className=\"close-btn\" onClick={history.goBack}/>\r\n\t\t\t\t\t<div className=\"capitalize\">New {sidebarMode}</div>\r\n\t\t\t\t\t<blockquote className=\"col-12 h7 text-muted mt-2 row\">\r\n\t\t\t\t\t\t<div className=\"trim-y col\">{selection?.text}</div>\r\n\t\t\t\t\t</blockquote>\r\n\t\t\t\t\t<textarea required className=\"col-12\" placeholder={sidebarMode} {...this.twoWayBind('body')}/>\r\n\t\t\t\t\t<div className=\"col-12\"/>\r\n\t\t\t\t\t<div className=\"bottom-row col-12 col-ext row spc-12\">\r\n\t\t\t\t\t\t<input className=\"col\" type=\"text\" placeholder=\"#Hashtag\" {...this.twoWayBind('hashtag')}/>\r\n\t\t\t\t\t\t<button>Post</button>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</form>\r\n\t\t\t</div>\r\n\t\t)\r\n\t}\r\n})\r\n","import React from 'react'\r\nimport _ from 'lodash'\r\n\r\nimport './PageLogin.scss'\r\nimport SegmentControls from '../../utils/SegmentControls/SegmentControls'\r\nimport MyComponent from '../MyComponent'\r\nimport {MainContext,api} from '../../contexts/MainContext'\r\nimport Spinner from '../../utils/Spinner/Spinner'\r\nimport {setAlert} from '../../utils/Alert/Alert'\r\n\r\n// TODO: autocomplete\r\nconst initState=JSON.stringify({\r\n\tmode: 0,\r\n\tshowSpinner: false,\r\n})\r\nexport default class PageLogin extends MyComponent{\r\n\tstatic contextType=MainContext\r\n\tstate=JSON.parse(initState)\r\n\r\n\tlogin=async e=>{\r\n\t\te.preventDefault()\r\n\t\tthis.setState({showSpinner: true})\r\n\r\n\t\ttry{\r\n\t\t\tconst loginResponse=await api('post','login',_.pick(this.state,['email','password']))\r\n\t\t\tthis.context.dispatch(['LOGIN',loginResponse.data])\r\n\t\t}finally{this.setState({showSpinner: false})}\r\n\t}\r\n\r\n\tsignUp=async e=>{\r\n\t\te.preventDefault()\r\n\t\tthis.setState({showSpinner: true})\r\n\r\n\t\ttry{\r\n\t\t\tawait api('post','register',_.pick(this.state,['email']))\r\n\t\t\tthis.setState(JSON.parse(initState))\r\n\t\t\tsetAlert(<div className=\"row spc-12\" style={{maxWidth: '320px'}}>\r\n\t\t\t\t<div className=\"col-12 h5\">&#x2713; Email Sent</div>\r\n\t\t\t\t<div className=\"col-12 h7 text-muted\">\r\n\t\t\t\t\tWe just sent an email to <b className=\"text-unmuted\">{this.state.email}</b>.\r\n\t\t\t\t\tCheck your email to complete your sign-up!\r\n\t\t\t\t\t<br/><br/>\r\n\t\t\t\t\tIf you did not receive any emails from us, don't forget to check your spam folder!\r\n\t\t\t\t</div>\r\n\t\t\t\t<div className=\"bottom-row col-ext-x col-ext-b col-12 row spc-x-12 spc-y-8 f-justify-end\">\r\n\t\t\t\t\t<button onClick={()=>setAlert()}>OK</button>\r\n\t\t\t\t</div>\r\n\t\t\t</div>)\r\n\t\t}finally{this.setState({showSpinner: false})}\r\n\t}\r\n\r\n\trender(){\r\n\t\tconst {login,signUp}=this\r\n\t\tconst {location,history}=this.props\r\n\t\tconst {mode,showSpinner}=this.state\r\n\t\tconst {version}=this.context.state\r\n\r\n\t\tif(localStorage.getItem('activeUserId')) // If logged in, bypass login screen\r\n\t\t\thistory.replace(location.pathname.replace('/login',''))\r\n\r\n\t\treturn (\r\n\t\t\t<div id=\"PageLogin\" className=\"pos-abs stretch-to-fit\">\r\n\t\t\t\t<div className=\"container row p-32\">\r\n\t\t\t\t\t<div className=\"col\">\r\n\t\t\t\t\t\t<h1 className=\"heading py-32\">\r\n\t\t\t\t\t\t\tBBBook<sup className=\"h7 normal-caps ml-8\" style={{height: 'auto'}}>Pre-Alpha {version}</sup>\r\n\t\t\t\t\t\t</h1>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div className=\"card row spc-16 f-vert pos-rel\" style={{width: '360px'}}>\r\n\t\t\t\t\t\t<SegmentControls value={mode}>\r\n\t\t\t\t\t\t\t<div className=\"super-center\" onClick={()=>this.setState({mode: 0})}>Log In</div>\r\n\t\t\t\t\t\t\t<div className=\"super-center\" onClick={()=>this.setState({mode: 1})}>Sign up</div>\r\n\t\t\t\t\t\t</SegmentControls>\r\n\t\t\t\t\t\t{mode===0?\r\n\t\t\t\t\t\t\t<form className=\"row spc-16 f-vert col col-ext pos-rel trim\" onSubmit={login}>\r\n\t\t\t\t\t\t\t\t<div>\r\n\t\t\t\t\t\t\t\t\t<h1>Log In</h1>\r\n\t\t\t\t\t\t\t\t\t<div className=\"h7 text-muted\">Enter the BBBook portal.</div>\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t<div className=\"col\"/>\r\n\t\t\t\t\t\t\t\t<label required className=\"h7 my-0\">Email</label>\r\n\t\t\t\t\t\t\t\t<input required {...this.twoWayBind('email')} name=\"email\" type=\"email\"/>\r\n\t\t\t\t\t\t\t\t<label required className=\"h7 my-0\">Password</label>\r\n\t\t\t\t\t\t\t\t<input required {...this.twoWayBind('password')} name=\"password\" type=\"password\"/>\r\n\t\t\t\t\t\t\t\t{/*<Link className=\"button super-center\" to=\"/dashboard\">Log In</Link>*/}\r\n\t\t\t\t\t\t\t\t<div className=\"bottom-row col-ext-x col-ext-b text-right row f-vert spc-x-16 spc-y-12\">\r\n\t\t\t\t\t\t\t\t\t<button>Log In</button>\r\n\t\t\t\t\t\t\t\t\t<hr className=\"col-ext-x\"/>\r\n\t\t\t\t\t\t\t\t\t<div className=\"h7 text-right my-2\" onClick={()=>this.setState({mode: 1})}>New to BBBook? Sign up!</div>\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t</form>\r\n\t\t\t\t\t\t\t:<form className=\"row spc-16 f-vert col col-ext pos-rel trim\" onSubmit={signUp}>\r\n\t\t\t\t\t\t\t\t<div>\r\n\t\t\t\t\t\t\t\t\t<h1>Sign Up</h1>\r\n\t\t\t\t\t\t\t\t\t<div className=\"h7 text-muted\">Enter the BBBook portal.</div>\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t<div className=\"col\"/>\r\n\t\t\t\t\t\t\t\t<label required className=\"h7 my-0\">Email</label>\r\n\t\t\t\t\t\t\t\t<input required {...this.twoWayBind('email')} name=\"email\" type=\"email\"/>\r\n\t\t\t\t\t\t\t\t{/*<Link className=\"button super-center\" to=\"/dashboard\">Sign Up</Link>*/}\r\n\t\t\t\t\t\t\t\t<div className=\"bottom-row col-ext-x col-ext-b text-right row f-vert spc-x-16 spc-y-12\">\r\n\t\t\t\t\t\t\t\t\t<button>Sign Up</button>\r\n\t\t\t\t\t\t\t\t\t<hr className=\"col-ext-x\"/>\r\n\t\t\t\t\t\t\t\t\t<div className=\"h7 text-right my-2\" onClick={()=>this.setState({mode: 0})}>Have an account? PageLogin in!</div>\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t</form>\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t\t<Spinner {...{className: showSpinner?'active':''}}/>\r\n\t\t\t</div>\r\n\t\t)\r\n\t}\r\n}\r\n","import React,{useContext,useEffect} from 'react'\r\nimport {Link,withRouter} from 'react-router-dom'\r\nimport {Scrollbar} from 'react-scrollbars-custom'\r\n\r\nimport './PageGroups.scss'\r\nimport Header from '../Header/Header'\r\nimport {MainContext,api} from '../../contexts/MainContext'\r\nimport Group from '../Group/Group'\r\n\r\nexport default withRouter(function PageGroups({location}){\r\n\tconst {state,dispatch}=useContext(MainContext)\r\n\tuseEffect(refresh,[location.pathname])\r\n\tconst user=state.USERS[state.userId]\r\n\r\n\tfunction refresh(){\r\n\t\tif(!state.userId) return\r\n\t\tapi('get','dashboard/'+state.userId).then(({data})=>{\r\n\t\t\tdispatch(['SET_DATA',data])\r\n\t\t}).catch(console.error)\r\n\t}\r\n\r\n\treturn (\r\n\t\t<div id=\"PageGroups\">\r\n\t\t\t<Scrollbar disableTracksWidthCompensation className=\"pos-abs stretch-to-fit\">\r\n\t\t\t\t<div className=\"f-vert\">\r\n\t\t\t\t\t<div className=\"container\">\r\n\t\t\t\t\t\t{(user?.joined_groups || []).map(groupId=>{\r\n\t\t\t\t\t\t\tconst group=state.GROUPS[groupId]\r\n\t\t\t\t\t\t\treturn group?(\r\n\t\t\t\t\t\t\t\t<Group {...{key:groupId,group}}/>\r\n\t\t\t\t\t\t\t):undefined\r\n\t\t\t\t\t\t})}\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<Header>\r\n\t\t\t\t\t\t<div className=\"col\"/>\r\n\t\t\t\t\t\t<div className=\"icon icon-refresh super-center\" onClick={refresh}/>\r\n\t\t\t\t\t</Header>\r\n\t\t\t\t</div>\r\n\t\t\t</Scrollbar>\r\n\t\t\t<Link className=\"button f-center f-horz-rev pos-abs create-group-btn p-0\" to={location.pathname+'/edit-group/0'}>\r\n\t\t\t\t<i className=\"fa fa-plus super-center h5\"/>\r\n\t\t\t\t<div className=\"super-center pl-24 pr-12 one-line\">Create Group</div>\r\n\t\t\t</Link>\r\n\t\t</div>\r\n\t)\r\n})\r\n","import React,{createRef} from 'react'\r\n// import _ from 'lodash'\r\nimport {Scrollbar} from 'react-scrollbars-custom'\r\n\r\nimport './PageRegister.scss'\r\nimport MyComponent from '../MyComponent'\r\nimport {MainContext,/*api*/} from '../../contexts/MainContext'\r\nimport Spinner from '../../utils/Spinner/Spinner'\r\n// import {setAlert} from '../../utils/Alert/Alert'\r\n\r\nconst initState=JSON.stringify({\r\n\tshowSpinner: false,\r\n})\r\nexport default class PageRegister extends MyComponent{\r\n\tstatic contextType=MainContext\r\n\tstate=JSON.parse(initState)\r\n\r\n\tconstructor(props){\r\n\t\tsuper(props)\r\n\t\tthis.ref=createRef()\r\n\t}\r\n\r\n\tcomponentDidMount=()=>{\r\n\t\tconst refEle=this.ref.current.holderElement\r\n\t\tconsole.log(refEle.querySelector('form').style.minHeight=refEle.offsetHeight+'px')\r\n\t}\r\n\r\n\t// TODO: Regex\r\n\t// TODO: autocomplete\r\n\t// TODO: change-password URL\r\n\t// TODO: https://web.dev/sign-up-form-best-practices/\r\n\trender(){\r\n\t\tconst {ref}=this\r\n\t\tconst {showSpinner,email}=this.state\r\n\t\tconst {version}=this.context.state\r\n\t\treturn (\r\n\t\t\t<div id=\"PageRegister\" className=\"pos-abs stretch-to-fit\">\r\n\t\t\t\t<div className=\"container row p-32\">\r\n\t\t\t\t\t<div className=\"col\">\r\n\t\t\t\t\t\t<h1 className=\"heading py-32\">\r\n\t\t\t\t\t\t\tBBBook<sup className=\"h7 normal-caps ml-8\" style={{height: 'auto'}}>Pre-Alpha {version}</sup>\r\n\t\t\t\t\t\t</h1>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<Scrollbar disableTracksWidthCompensation className=\"card\" style={{width: '360px'}} {...{ref}}>\r\n\t\t\t\t\t\t<form className=\"row spc-16 f-vert col col-ext pos-rel trim\">\r\n\t\t\t\t\t\t\t<div>\r\n\t\t\t\t\t\t\t\t<h1>Sign Up</h1>\r\n\t\t\t\t\t\t\t\t<div className=\"h7 text-muted\">Complete your details.</div>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t<div className=\"col\"/>\r\n\t\t\t\t\t\t\t<label className=\"h7 my-0\">Email</label>\r\n\t\t\t\t\t\t\t<input required readOnly name=\"email\" type=\"email\" value={email}/>\r\n\t\t\t\t\t\t\t<label required className=\"h7 my-0\">Username</label>\r\n\t\t\t\t\t\t\t<input required {...this.twoWayBind('username')} name=\"username\" type=\"text\"/>\r\n\t\t\t\t\t\t\t<label required className=\"h7 my-0\">First Name</label>\r\n\t\t\t\t\t\t\t<input required {...this.twoWayBind('first_name')} name=\"first_name\" type=\"text\"/>\r\n\t\t\t\t\t\t\t<label required className=\"h7 my-0\">Last Name</label>\r\n\t\t\t\t\t\t\t<input required {...this.twoWayBind('last_name')} name=\"last_name\" type=\"text\"/>\r\n\t\t\t\t\t\t\t<label required className=\"h7 my-0\">Password</label>\r\n\t\t\t\t\t\t\t<input required {...this.twoWayBind('password')} name=\"password\" type=\"password\"/>\r\n\t\t\t\t\t\t\t<label required className=\"h7 my-0\">Confirm Password</label>\r\n\t\t\t\t\t\t\t<input required {...this.twoWayBind('password_2')} name=\"password_2\" type=\"password\"/>\r\n\t\t\t\t\t\t\t<label required className=\"h7 my-0\">Date of Birth</label>\r\n\t\t\t\t\t\t\t<input required {...this.twoWayBind('birth_date')} name=\"birth_date\" type=\"date\"/>\r\n\t\t\t\t\t\t\t<label className=\"h7 my-0\">Bio</label>\r\n\t\t\t\t\t\t\t<textarea {...this.twoWayBind('bio')} name=\"bio\"/>\r\n\t\t\t\t\t\t\t{/* TODO: Avatar\t*/}\r\n\t\t\t\t\t\t\t<div className=\"bottom-row col-ext-x col-ext-b text-right row f-vert spc-x-16 spc-y-12\">\r\n\t\t\t\t\t\t\t\t<button>Complete</button>\r\n\t\t\t\t\t\t\t\t{/*<hr className=\"col-ext-x\"/>\r\n\t\t\t\t\t\t\t\t<div className=\"h7 text-right my-2\" onClick={()=>this.setState({mode: 1})}>New to BBBook? Sign up!</div>*/}\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</form>\r\n\t\t\t\t\t</Scrollbar>\r\n\t\t\t\t</div>\r\n\t\t\t\t<Spinner {...{className: showSpinner?'active':''}}/>\r\n\t\t\t</div>\r\n\t\t)\r\n\t}\r\n}\r\n","import React from 'react'\r\nimport {Link} from 'react-router-dom'\r\nimport _ from 'lodash'\r\nimport {Scrollbar} from 'react-scrollbars-custom'\r\n\r\nimport './ModalEditGroup.scss'\r\nimport MyComponent from '../MyComponent'\r\nimport SegmentControls from '../../utils/SegmentControls/SegmentControls'\r\nimport {MainContext,api} from '../../contexts/MainContext'\r\nimport Spinner from '../../utils/Spinner/Spinner'\r\n\r\n// TODO: Admin revoked - alert\r\n// TODO: ManageUsers Component\r\nexport default class ModalEditGroup extends MyComponent{\r\n\tstatic contextType=MainContext\r\n\t// TODO: Take it outside state\r\n\tstate={\r\n\t\tpublicPrivate: 1,\r\n\t\tlinkSharing: 1,\r\n\t\tshowSpinner: false,\r\n\t}\r\n\tadmins={}\r\n\r\n\trender(){\r\n\t\tconst {onSubmit,admins}=this\r\n\t\tconst {location,history}=this.props\r\n\t\tconst {publicPrivate,linkSharing,showSpinner}=this.state\r\n\t\tconst {id}=this.props.match.params\r\n\t\tconst {userId,GROUPS,USERS}=this.context.state\r\n\t\tconst group=GROUPS[id]\r\n\r\n\t\tif(!userId) return null\r\n\t\tif(id!=='0'){\r\n\t\t\tif(!group) return null\r\n\t\t\tif(this.state.id!==id) this.groupTypeToState(group)\r\n\t\t}\r\n\r\n\t\tconst manageUsersMode=location.pathname.indexOf('/edit-group-users')!==-1\r\n\t\treturn (\r\n\t\t\t<div id=\"ModalEditGroup\" className=\"modal active\">\r\n\t\t\t\t<form className={manageUsersMode?'expanded':''} {...{onSubmit}}>\r\n\t\t\t\t\t<div className=\"row spc-12\">\r\n\t\t\t\t\t\t<h3 className=\"col\">{id==='0'?'New':'Edit'} Group</h3>\r\n\t\t\t\t\t\t{/* TODO: Show group details in manageUsersMode */}\r\n\t\t\t\t\t\t{/*<div><button className=\"outline\" style={{width: '68px',height: '68px',marginBottom: '-45px'}}/></div>*/}\r\n\t\t\t\t\t\t<hr className=\"col-12 col-ext-x col-ext-b\"/>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t{!manageUsersMode?\r\n\t\t\t\t\t\t<div className=\"row spc-12\">\r\n\t\t\t\t\t\t\t<div className=\"col\">\r\n\t\t\t\t\t\t\t\t<label required className=\"h7 mb-4\">Group Name</label>\r\n\t\t\t\t\t\t\t\t<input required className=\"col-12\" type=\"text\" {...this.twoWayBind('title')}/>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t<div className=\"col-12\">\r\n\t\t\t\t\t\t\t\t<label className=\"h7 mb-4\">Group Description</label>\r\n\t\t\t\t\t\t\t\t<textarea className=\"col-12\" {...this.twoWayBind('bio')}/>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t<div className=\"col-6\">\r\n\t\t\t\t\t\t\t\t<label className=\"h7 mb-4\">Group Privacy</label>\r\n\t\t\t\t\t\t\t\t<SegmentControls value={publicPrivate}>\r\n\t\t\t\t\t\t\t\t\t<div className=\"super-center\" onClick={()=>this.setState({publicPrivate: 0,linkSharing: 0})}>Public</div>\r\n\t\t\t\t\t\t\t\t\t<div className=\"super-center\" onClick={()=>this.setState({publicPrivate: 1})}>Private</div>\r\n\t\t\t\t\t\t\t\t</SegmentControls>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t<div className=\"col-6\">\r\n\t\t\t\t\t\t\t\t<label className=\"h7 mb-4\" disabled={publicPrivate===0}>Invite via Link</label>\r\n\t\t\t\t\t\t\t\t<SegmentControls value={linkSharing} disabled={publicPrivate===0}>\r\n\t\t\t\t\t\t\t\t\t<div className=\"super-center\" onClick={()=>this.setState({linkSharing: 0})}>Enabled</div>\r\n\t\t\t\t\t\t\t\t\t<div className=\"super-center\" onClick={()=>this.setState({linkSharing: 1})}>Disabled</div>\r\n\t\t\t\t\t\t\t\t</SegmentControls>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t{/* TODO: Green accent for link sharing enabled */}\r\n\t\t\t\t\t\t\t{id!=='0'?<div className=\"col-12 f-vert\">\r\n\t\t\t\t\t\t\t\t<label className=\"h7 mb-4\">Link</label>\r\n\t\t\t\t\t\t\t\t<Link\r\n\t\t\t\t\t\t\t\t\tto={'/groups/group/'+id}\r\n\t\t\t\t\t\t\t\t\ttarget=\"_blank\"\r\n\t\t\t\t\t\t\t\t\tclassName=\"col-12 button outline d-block one-line\"\r\n\t\t\t\t\t\t\t\t\ttype=\"text\" {...this.twoWayBind('title')}>\r\n\t\t\t\t\t\t\t\t\t{window.location.origin+'/#/groups/group/'+id}\r\n\t\t\t\t\t\t\t\t</Link>\r\n\t\t\t\t\t\t\t\t<div className=\"button ml-auto h7 mt-6\" style={{height: 'auto'}}>Copy Link</div>\r\n\t\t\t\t\t\t\t</div>:undefined}\r\n\t\t\t\t\t\t</div>:\r\n\t\t\t\t\t\t<Scrollbar disableTracksWidthCompensation style={{height: 'calc(100% - 114px)'}}>\r\n\t\t\t\t\t\t\t<div className=\"row spc-12 container\">\r\n\t\t\t\t\t\t\t\t<div className=\"col-12 row f-center\">\r\n\t\t\t\t\t\t\t\t\tAdmins <hr className=\"col ml-16\"/>\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t<div className=\"col-12 row f-center f-order-1\">\r\n\t\t\t\t\t\t\t\t\tUsers <hr className=\"col ml-16\"/>\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t{group.users.map(u=>{\r\n\t\t\t\t\t\t\t\t\tconst user=USERS[u]\r\n\t\t\t\t\t\t\t\t\treturn user?<div key={u} className={'card col-3 row spc-12 f-center'+(admins[u]?'':' f-order-1')}>\r\n\t\t\t\t\t\t\t\t\t\t<img\r\n\t\t\t\t\t\t\t\t\t\t\tclassName=\"card col-ext-y col-ext-l\"\r\n\t\t\t\t\t\t\t\t\t\t\tsrc={require('../../assets/imgs/default-profile-icon.jpg')}\r\n\t\t\t\t\t\t\t\t\t\t\tstyle={{width: '61px',height: '61px',borderRadius: '8px 0 0 8px'}}\r\n\t\t\t\t\t\t\t\t\t\t\talt=\"user profile pic\"/>\r\n\t\t\t\t\t\t\t\t\t\t<div className=\"col one-line\">\r\n\t\t\t\t\t\t\t\t\t\t\t{user.first_name || 'First Name'} {user.last_name || 'Last Name'}\r\n\t\t\t\t\t\t\t\t\t\t\t<div className=\"h7 text-muted mt-2\">@{user.username} | {user.email}</div>\r\n\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t</div>:undefined\r\n\t\t\t\t\t\t\t\t})}\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</Scrollbar>\r\n\t\t\t\t\t}\r\n\t\t\t\t\t<div className=\"bottom-row col-12 col-ext row spc-12\">\r\n\t\t\t\t\t\t{(id!=='0' && !manageUsersMode)?<>\r\n\t\t\t\t\t\t\t<Link\r\n\t\t\t\t\t\t\t\tto={location.pathname+'/edit-group-users'}\r\n\t\t\t\t\t\t\t\tclassName=\"button super-center\">Manage Users</Link>\r\n\t\t\t\t\t\t\t<div className=\"f-self-center h7\">\r\n\t\t\t\t\t\t\t\t<i className=\"icon icon-users\"/> {group?.users.length}\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</>:undefined}\r\n\t\t\t\t\t\t<div className=\"col\"/>\r\n\t\t\t\t\t\t<div className=\"button outline super-center\" onClick={history.goBack}>Cancel</div>\r\n\t\t\t\t\t\t<button>{id==='0'?'Create Group':'Save'}</button>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<Spinner className={showSpinner?'active':''}/>\r\n\t\t\t\t\t<div className=\"close-btn\" onClick={history.goBack}/>\r\n\t\t\t\t</form>\r\n\t\t\t</div>\r\n\t\t)\r\n\t}\r\n\r\n\t// TODO: Avatar\r\n\t// TODO: Replace _.pick\r\n\tonSubmit=async e=>{\r\n\t\te.preventDefault()\r\n\t\tconst {id}=this.props.match.params\r\n\t\tconst {state}=this.context\r\n\t\tconst {userId}=state\r\n\t\tlet group={\r\n\t\t\t..._.omit(this.state,['publicPrivate','linkSharing','showSpinner']),\r\n\t\t\tgroup_type: this.stateToGroupType(),\r\n\t\t}\r\n\r\n\t\tthis.setState({showSpinner: true})\r\n\t\ttry{\r\n\t\t\tif(id==='0'){\r\n\t\t\t\tgroup={\r\n\t\t\t\t\t...group,\r\n\t\t\t\t\tusers: [userId],\r\n\t\t\t\t\tadmins: [userId],\r\n\t\t\t\t\tbooks: [],\r\n\t\t\t\t}\r\n\t\t\t\t/*const g=*/await api('post','group/',group)\r\n\t\t\t\t// TODO: Backend /group-full\r\n\t\t\t\tthis.props.history.goBack() // TODO: Remove\r\n\t\t\t}else{\r\n\t\t\t\t/*const g=*/await api('put','group/',group)\r\n\t\t\t\t// TODO: Backend /group-full\r\n\t\t\t}\r\n\t\t}finally{\r\n\t\t\tthis.setState({showSpinner: false})\r\n\t\t}\r\n\t}\r\n\r\n\t// Group types\r\n\t// - public       -     searchable,    link-admit\r\n\t// - private      - non-searchable, no link-admit\r\n\t// - private-link - non-searchable,    link-admit\r\n\r\n\tgroupTypeToState=group=>{\r\n\t\tthis.admins={}\r\n\t\tgroup.admins.forEach(a=>this.admins[a]=true)\r\n\t\tthis.setState({\r\n\t\t\t..._.cloneDeep(group),\r\n\t\t\tpublicPrivate: group.group_type==='public'?0:1,\r\n\t\t\tlinkSharing: group.group_type!=='private'?0:1,\r\n\t\t})\r\n\t}\r\n\r\n\tstateToGroupType=()=>{\r\n\t\tconst {publicPrivate,linkSharing}=this.state\r\n\t\tif(publicPrivate===0) return 'public'\r\n\t\telse if(linkSharing===0) return 'private-link'\r\n\t\telse return 'private'\r\n\t}\r\n}\r\n","import React from 'react'\nimport {Route,Switch,withRouter} from 'react-router-dom'\n\nimport './App.scss'\nimport {dispatch} from '../../contexts/MainContext'\nimport Sidemenu from '../Sidemenu/Sidemenu'\nimport Dashboard from '../PageDashboard/PageDashboard'\nimport Book from '../PageBook/PageBook'\nimport PageLogin from '../PageLogin/PageLogin'\nimport Alert from '../../utils/Alert/Alert'\nimport Groups from '../PageGroups/PageGroups'\nimport PageRegister from '../PageRegister/PageRegister'\nimport ModalEditGroup from '../ModalEditGroup/ModalEditGroup'\nimport PageGroup from '../PageGroup/PageGroup'\n\nexport let forceUpdateApp\nexport default withRouter(function App({location,history}){\n\tconst [,updateState]=React.useState()\n\tforceUpdateApp=()=>updateState({})\n\n\tif(location.pathname==='/')\n\t\thistory.replace('/dashboard')\n\tif(!localStorage.getItem('activeUserId') && location.pathname.indexOf('/login')===-1) // Routes containing /login can appear without token present\n\t\thistory.replace(location.pathname+'/login')\n\n\t// console.log('App Render')\n\treturn (\n\t\t<div id=\"App\">\n\t\t\t<Sidemenu/>\n\t\t\t<div id=\"main-content\" className=\"pos-abs stretch-to-fit\">\n\t\t\t\t<Switch>\n\t\t\t\t\t{/* Level 2 */}\n\n\t\t\t\t\t{/* Level 1 */}\n\t\t\t\t\t<Route path=\"*/group/:id\" component={PageGroup}/>\n\n\t\t\t\t\t{/* Level 0 */}\n\t\t\t\t\t<Route path=\"/dashboard\" component={Dashboard}/>\n\t\t\t\t\t<Route path=\"/groups\" component={Groups}/>\n\t\t\t\t</Switch>\n\t\t\t\t<Route path=\"*/edit-group/:id\" component={ModalEditGroup}/>\n\t\t\t</div>\n\t\t\t<Route path=\"*/book/:id\" component={Book}/>\n\n\t\t\t{/* Routes containing /login can appear without token present */}\n\t\t\t<Route path=\"*/login\" component={PageLogin}/>\n\t\t\t<Route path=\"*/login-register:id\" component={PageRegister}/>\n\n\t\t\t{/* Activated when Sidemenu active to prevent clicks over main-content */}\n\t\t\t<div\n\t\t\t\tid=\"shield\"\n\t\t\t\tclassName=\"hide pos-abs stretch-to-fit\"\n\t\t\t\tonClick={()=>dispatch(['SET_UI_SIDEMENU',false])}\n\t\t\t/>\n\t\t\t<Alert/>\n\t\t</div>\n\t)\n})\n","import React,{useContext,useEffect,useState} from 'react'\r\nimport {withRouter} from 'react-router-dom'\r\nimport {Scrollbar} from 'react-scrollbars-custom'\r\n\r\nimport './PageGroup.scss'\r\nimport Header from '../Header/Header'\r\nimport {MainContext,api} from '../../contexts/MainContext'\r\nimport Group from '../Group/Group'\r\n\r\nexport default withRouter(function PageGroup({location,history,match}){\r\n\tconst {state,dispatch}=useContext(MainContext)\r\n\tuseEffect(refresh,[location.pathname])\r\n\tconst [showJoinDialog,setShowJoinDialog]=useState(true)\r\n\tconst groupId=match.params.id\r\n\tconst group=state.GROUPS[groupId]\r\n\tconst user=state.USERS[state.userId]\r\n\r\n\tconsole.log(history)\r\n\r\n\tfunction back(){\r\n\t\thistory.length>1?\r\n\t\t\thistory.goBack():\r\n\t\t\thistory.replace('/groups')\r\n\t}\r\n\r\n\tfunction refresh(){\r\n\t\tif(!state.userId) return\r\n\t\tapi('get','group-full/'+match.params.id).then(({data})=>{\r\n\t\t\tdispatch(['SET_DATA',data])\r\n\t\t}).catch(console.error)\r\n\t}\r\n\r\n\treturn (\r\n\t\t<div id=\"PageGroup\">\r\n\t\t\t<Scrollbar disableTracksWidthCompensation id=\"PageGroup\" className=\"pos-abs stretch-to-fit\">\r\n\t\t\t\t<div className=\"f-vert\">\r\n\t\t\t\t\t<div className=\"container\">\r\n\t\t\t\t\t\t{group?<Group {...{key:groupId,group}}/>:undefined}\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<Header>\r\n\t\t\t\t\t\t<div className=\"icon icon-arrow_left f-order-m1 super-center\" onClick={back}/>\r\n\t\t\t\t\t\t<div className=\"col\"/>\r\n\t\t\t\t\t\t<div className=\"icon icon-refresh super-center\" onClick={refresh}/>\r\n\t\t\t\t\t</Header>\r\n\t\t\t\t</div>\r\n\t\t\t</Scrollbar>\r\n\t\t\t{(showJoinDialog && user.joined_groups.indexOf(groupId)===-1)?<div className=\"container p-12 pos-abs join-group stretch-to-fit\">\r\n\t\t\t\t<div className=\"card row spc-12 f-center\">\r\n\t\t\t\t\t<div>Do you want to join this group?</div>\r\n\t\t\t\t\t<div className=\"col\"/>\r\n\t\t\t\t\t<button className=\"outline\" style={{width: '60px'}} onClick={()=>setShowJoinDialog(false)}>No</button>\r\n\t\t\t\t\t<button style={{width: '60px'}}>Yes</button>\r\n\t\t\t\t</div>\r\n\t\t\t</div>:undefined}\r\n\t\t</div>\r\n\t)\r\n})\r\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' },\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready\n      .then(registration => {\n        registration.unregister();\n      })\n      .catch(error => {\n        console.error(error.message);\n      });\n  }\n}\n","import React from 'react'\nimport ReactDOM from 'react-dom'\nimport {HashRouter} from 'react-router-dom'\n\nimport './index.scss'\nimport App from './components/App/App'\nimport * as serviceWorker from './serviceWorker'\nimport MainContextProvider from './contexts/MainContext'\n\nReactDOM.render(\n\t<HashRouter>\n\t\t<MainContextProvider>\n\t\t\t{/*<React.StrictMode>*/}\n\t\t\t\t<App/>\n\t\t\t{/*</React.StrictMode>*/}\n\t\t</MainContextProvider>\n\t</HashRouter>,\n\tdocument.getElementById('root')\n)\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.register()\n","module.exports = __webpack_public_path__ + \"static/media/tab-start.7684764d.svg\";","module.exports = \"data:image/jpeg;base64,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\"","module.exports = __webpack_public_path__ + \"static/media/letter.74d7f973.png\";"],"sourceRoot":""}